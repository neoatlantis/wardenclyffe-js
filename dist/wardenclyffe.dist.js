/*! For license information please see wardenclyffe.dist.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Wardenclyffe=t():e.Wardenclyffe=t()}(global,(()=>(()=>{var e={6486:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",c=32,u=128,l=1/0,f=9007199254740991,h=NaN,p=4294967295,d=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],_="[object Arguments]",g="[object Array]",m="[object Boolean]",v="[object Date]",y="[object Error]",b="[object Function]",w="[object GeneratorFunction]",S="[object Map]",k="[object Number]",x="[object Object]",E="[object Promise]",T="[object RegExp]",O="[object Set]",I="[object String]",P="[object Symbol]",C="[object WeakMap]",A="[object ArrayBuffer]",N="[object DataView]",L="[object Float32Array]",U="[object Float64Array]",R="[object Int8Array]",j="[object Int16Array]",B="[object Int32Array]",M="[object Uint8Array]",D="[object Uint8ClampedArray]",W="[object Uint16Array]",q="[object Uint32Array]",F=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$=/&(?:amp|lt|gt|quot|#39);/g,G=/[&<>"']/g,H=RegExp($.source),Q=RegExp(G.source),Y=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,ae=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,le=/\\(\\)?/g,fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,he=/\w*$/,pe=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,_e=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,me=/^(?:0|[1-9]\d*)$/,ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ye=/($^)/,be=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",Se="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ke="\\u2700-\\u27bf",xe="a-z\\xdf-\\xf6\\xf8-\\xff",Ee="A-Z\\xc0-\\xd6\\xd8-\\xde",Te="\\ufe0e\\ufe0f",Oe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ie="["+we+"]",Pe="["+Oe+"]",Ce="["+Se+"]",Ae="\\d+",Ne="["+ke+"]",Le="["+xe+"]",Ue="[^"+we+Oe+Ae+ke+xe+Ee+"]",Re="\\ud83c[\\udffb-\\udfff]",je="[^"+we+"]",Be="(?:\\ud83c[\\udde6-\\uddff]){2}",Me="[\\ud800-\\udbff][\\udc00-\\udfff]",De="["+Ee+"]",We="\\u200d",qe="(?:"+Le+"|"+Ue+")",Fe="(?:"+De+"|"+Ue+")",Ve="(?:['’](?:d|ll|m|re|s|t|ve))?",ze="(?:['’](?:D|LL|M|RE|S|T|VE))?",$e="(?:"+Ce+"|"+Re+")?",Ge="["+Te+"]?",He=Ge+$e+"(?:"+We+"(?:"+[je,Be,Me].join("|")+")"+Ge+$e+")*",Qe="(?:"+[Ne,Be,Me].join("|")+")"+He,Ye="(?:"+[je+Ce+"?",Ce,Be,Me,Ie].join("|")+")",Ke=RegExp("['’]","g"),Ze=RegExp(Ce,"g"),Xe=RegExp(Re+"(?="+Re+")|"+Ye+He,"g"),Je=RegExp([De+"?"+Le+"+"+Ve+"(?="+[Pe,De,"$"].join("|")+")",Fe+"+"+ze+"(?="+[Pe,De+qe,"$"].join("|")+")",De+"?"+qe+"+"+Ve,De+"+"+ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ae,Qe].join("|"),"g"),et=RegExp("["+We+we+Se+Te+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,it={};it[L]=it[U]=it[R]=it[j]=it[B]=it[M]=it[D]=it[W]=it[q]=!0,it[_]=it[g]=it[A]=it[m]=it[N]=it[v]=it[y]=it[b]=it[S]=it[k]=it[x]=it[T]=it[O]=it[I]=it[C]=!1;var ot={};ot[_]=ot[g]=ot[A]=ot[N]=ot[m]=ot[v]=ot[L]=ot[U]=ot[R]=ot[j]=ot[B]=ot[S]=ot[k]=ot[x]=ot[T]=ot[O]=ot[I]=ot[P]=ot[M]=ot[D]=ot[W]=ot[q]=!0,ot[y]=ot[b]=ot[C]=!1;var st={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,ct=parseInt,ut="object"==typeof global&&global&&global.Object===Object&&global,lt="object"==typeof self&&self&&self.Object===Object&&self,ft=ut||lt||Function("return this")(),ht=t&&!t.nodeType&&t,pt=ht&&e&&!e.nodeType&&e,dt=pt&&pt.exports===ht,_t=dt&&ut.process,gt=function(){try{return pt&&pt.require&&pt.require("util").types||_t&&_t.binding&&_t.binding("util")}catch(e){}}(),mt=gt&&gt.isArrayBuffer,vt=gt&&gt.isDate,yt=gt&&gt.isMap,bt=gt&&gt.isRegExp,wt=gt&&gt.isSet,St=gt&&gt.isTypedArray;function kt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function xt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function Et(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Ot(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function It(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function Pt(e,t){return!(null==e||!e.length)&&Dt(e,t,0)>-1}function Ct(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function At(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Nt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Lt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Ut(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Rt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var jt=Vt("length");function Bt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Mt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Dt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Mt(e,qt,n)}function Wt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function qt(e){return e!=e}function Ft(e,t){var n=null==e?0:e.length;return n?Gt(e,t)/n:h}function Vt(e){return function(t){return null==t?i:t[e]}}function zt(e){return function(t){return null==e?i:e[t]}}function $t(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Gt(e,t){for(var n,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==i&&(n=n===i?s:n+s)}return n}function Ht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Qt(e){return e?e.slice(0,hn(e)+1).replace(re,""):e}function Yt(e){return function(t){return e(t)}}function Kt(e,t){return At(t,(function(t){return e[t]}))}function Zt(e,t){return e.has(t)}function Xt(e,t){for(var n=-1,r=e.length;++n<r&&Dt(t,e[n],0)>-1;);return n}function Jt(e,t){for(var n=e.length;n--&&Dt(t,e[n],0)>-1;);return n}var en=zt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),tn=zt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(e){return"\\"+st[e]}function rn(e){return et.test(e)}function on(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function sn(e,t){return function(n){return e(t(n))}}function an(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function ln(e){return rn(e)?function(e){for(var t=Xe.lastIndex=0;Xe.test(e);)++t;return t}(e):jt(e)}function fn(e){return rn(e)?function(e){return e.match(Xe)||[]}(e):function(e){return e.split("")}(e)}function hn(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var pn=zt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),dn=function e(t){var n,r=(t=null==t?ft:dn.defaults(ft.Object(),t,dn.pick(ft,nt))).Array,ie=t.Date,we=t.Error,Se=t.Function,ke=t.Math,xe=t.Object,Ee=t.RegExp,Te=t.String,Oe=t.TypeError,Ie=r.prototype,Pe=Se.prototype,Ce=xe.prototype,Ae=t["__core-js_shared__"],Ne=Pe.toString,Le=Ce.hasOwnProperty,Ue=0,Re=(n=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",je=Ce.toString,Be=Ne.call(xe),Me=ft._,De=Ee("^"+Ne.call(Le).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),We=dt?t.Buffer:i,qe=t.Symbol,Fe=t.Uint8Array,Ve=We?We.allocUnsafe:i,ze=sn(xe.getPrototypeOf,xe),$e=xe.create,Ge=Ce.propertyIsEnumerable,He=Ie.splice,Qe=qe?qe.isConcatSpreadable:i,Ye=qe?qe.iterator:i,Xe=qe?qe.toStringTag:i,et=function(){try{var e=co(xe,"defineProperty");return e({},"",{}),e}catch(e){}}(),st=t.clearTimeout!==ft.clearTimeout&&t.clearTimeout,ut=ie&&ie.now!==ft.Date.now&&ie.now,lt=t.setTimeout!==ft.setTimeout&&t.setTimeout,ht=ke.ceil,pt=ke.floor,_t=xe.getOwnPropertySymbols,gt=We?We.isBuffer:i,jt=t.isFinite,zt=Ie.join,_n=sn(xe.keys,xe),gn=ke.max,mn=ke.min,vn=ie.now,yn=t.parseInt,bn=ke.random,wn=Ie.reverse,Sn=co(t,"DataView"),kn=co(t,"Map"),xn=co(t,"Promise"),En=co(t,"Set"),Tn=co(t,"WeakMap"),On=co(xe,"create"),In=Tn&&new Tn,Pn={},Cn=Bo(Sn),An=Bo(kn),Nn=Bo(xn),Ln=Bo(En),Un=Bo(Tn),Rn=qe?qe.prototype:i,jn=Rn?Rn.valueOf:i,Bn=Rn?Rn.toString:i;function Mn(e){if(ea(e)&&!Vs(e)&&!(e instanceof Fn)){if(e instanceof qn)return e;if(Le.call(e,"__wrapped__"))return Mo(e)}return new qn(e)}var Dn=function(){function e(){}return function(t){if(!Js(t))return{};if($e)return $e(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Wn(){}function qn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Fn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function $n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new $n;++t<n;)this.add(e[t])}function Hn(e){var t=this.__data__=new zn(e);this.size=t.size}function Qn(e,t){var n=Vs(e),r=!n&&Fs(e),i=!n&&!r&&Hs(e),o=!n&&!r&&!i&&ca(e),s=n||r||i||o,a=s?Ht(e.length,Te):[],c=a.length;for(var u in e)!t&&!Le.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||go(u,c))||a.push(u);return a}function Yn(e){var t=e.length;return t?e[$r(0,t-1)]:i}function Kn(e,t){return No(Ti(e),or(t,0,e.length))}function Zn(e){return No(Ti(e))}function Xn(e,t,n){(n!==i&&!Ds(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Jn(e,t,n){var r=e[t];Le.call(e,t)&&Ds(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(Ds(e[n][0],t))return n;return-1}function tr(e,t,n,r){return lr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function nr(e,t){return e&&Oi(t,Ca(t),e)}function rr(e,t,n){"__proto__"==t&&et?et(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,s=r(o),a=null==e;++n<o;)s[n]=a?i:Ea(e,t[n]);return s}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function sr(e,t,n,r,o,s){var a,c=1&t,u=2&t,l=4&t;if(n&&(a=o?n(e,r,o,s):n(e)),a!==i)return a;if(!Js(e))return e;var f=Vs(e);if(f){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Le.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return Ti(e,a)}else{var h=fo(e),p=h==b||h==w;if(Hs(e))return bi(e,c);if(h==x||h==_||p&&!o){if(a=u||p?{}:po(e),!c)return u?function(e,t){return Oi(e,lo(e),t)}(e,function(e,t){return e&&Oi(t,Aa(t),e)}(a,e)):function(e,t){return Oi(e,uo(e),t)}(e,nr(a,e))}else{if(!ot[h])return o?e:{};a=function(e,t,n){var r,i=e.constructor;switch(t){case A:return wi(e);case m:case v:return new i(+e);case N:return function(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case L:case U:case R:case j:case B:case M:case D:case W:case q:return Si(e,n);case S:return new i;case k:case I:return new i(e);case T:return function(e){var t=new e.constructor(e.source,he.exec(e));return t.lastIndex=e.lastIndex,t}(e);case O:return new i;case P:return r=e,jn?xe(jn.call(r)):{}}}(e,h,c)}}s||(s=new Hn);var d=s.get(e);if(d)return d;s.set(e,a),oa(e)?e.forEach((function(r){a.add(sr(r,t,n,r,e,s))})):ta(e)&&e.forEach((function(r,i){a.set(i,sr(r,t,n,i,e,s))}));var g=f?i:(l?u?to:eo:u?Aa:Ca)(e);return Et(g||e,(function(r,i){g&&(r=e[i=r]),Jn(a,i,sr(r,t,n,i,e,s))})),a}function ar(e,t,n){var r=n.length;if(null==e)return!r;for(e=xe(e);r--;){var o=n[r],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new Oe(o);return Io((function(){e.apply(i,n)}),t)}function ur(e,t,n,r){var i=-1,o=Pt,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=At(t,Yt(n))),r?(o=Ct,s=!1):t.length>=200&&(o=Zt,s=!1,t=new Gn(t));e:for(;++i<a;){var l=e[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,s&&f==f){for(var h=u;h--;)if(t[h]===f)continue e;c.push(l)}else o(t,f,r)||c.push(l)}return c}Mn.templateSettings={escape:Y,evaluate:K,interpolate:Z,variable:"",imports:{_:Mn}},Mn.prototype=Wn.prototype,Mn.prototype.constructor=Mn,qn.prototype=Dn(Wn.prototype),qn.prototype.constructor=qn,Fn.prototype=Dn(Wn.prototype),Fn.prototype.constructor=Fn,Vn.prototype.clear=function(){this.__data__=On?On(null):{},this.size=0},Vn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vn.prototype.get=function(e){var t=this.__data__;if(On){var n=t[e];return n===s?i:n}return Le.call(t,e)?t[e]:i},Vn.prototype.has=function(e){var t=this.__data__;return On?t[e]!==i:Le.call(t,e)},Vn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=On&&t===i?s:t,this},zn.prototype.clear=function(){this.__data__=[],this.size=0},zn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():He.call(t,n,1),--this.size,0))},zn.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},zn.prototype.has=function(e){return er(this.__data__,e)>-1},zn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Vn,map:new(kn||zn),string:new Vn}},$n.prototype.delete=function(e){var t=so(this,e).delete(e);return this.size-=t?1:0,t},$n.prototype.get=function(e){return so(this,e).get(e)},$n.prototype.has=function(e){return so(this,e).has(e)},$n.prototype.set=function(e,t){var n=so(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Gn.prototype.add=Gn.prototype.push=function(e){return this.__data__.set(e,s),this},Gn.prototype.has=function(e){return this.__data__.has(e)},Hn.prototype.clear=function(){this.__data__=new zn,this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Hn.prototype.get=function(e){return this.__data__.get(e)},Hn.prototype.has=function(e){return this.__data__.has(e)},Hn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof zn){var r=n.__data__;if(!kn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new $n(r)}return n.set(e,t),this.size=n.size,this};var lr=Ci(vr),fr=Ci(yr,!0);function hr(e,t){var n=!0;return lr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function pr(e,t,n){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(c===i?a==a&&!aa(a):n(a,c)))var c=a,u=s}return u}function dr(e,t){var n=[];return lr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function _r(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=_o),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?_r(a,t-1,n,r,i):Nt(i,a):r||(i[i.length]=a)}return i}var gr=Ai(),mr=Ai(!0);function vr(e,t){return e&&gr(e,t,Ca)}function yr(e,t){return e&&mr(e,t,Ca)}function br(e,t){return It(t,(function(t){return Ks(e[t])}))}function wr(e,t){for(var n=0,r=(t=gi(t,e)).length;null!=e&&n<r;)e=e[jo(t[n++])];return n&&n==r?e:i}function Sr(e,t,n){var r=t(e);return Vs(e)?r:Nt(r,n(e))}function kr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Xe&&Xe in xe(e)?function(e){var t=Le.call(e,Xe),n=e[Xe];try{e[Xe]=i;var r=!0}catch(e){}var o=je.call(e);return r&&(t?e[Xe]=n:delete e[Xe]),o}(e):function(e){return je.call(e)}(e)}function xr(e,t){return e>t}function Er(e,t){return null!=e&&Le.call(e,t)}function Tr(e,t){return null!=e&&t in xe(e)}function Or(e,t,n){for(var o=n?Ct:Pt,s=e[0].length,a=e.length,c=a,u=r(a),l=1/0,f=[];c--;){var h=e[c];c&&t&&(h=At(h,Yt(t))),l=mn(h.length,l),u[c]=!n&&(t||s>=120&&h.length>=120)?new Gn(c&&h):i}h=e[0];var p=-1,d=u[0];e:for(;++p<s&&f.length<l;){var _=h[p],g=t?t(_):_;if(_=n||0!==_?_:0,!(d?Zt(d,g):o(f,g,n))){for(c=a;--c;){var m=u[c];if(!(m?Zt(m,g):o(e[c],g,n)))continue e}d&&d.push(g),f.push(_)}}return f}function Ir(e,t,n){var r=null==(e=Eo(e,t=gi(t,e)))?e:e[jo(Yo(t))];return null==r?i:kt(r,e,n)}function Pr(e){return ea(e)&&kr(e)==_}function Cr(e,t,n,r,o){return e===t||(null==e||null==t||!ea(e)&&!ea(t)?e!=e&&t!=t:function(e,t,n,r,o,s){var a=Vs(e),c=Vs(t),u=a?g:fo(e),l=c?g:fo(t),f=(u=u==_?x:u)==x,h=(l=l==_?x:l)==x,p=u==l;if(p&&Hs(e)){if(!Hs(t))return!1;a=!0,f=!1}if(p&&!f)return s||(s=new Hn),a||ca(e)?Xi(e,t,n,r,o,s):function(e,t,n,r,i,o,s){switch(n){case N:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case A:return!(e.byteLength!=t.byteLength||!o(new Fe(e),new Fe(t)));case m:case v:case k:return Ds(+e,+t);case y:return e.name==t.name&&e.message==t.message;case T:case I:return e==t+"";case S:var a=on;case O:var c=1&r;if(a||(a=cn),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var l=Xi(a(e),a(t),r,i,o,s);return s.delete(e),l;case P:if(jn)return jn.call(e)==jn.call(t)}return!1}(e,t,u,n,r,o,s);if(!(1&n)){var d=f&&Le.call(e,"__wrapped__"),b=h&&Le.call(t,"__wrapped__");if(d||b){var w=d?e.value():e,E=b?t.value():t;return s||(s=new Hn),o(w,E,n,r,s)}}return!!p&&(s||(s=new Hn),function(e,t,n,r,o,s){var a=1&n,c=eo(e),u=c.length;if(u!=eo(t).length&&!a)return!1;for(var l=u;l--;){var f=c[l];if(!(a?f in t:Le.call(t,f)))return!1}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var d=!0;s.set(e,t),s.set(t,e);for(var _=a;++l<u;){var g=e[f=c[l]],m=t[f];if(r)var v=a?r(m,g,f,t,e,s):r(g,m,f,e,t,s);if(!(v===i?g===m||o(g,m,n,r,s):v)){d=!1;break}_||(_="constructor"==f)}if(d&&!_){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,n,r,o,s))}(e,t,n,r,Cr,o))}function Ar(e,t,n,r){var o=n.length,s=o,a=!r;if(null==e)return!s;for(e=xe(e);o--;){var c=n[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var u=(c=n[o])[0],l=e[u],f=c[1];if(a&&c[2]){if(l===i&&!(u in e))return!1}else{var h=new Hn;if(r)var p=r(l,f,u,e,t,h);if(!(p===i?Cr(f,l,3,r,h):p))return!1}}return!0}function Nr(e){return!(!Js(e)||(t=e,Re&&Re in t))&&(Ks(e)?De:_e).test(Bo(e));var t}function Lr(e){return"function"==typeof e?e:null==e?nc:"object"==typeof e?Vs(e)?Mr(e[0],e[1]):Br(e):fc(e)}function Ur(e){if(!wo(e))return _n(e);var t=[];for(var n in xe(e))Le.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Rr(e,t){return e<t}function jr(e,t){var n=-1,i=$s(e)?r(e.length):[];return lr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Br(e){var t=ao(e);return 1==t.length&&t[0][2]?ko(t[0][0],t[0][1]):function(n){return n===e||Ar(n,e,t)}}function Mr(e,t){return vo(e)&&So(t)?ko(jo(e),t):function(n){var r=Ea(n,e);return r===i&&r===t?Ta(n,e):Cr(t,r,3)}}function Dr(e,t,n,r,o){e!==t&&gr(t,(function(s,a){if(o||(o=new Hn),Js(s))!function(e,t,n,r,o,s,a){var c=To(e,n),u=To(t,n),l=a.get(u);if(l)Xn(e,n,l);else{var f=s?s(c,u,n+"",e,t,a):i,h=f===i;if(h){var p=Vs(u),d=!p&&Hs(u),_=!p&&!d&&ca(u);f=u,p||d||_?Vs(c)?f=c:Gs(c)?f=Ti(c):d?(h=!1,f=bi(u,!0)):_?(h=!1,f=Si(u,!0)):f=[]:ra(u)||Fs(u)?(f=c,Fs(c)?f=ga(c):Js(c)&&!Ks(c)||(f=po(u))):h=!1}h&&(a.set(u,f),o(f,u,r,s,a),a.delete(u)),Xn(e,n,f)}}(e,t,a,n,Dr,r,o);else{var c=r?r(To(e,a),s,a+"",e,t,o):i;c===i&&(c=s),Xn(e,a,c)}}),Aa)}function Wr(e,t){var n=e.length;if(n)return go(t+=t<0?n:0,n)?e[t]:i}function qr(e,t,n){t=t.length?At(t,(function(e){return Vs(e)?function(t){return wr(t,1===e.length?e[0]:e)}:e})):[nc];var r=-1;t=At(t,Yt(oo()));var i=jr(e,(function(e,n,i){var o=At(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var c=ki(i[r],o[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(i)}function Fr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=wr(e,s);n(a,s)&&Kr(o,gi(s,e),a)}return o}function Vr(e,t,n,r){var i=r?Wt:Dt,o=-1,s=t.length,a=e;for(e===t&&(t=Ti(t)),n&&(a=At(e,Yt(n)));++o<s;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(a,l,c,r))>-1;)a!==e&&He.call(a,c,1),He.call(e,c,1);return e}function zr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;go(i)?He.call(e,i,1):ci(e,i)}}return e}function $r(e,t){return e+pt(bn()*(t-e+1))}function Gr(e,t){var n="";if(!e||t<1||t>f)return n;do{t%2&&(n+=e),(t=pt(t/2))&&(e+=e)}while(t);return n}function Hr(e,t){return Po(xo(e,t,nc),e+"")}function Qr(e){return Yn(Da(e))}function Yr(e,t){var n=Da(e);return No(n,or(t,0,n.length))}function Kr(e,t,n,r){if(!Js(e))return e;for(var o=-1,s=(t=gi(t,e)).length,a=s-1,c=e;null!=c&&++o<s;){var u=jo(t[o]),l=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var f=c[u];(l=r?r(f,u,c):i)===i&&(l=Js(f)?f:go(t[o+1])?[]:{})}Jn(c,u,l),c=c[u]}return e}var Zr=In?function(e,t){return In.set(e,t),e}:nc,Xr=et?function(e,t){return et(e,"toString",{configurable:!0,enumerable:!1,value:Ja(t),writable:!0})}:nc;function Jr(e){return No(Da(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function ti(e,t){var n;return lr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!aa(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ri(e,t,nc,n)}function ri(e,t,n,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,c=null===t,u=aa(t),l=t===i;o<s;){var f=pt((o+s)/2),h=n(e[f]),p=h!==i,d=null===h,_=h==h,g=aa(h);if(a)var m=r||_;else m=l?_&&(r||p):c?_&&p&&(r||!d):u?_&&p&&!d&&(r||!g):!d&&!g&&(r?h<=t:h<t);m?o=f+1:s=f}return mn(s,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Ds(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function oi(e){return"number"==typeof e?e:aa(e)?h:+e}function si(e){if("string"==typeof e)return e;if(Vs(e))return At(e,si)+"";if(aa(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ai(e,t,n){var r=-1,i=Pt,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=Ct;else if(o>=200){var u=t?null:Gi(e);if(u)return cn(u);s=!1,i=Zt,c=new Gn}else c=t?[]:a;e:for(;++r<o;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,s&&f==f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),a.push(l)}else i(c,f,n)||(c!==a&&c.push(f),a.push(l))}return a}function ci(e,t){return null==(e=Eo(e,t=gi(t,e)))||delete e[jo(Yo(t))]}function ui(e,t,n,r){return Kr(e,t,n(wr(e,t)),r)}function li(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function fi(e,t){var n=e;return n instanceof Fn&&(n=n.value()),Lt(t,(function(e,t){return t.func.apply(t.thisArg,Nt([e],t.args))}),n)}function hi(e,t,n){var i=e.length;if(i<2)return i?ai(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],c=-1;++c<i;)c!=o&&(s[o]=ur(s[o]||a,e[c],t,n));return ai(_r(s,1),t,n)}function pi(e,t,n){for(var r=-1,o=e.length,s=t.length,a={};++r<o;){var c=r<s?t[r]:i;n(a,e[r],c)}return a}function di(e){return Gs(e)?e:[]}function _i(e){return"function"==typeof e?e:nc}function gi(e,t){return Vs(e)?e:vo(e,t)?[e]:Ro(ma(e))}var mi=Hr;function vi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var yi=st||function(e){return ft.clearTimeout(e)};function bi(e,t){if(t)return e.slice();var n=e.length,r=Ve?Ve(n):new e.constructor(n);return e.copy(r),r}function wi(e){var t=new e.constructor(e.byteLength);return new Fe(t).set(new Fe(e)),t}function Si(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ki(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,s=aa(e),a=t!==i,c=null===t,u=t==t,l=aa(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||r&&a&&u||!n&&u||!o)return 1;if(!r&&!s&&!l&&e<t||l&&n&&o&&!r&&!s||c&&n&&o||!a&&o||!u)return-1}return 0}function xi(e,t,n,i){for(var o=-1,s=e.length,a=n.length,c=-1,u=t.length,l=gn(s-a,0),f=r(u+l),h=!i;++c<u;)f[c]=t[c];for(;++o<a;)(h||o<s)&&(f[n[o]]=e[o]);for(;l--;)f[c++]=e[o++];return f}function Ei(e,t,n,i){for(var o=-1,s=e.length,a=-1,c=n.length,u=-1,l=t.length,f=gn(s-c,0),h=r(f+l),p=!i;++o<f;)h[o]=e[o];for(var d=o;++u<l;)h[d+u]=t[u];for(;++a<c;)(p||o<s)&&(h[d+n[a]]=e[o++]);return h}function Ti(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Oi(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var c=t[s],u=r?r(n[c],e[c],c,n,e):i;u===i&&(u=e[c]),o?rr(n,c,u):Jn(n,c,u)}return n}function Ii(e,t){return function(n,r){var i=Vs(n)?xt:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Pi(e){return Hr((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&mo(n[0],n[1],a)&&(s=o<3?i:s,o=1),t=xe(t);++r<o;){var c=n[r];c&&e(t,c,r,s)}return t}))}function Ci(e,t){return function(n,r){if(null==n)return n;if(!$s(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=xe(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Ai(e){return function(t,n,r){for(var i=-1,o=xe(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}function Ni(e){return function(t){var n=rn(t=ma(t))?fn(t):i,r=n?n[0]:t.charAt(0),o=n?vi(n,1).join(""):t.slice(1);return r[e]()+o}}function Li(e){return function(t){return Lt(Ka(Fa(t).replace(Ke,"")),e,"")}}function Ui(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Dn(e.prototype),r=e.apply(n,t);return Js(r)?r:n}}function Ri(e){return function(t,n,r){var o=xe(t);if(!$s(t)){var s=oo(n,3);t=Ca(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[s?t[a]:a]:i}}function ji(e){return Ji((function(t){var n=t.length,r=n,s=qn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Oe(o);if(s&&!c&&"wrapper"==ro(a))var c=new qn([],!0)}for(r=c?r:n;++r<n;){var u=ro(a=t[r]),l="wrapper"==u?no(a):i;c=l&&yo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[ro(l[0])].apply(c,l[3]):1==a.length&&yo(a)?c[u]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Vs(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Bi(e,t,n,o,s,a,c,l,f,h){var p=t&u,d=1&t,_=2&t,g=24&t,m=512&t,v=_?i:Ui(e);return function u(){for(var y=arguments.length,b=r(y),w=y;w--;)b[w]=arguments[w];if(g)var S=io(u),k=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,S);if(o&&(b=xi(b,o,s,g)),a&&(b=Ei(b,a,c,g)),y-=k,g&&y<h){var x=an(b,S);return zi(e,t,Bi,u.placeholder,n,b,x,l,f,h-y)}var E=d?n:this,T=_?E[e]:e;return y=b.length,l?b=function(e,t){for(var n=e.length,r=mn(t.length,n),o=Ti(e);r--;){var s=t[r];e[r]=go(s,n)?o[s]:i}return e}(b,l):m&&y>1&&b.reverse(),p&&f<y&&(b.length=f),this&&this!==ft&&this instanceof u&&(T=v||Ui(T)),T.apply(E,b)}}function Mi(e,t){return function(n,r){return function(e,t,n,r){return vr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Di(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function Wi(e){return Ji((function(t){return t=At(t,Yt(oo())),Hr((function(n){var r=this;return e(t,(function(e){return kt(e,r,n)}))}))}))}function qi(e,t){var n=(t=t===i?" ":si(t)).length;if(n<2)return n?Gr(t,e):t;var r=Gr(t,ht(e/ln(t)));return rn(t)?vi(fn(r),0,e).join(""):r.slice(0,e)}function Fi(e){return function(t,n,o){return o&&"number"!=typeof o&&mo(t,n,o)&&(n=o=i),t=ha(t),n===i?(n=t,t=0):n=ha(n),function(e,t,n,i){for(var o=-1,s=gn(ht((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,o=o===i?t<n?1:-1:ha(o),e)}}function Vi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=_a(t),n=_a(n)),e(t,n)}}function zi(e,t,n,r,o,s,a,u,l,f){var h=8&t;t|=h?c:64,4&(t&=~(h?64:c))||(t&=-4);var p=[e,t,o,h?s:i,h?a:i,h?i:s,h?i:a,u,l,f],d=n.apply(i,p);return yo(e)&&Oo(d,p),d.placeholder=r,Co(d,e,t)}function $i(e){var t=ke[e];return function(e,n){if(e=_a(e),(n=null==n?0:mn(pa(n),292))&&jt(e)){var r=(ma(e)+"e").split("e");return+((r=(ma(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Gi=En&&1/cn(new En([,-0]))[1]==l?function(e){return new En(e)}:ac;function Hi(e){return function(t){var n=fo(t);return n==S?on(t):n==O?un(t):function(e,t){return At(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qi(e,t,n,s,l,f,h,p){var d=2&t;if(!d&&"function"!=typeof e)throw new Oe(o);var _=s?s.length:0;if(_||(t&=-97,s=l=i),h=h===i?h:gn(pa(h),0),p=p===i?p:pa(p),_-=l?l.length:0,64&t){var g=s,m=l;s=l=i}var v=d?i:no(e),y=[e,t,n,s,l,g,m,f,h,p];if(v&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==u&&8==n||r==u&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?xi(l,c,t[4]):c,e[4]=l?an(e[3],a):t[4]}(c=t[5])&&(l=e[5],e[5]=l?Ei(l,c,t[6]):c,e[6]=l?an(e[5],a):t[6]),(c=t[7])&&(e[7]=c),r&u&&(e[8]=null==e[8]?t[8]:mn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(y,v),e=y[0],t=y[1],n=y[2],s=y[3],l=y[4],!(p=y[9]=y[9]===i?d?0:e.length:gn(y[9]-_,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||16==t?function(e,t,n){var o=Ui(e);return function s(){for(var a=arguments.length,c=r(a),u=a,l=io(s);u--;)c[u]=arguments[u];var f=a<3&&c[0]!==l&&c[a-1]!==l?[]:an(c,l);return(a-=f.length)<n?zi(e,t,Bi,s.placeholder,i,c,f,i,i,n-a):kt(this&&this!==ft&&this instanceof s?o:e,this,c)}}(e,t,p):t!=c&&33!=t||l.length?Bi.apply(i,y):function(e,t,n,i){var o=1&t,s=Ui(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,f=r(l+c),h=this&&this!==ft&&this instanceof t?s:e;++u<l;)f[u]=i[u];for(;c--;)f[u++]=arguments[++a];return kt(h,o?n:this,f)}}(e,t,n,s);else var b=function(e,t,n){var r=1&t,i=Ui(e);return function t(){return(this&&this!==ft&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Co((v?Zr:Oo)(b,y),e,t)}function Yi(e,t,n,r){return e===i||Ds(e,Ce[n])&&!Le.call(r,n)?t:e}function Ki(e,t,n,r,o,s){return Js(e)&&Js(t)&&(s.set(t,e),Dr(e,t,i,Ki,s),s.delete(t)),e}function Zi(e){return ra(e)?i:e}function Xi(e,t,n,r,o,s){var a=1&n,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=s.get(e),f=s.get(t);if(l&&f)return l==t&&f==e;var h=-1,p=!0,d=2&n?new Gn:i;for(s.set(e,t),s.set(t,e);++h<c;){var _=e[h],g=t[h];if(r)var m=a?r(g,_,h,t,e,s):r(_,g,h,e,t,s);if(m!==i){if(m)continue;p=!1;break}if(d){if(!Rt(t,(function(e,t){if(!Zt(d,t)&&(_===e||o(_,e,n,r,s)))return d.push(t)}))){p=!1;break}}else if(_!==g&&!o(_,g,n,r,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function Ji(e){return Po(xo(e,i,zo),e+"")}function eo(e){return Sr(e,Ca,uo)}function to(e){return Sr(e,Aa,lo)}var no=In?function(e){return In.get(e)}:ac;function ro(e){for(var t=e.name+"",n=Pn[t],r=Le.call(Pn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(Le.call(Mn,"placeholder")?Mn:e).placeholder}function oo(){var e=Mn.iteratee||rc;return e=e===rc?Lr:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ao(e){for(var t=Ca(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,So(i)]}return t}function co(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Nr(n)?n:i}var uo=_t?function(e){return null==e?[]:(e=xe(e),It(_t(e),(function(t){return Ge.call(e,t)})))}:dc,lo=_t?function(e){for(var t=[];e;)Nt(t,uo(e)),e=ze(e);return t}:dc,fo=kr;function ho(e,t,n){for(var r=-1,i=(t=gi(t,e)).length,o=!1;++r<i;){var s=jo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Xs(i)&&go(s,i)&&(Vs(e)||Fs(e))}function po(e){return"function"!=typeof e.constructor||wo(e)?{}:Dn(ze(e))}function _o(e){return Vs(e)||Fs(e)||!!(Qe&&e&&e[Qe])}function go(e,t){var n=typeof e;return!!(t=null==t?f:t)&&("number"==n||"symbol"!=n&&me.test(e))&&e>-1&&e%1==0&&e<t}function mo(e,t,n){if(!Js(n))return!1;var r=typeof t;return!!("number"==r?$s(n)&&go(t,n.length):"string"==r&&t in n)&&Ds(n[t],e)}function vo(e,t){if(Vs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!aa(e))||J.test(e)||!X.test(e)||null!=t&&e in xe(t)}function yo(e){var t=ro(e),n=Mn[t];if("function"!=typeof n||!(t in Fn.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(Sn&&fo(new Sn(new ArrayBuffer(1)))!=N||kn&&fo(new kn)!=S||xn&&fo(xn.resolve())!=E||En&&fo(new En)!=O||Tn&&fo(new Tn)!=C)&&(fo=function(e){var t=kr(e),n=t==x?e.constructor:i,r=n?Bo(n):"";if(r)switch(r){case Cn:return N;case An:return S;case Nn:return E;case Ln:return O;case Un:return C}return t});var bo=Ae?Ks:_c;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ce)}function So(e){return e==e&&!Js(e)}function ko(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in xe(n))}}function xo(e,t,n){return t=gn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=gn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(a),kt(e,this,c)}}function Eo(e,t){return t.length<2?e:wr(e,ei(t,0,-1))}function To(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Oo=Ao(Zr),Io=lt||function(e,t){return ft.setTimeout(e,t)},Po=Ao(Xr);function Co(e,t,n){var r=t+"";return Po(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Et(d,(function(n){var r="_."+n[0];t&n[1]&&!Pt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(ae):[]}(r),n)))}function Ao(e){var t=0,n=0;return function(){var r=vn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function No(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var s=$r(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Lo,Uo,Ro=(Lo=Ls((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(le,"$1"):n||e)})),t}),(function(e){return 500===Uo.size&&Uo.clear(),e})),Uo=Lo.cache,Lo);function jo(e){if("string"==typeof e||aa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Bo(e){if(null!=e){try{return Ne.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Mo(e){if(e instanceof Fn)return e.clone();var t=new qn(e.__wrapped__,e.__chain__);return t.__actions__=Ti(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Do=Hr((function(e,t){return Gs(e)?ur(e,_r(t,1,Gs,!0)):[]})),Wo=Hr((function(e,t){var n=Yo(t);return Gs(n)&&(n=i),Gs(e)?ur(e,_r(t,1,Gs,!0),oo(n,2)):[]})),qo=Hr((function(e,t){var n=Yo(t);return Gs(n)&&(n=i),Gs(e)?ur(e,_r(t,1,Gs,!0),i,n):[]}));function Fo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=gn(r+i,0)),Mt(e,oo(t,3),i)}function Vo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=pa(n),o=n<0?gn(r+o,0):mn(o,r-1)),Mt(e,oo(t,3),o,!0)}function zo(e){return null!=e&&e.length?_r(e,1):[]}function $o(e){return e&&e.length?e[0]:i}var Go=Hr((function(e){var t=At(e,di);return t.length&&t[0]===e[0]?Or(t):[]})),Ho=Hr((function(e){var t=Yo(e),n=At(e,di);return t===Yo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Or(n,oo(t,2)):[]})),Qo=Hr((function(e){var t=Yo(e),n=At(e,di);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Or(n,i,t):[]}));function Yo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Ko=Hr(Zo);function Zo(e,t){return e&&e.length&&t&&t.length?Vr(e,t):e}var Xo=Ji((function(e,t){var n=null==e?0:e.length,r=ir(e,t);return zr(e,At(t,(function(e){return go(e,n)?+e:e})).sort(ki)),r}));function Jo(e){return null==e?e:wn.call(e)}var es=Hr((function(e){return ai(_r(e,1,Gs,!0))})),ts=Hr((function(e){var t=Yo(e);return Gs(t)&&(t=i),ai(_r(e,1,Gs,!0),oo(t,2))})),ns=Hr((function(e){var t=Yo(e);return t="function"==typeof t?t:i,ai(_r(e,1,Gs,!0),i,t)}));function rs(e){if(!e||!e.length)return[];var t=0;return e=It(e,(function(e){if(Gs(e))return t=gn(e.length,t),!0})),Ht(t,(function(t){return At(e,Vt(t))}))}function is(e,t){if(!e||!e.length)return[];var n=rs(e);return null==t?n:At(n,(function(e){return kt(t,i,e)}))}var os=Hr((function(e,t){return Gs(e)?ur(e,t):[]})),ss=Hr((function(e){return hi(It(e,Gs))})),as=Hr((function(e){var t=Yo(e);return Gs(t)&&(t=i),hi(It(e,Gs),oo(t,2))})),cs=Hr((function(e){var t=Yo(e);return t="function"==typeof t?t:i,hi(It(e,Gs),i,t)})),us=Hr(rs),ls=Hr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,is(e,n)}));function fs(e){var t=Mn(e);return t.__chain__=!0,t}function hs(e,t){return t(e)}var ps=Ji((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Fn&&go(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:hs,args:[o],thisArg:i}),new qn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),ds=Ii((function(e,t,n){Le.call(e,n)?++e[n]:rr(e,n,1)})),_s=Ri(Fo),gs=Ri(Vo);function ms(e,t){return(Vs(e)?Et:lr)(e,oo(t,3))}function vs(e,t){return(Vs(e)?Tt:fr)(e,oo(t,3))}var ys=Ii((function(e,t,n){Le.call(e,n)?e[n].push(t):rr(e,n,[t])})),bs=Hr((function(e,t,n){var i=-1,o="function"==typeof t,s=$s(e)?r(e.length):[];return lr(e,(function(e){s[++i]=o?kt(t,e,n):Ir(e,t,n)})),s})),ws=Ii((function(e,t,n){rr(e,n,t)}));function Ss(e,t){return(Vs(e)?At:jr)(e,oo(t,3))}var ks=Ii((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),xs=Hr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&mo(e,t[0],t[1])?t=[]:n>2&&mo(t[0],t[1],t[2])&&(t=[t[0]]),qr(e,_r(t,1),[])})),Es=ut||function(){return ft.Date.now()};function Ts(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Qi(e,u,i,i,i,i,t)}function Os(e,t){var n;if("function"!=typeof t)throw new Oe(o);return e=pa(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Is=Hr((function(e,t,n){var r=1;if(n.length){var i=an(n,io(Is));r|=c}return Qi(e,r,t,n,i)})),Ps=Hr((function(e,t,n){var r=3;if(n.length){var i=an(n,io(Ps));r|=c}return Qi(t,r,e,n,i)}));function Cs(e,t,n){var r,s,a,c,u,l,f=0,h=!1,p=!1,d=!0;if("function"!=typeof e)throw new Oe(o);function _(t){var n=r,o=s;return r=s=i,f=t,c=e.apply(o,n)}function g(e){var n=e-l;return l===i||n>=t||n<0||p&&e-f>=a}function m(){var e=Es();if(g(e))return v(e);u=Io(m,function(e){var n=t-(e-l);return p?mn(n,a-(e-f)):n}(e))}function v(e){return u=i,d&&r?_(e):(r=s=i,c)}function y(){var e=Es(),n=g(e);if(r=arguments,s=this,l=e,n){if(u===i)return function(e){return f=e,u=Io(m,t),h?_(e):c}(l);if(p)return yi(u),u=Io(m,t),_(l)}return u===i&&(u=Io(m,t)),c}return t=_a(t)||0,Js(n)&&(h=!!n.leading,a=(p="maxWait"in n)?gn(_a(n.maxWait)||0,t):a,d="trailing"in n?!!n.trailing:d),y.cancel=function(){u!==i&&yi(u),f=0,r=l=s=u=i},y.flush=function(){return u===i?c:v(Es())},y}var As=Hr((function(e,t){return cr(e,1,t)})),Ns=Hr((function(e,t,n){return cr(e,_a(t)||0,n)}));function Ls(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Oe(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Ls.Cache||$n),n}function Us(e){if("function"!=typeof e)throw new Oe(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ls.Cache=$n;var Rs=mi((function(e,t){var n=(t=1==t.length&&Vs(t[0])?At(t[0],Yt(oo())):At(_r(t,1),Yt(oo()))).length;return Hr((function(r){for(var i=-1,o=mn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return kt(e,this,r)}))})),js=Hr((function(e,t){var n=an(t,io(js));return Qi(e,c,i,t,n)})),Bs=Hr((function(e,t){var n=an(t,io(Bs));return Qi(e,64,i,t,n)})),Ms=Ji((function(e,t){return Qi(e,256,i,i,i,t)}));function Ds(e,t){return e===t||e!=e&&t!=t}var Ws=Vi(xr),qs=Vi((function(e,t){return e>=t})),Fs=Pr(function(){return arguments}())?Pr:function(e){return ea(e)&&Le.call(e,"callee")&&!Ge.call(e,"callee")},Vs=r.isArray,zs=mt?Yt(mt):function(e){return ea(e)&&kr(e)==A};function $s(e){return null!=e&&Xs(e.length)&&!Ks(e)}function Gs(e){return ea(e)&&$s(e)}var Hs=gt||_c,Qs=vt?Yt(vt):function(e){return ea(e)&&kr(e)==v};function Ys(e){if(!ea(e))return!1;var t=kr(e);return t==y||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ra(e)}function Ks(e){if(!Js(e))return!1;var t=kr(e);return t==b||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Zs(e){return"number"==typeof e&&e==pa(e)}function Xs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=f}function Js(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ea(e){return null!=e&&"object"==typeof e}var ta=yt?Yt(yt):function(e){return ea(e)&&fo(e)==S};function na(e){return"number"==typeof e||ea(e)&&kr(e)==k}function ra(e){if(!ea(e)||kr(e)!=x)return!1;var t=ze(e);if(null===t)return!0;var n=Le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ne.call(n)==Be}var ia=bt?Yt(bt):function(e){return ea(e)&&kr(e)==T},oa=wt?Yt(wt):function(e){return ea(e)&&fo(e)==O};function sa(e){return"string"==typeof e||!Vs(e)&&ea(e)&&kr(e)==I}function aa(e){return"symbol"==typeof e||ea(e)&&kr(e)==P}var ca=St?Yt(St):function(e){return ea(e)&&Xs(e.length)&&!!it[kr(e)]},ua=Vi(Rr),la=Vi((function(e,t){return e<=t}));function fa(e){if(!e)return[];if($s(e))return sa(e)?fn(e):Ti(e);if(Ye&&e[Ye])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ye]());var t=fo(e);return(t==S?on:t==O?cn:Da)(e)}function ha(e){return e?(e=_a(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function pa(e){var t=ha(e),n=t%1;return t==t?n?t-n:t:0}function da(e){return e?or(pa(e),0,p):0}function _a(e){if("number"==typeof e)return e;if(aa(e))return h;if(Js(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Js(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Qt(e);var n=de.test(e);return n||ge.test(e)?ct(e.slice(2),n?2:8):pe.test(e)?h:+e}function ga(e){return Oi(e,Aa(e))}function ma(e){return null==e?"":si(e)}var va=Pi((function(e,t){if(wo(t)||$s(t))Oi(t,Ca(t),e);else for(var n in t)Le.call(t,n)&&Jn(e,n,t[n])})),ya=Pi((function(e,t){Oi(t,Aa(t),e)})),ba=Pi((function(e,t,n,r){Oi(t,Aa(t),e,r)})),wa=Pi((function(e,t,n,r){Oi(t,Ca(t),e,r)})),Sa=Ji(ir),ka=Hr((function(e,t){e=xe(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&mo(t[0],t[1],o)&&(r=1);++n<r;)for(var s=t[n],a=Aa(s),c=-1,u=a.length;++c<u;){var l=a[c],f=e[l];(f===i||Ds(f,Ce[l])&&!Le.call(e,l))&&(e[l]=s[l])}return e})),xa=Hr((function(e){return e.push(i,Ki),kt(La,i,e)}));function Ea(e,t,n){var r=null==e?i:wr(e,t);return r===i?n:r}function Ta(e,t){return null!=e&&ho(e,t,Tr)}var Oa=Mi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),e[t]=n}),Ja(nc)),Ia=Mi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),Le.call(e,t)?e[t].push(n):e[t]=[n]}),oo),Pa=Hr(Ir);function Ca(e){return $s(e)?Qn(e):Ur(e)}function Aa(e){return $s(e)?Qn(e,!0):function(e){if(!Js(e))return function(e){var t=[];if(null!=e)for(var n in xe(e))t.push(n);return t}(e);var t=wo(e),n=[];for(var r in e)("constructor"!=r||!t&&Le.call(e,r))&&n.push(r);return n}(e)}var Na=Pi((function(e,t,n){Dr(e,t,n)})),La=Pi((function(e,t,n,r){Dr(e,t,n,r)})),Ua=Ji((function(e,t){var n={};if(null==e)return n;var r=!1;t=At(t,(function(t){return t=gi(t,e),r||(r=t.length>1),t})),Oi(e,to(e),n),r&&(n=sr(n,7,Zi));for(var i=t.length;i--;)ci(n,t[i]);return n})),Ra=Ji((function(e,t){return null==e?{}:function(e,t){return Fr(e,t,(function(t,n){return Ta(e,n)}))}(e,t)}));function ja(e,t){if(null==e)return{};var n=At(to(e),(function(e){return[e]}));return t=oo(t),Fr(e,n,(function(e,n){return t(e,n[0])}))}var Ba=Hi(Ca),Ma=Hi(Aa);function Da(e){return null==e?[]:Kt(e,Ca(e))}var Wa=Li((function(e,t,n){return t=t.toLowerCase(),e+(n?qa(t):t)}));function qa(e){return Ya(ma(e).toLowerCase())}function Fa(e){return(e=ma(e))&&e.replace(ve,en).replace(Ze,"")}var Va=Li((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),za=Li((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),$a=Ni("toLowerCase"),Ga=Li((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Ha=Li((function(e,t,n){return e+(n?" ":"")+Ya(t)})),Qa=Li((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ya=Ni("toUpperCase");function Ka(e,t,n){return e=ma(e),(t=n?i:t)===i?function(e){return tt.test(e)}(e)?function(e){return e.match(Je)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Za=Hr((function(e,t){try{return kt(e,i,t)}catch(e){return Ys(e)?e:new we(e)}})),Xa=Ji((function(e,t){return Et(t,(function(t){t=jo(t),rr(e,t,Is(e[t],e))})),e}));function Ja(e){return function(){return e}}var ec=ji(),tc=ji(!0);function nc(e){return e}function rc(e){return Lr("function"==typeof e?e:sr(e,1))}var ic=Hr((function(e,t){return function(n){return Ir(n,e,t)}})),oc=Hr((function(e,t){return function(n){return Ir(e,n,t)}}));function sc(e,t,n){var r=Ca(t),i=br(t,r);null!=n||Js(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=br(t,Ca(t)));var o=!(Js(n)&&"chain"in n&&!n.chain),s=Ks(e);return Et(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ti(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Nt([this.value()],arguments))})})),e}function ac(){}var cc=Wi(At),uc=Wi(Ot),lc=Wi(Rt);function fc(e){return vo(e)?Vt(jo(e)):function(e){return function(t){return wr(t,e)}}(e)}var hc=Fi(),pc=Fi(!0);function dc(){return[]}function _c(){return!1}var gc,mc=Di((function(e,t){return e+t}),0),vc=$i("ceil"),yc=Di((function(e,t){return e/t}),1),bc=$i("floor"),wc=Di((function(e,t){return e*t}),1),Sc=$i("round"),kc=Di((function(e,t){return e-t}),0);return Mn.after=function(e,t){if("function"!=typeof t)throw new Oe(o);return e=pa(e),function(){if(--e<1)return t.apply(this,arguments)}},Mn.ary=Ts,Mn.assign=va,Mn.assignIn=ya,Mn.assignInWith=ba,Mn.assignWith=wa,Mn.at=Sa,Mn.before=Os,Mn.bind=Is,Mn.bindAll=Xa,Mn.bindKey=Ps,Mn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Vs(e)?e:[e]},Mn.chain=fs,Mn.chunk=function(e,t,n){t=(n?mo(e,t,n):t===i)?1:gn(pa(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,c=r(ht(o/t));s<o;)c[a++]=ei(e,s,s+=t);return c},Mn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Mn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Nt(Vs(n)?Ti(n):[n],_r(t,1))},Mn.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?At(e,(function(e){if("function"!=typeof e[1])throw new Oe(o);return[n(e[0]),e[1]]})):[],Hr((function(n){for(var r=-1;++r<t;){var i=e[r];if(kt(i[0],this,n))return kt(i[1],this,n)}}))},Mn.conforms=function(e){return function(e){var t=Ca(e);return function(n){return ar(n,e,t)}}(sr(e,1))},Mn.constant=Ja,Mn.countBy=ds,Mn.create=function(e,t){var n=Dn(e);return null==t?n:nr(n,t)},Mn.curry=function e(t,n,r){var o=Qi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Mn.curryRight=function e(t,n,r){var o=Qi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Mn.debounce=Cs,Mn.defaults=ka,Mn.defaultsDeep=xa,Mn.defer=As,Mn.delay=Ns,Mn.difference=Do,Mn.differenceBy=Wo,Mn.differenceWith=qo,Mn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:pa(t))<0?0:t,r):[]},Mn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:pa(t)))<0?0:t):[]},Mn.dropRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0,!0):[]},Mn.dropWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0):[]},Mn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&mo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=pa(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:pa(r))<0&&(r+=o),r=n>r?0:da(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Mn.filter=function(e,t){return(Vs(e)?It:dr)(e,oo(t,3))},Mn.flatMap=function(e,t){return _r(Ss(e,t),1)},Mn.flatMapDeep=function(e,t){return _r(Ss(e,t),l)},Mn.flatMapDepth=function(e,t,n){return n=n===i?1:pa(n),_r(Ss(e,t),n)},Mn.flatten=zo,Mn.flattenDeep=function(e){return null!=e&&e.length?_r(e,l):[]},Mn.flattenDepth=function(e,t){return null!=e&&e.length?_r(e,t=t===i?1:pa(t)):[]},Mn.flip=function(e){return Qi(e,512)},Mn.flow=ec,Mn.flowRight=tc,Mn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Mn.functions=function(e){return null==e?[]:br(e,Ca(e))},Mn.functionsIn=function(e){return null==e?[]:br(e,Aa(e))},Mn.groupBy=ys,Mn.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},Mn.intersection=Go,Mn.intersectionBy=Ho,Mn.intersectionWith=Qo,Mn.invert=Oa,Mn.invertBy=Ia,Mn.invokeMap=bs,Mn.iteratee=rc,Mn.keyBy=ws,Mn.keys=Ca,Mn.keysIn=Aa,Mn.map=Ss,Mn.mapKeys=function(e,t){var n={};return t=oo(t,3),vr(e,(function(e,r,i){rr(n,t(e,r,i),e)})),n},Mn.mapValues=function(e,t){var n={};return t=oo(t,3),vr(e,(function(e,r,i){rr(n,r,t(e,r,i))})),n},Mn.matches=function(e){return Br(sr(e,1))},Mn.matchesProperty=function(e,t){return Mr(e,sr(t,1))},Mn.memoize=Ls,Mn.merge=Na,Mn.mergeWith=La,Mn.method=ic,Mn.methodOf=oc,Mn.mixin=sc,Mn.negate=Us,Mn.nthArg=function(e){return e=pa(e),Hr((function(t){return Wr(t,e)}))},Mn.omit=Ua,Mn.omitBy=function(e,t){return ja(e,Us(oo(t)))},Mn.once=function(e){return Os(2,e)},Mn.orderBy=function(e,t,n,r){return null==e?[]:(Vs(t)||(t=null==t?[]:[t]),Vs(n=r?i:n)||(n=null==n?[]:[n]),qr(e,t,n))},Mn.over=cc,Mn.overArgs=Rs,Mn.overEvery=uc,Mn.overSome=lc,Mn.partial=js,Mn.partialRight=Bs,Mn.partition=ks,Mn.pick=Ra,Mn.pickBy=ja,Mn.property=fc,Mn.propertyOf=function(e){return function(t){return null==e?i:wr(e,t)}},Mn.pull=Ko,Mn.pullAll=Zo,Mn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Vr(e,t,oo(n,2)):e},Mn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Vr(e,t,i,n):e},Mn.pullAt=Xo,Mn.range=hc,Mn.rangeRight=pc,Mn.rearg=Ms,Mn.reject=function(e,t){return(Vs(e)?It:dr)(e,Us(oo(t,3)))},Mn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return zr(e,i),n},Mn.rest=function(e,t){if("function"!=typeof e)throw new Oe(o);return Hr(e,t=t===i?t:pa(t))},Mn.reverse=Jo,Mn.sampleSize=function(e,t,n){return t=(n?mo(e,t,n):t===i)?1:pa(t),(Vs(e)?Kn:Yr)(e,t)},Mn.set=function(e,t,n){return null==e?e:Kr(e,t,n)},Mn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Kr(e,t,n,r)},Mn.shuffle=function(e){return(Vs(e)?Zn:Jr)(e)},Mn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&mo(e,t,n)?(t=0,n=r):(t=null==t?0:pa(t),n=n===i?r:pa(n)),ei(e,t,n)):[]},Mn.sortBy=xs,Mn.sortedUniq=function(e){return e&&e.length?ii(e):[]},Mn.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},Mn.split=function(e,t,n){return n&&"number"!=typeof n&&mo(e,t,n)&&(t=n=i),(n=n===i?p:n>>>0)?(e=ma(e))&&("string"==typeof t||null!=t&&!ia(t))&&!(t=si(t))&&rn(e)?vi(fn(e),0,n):e.split(t,n):[]},Mn.spread=function(e,t){if("function"!=typeof e)throw new Oe(o);return t=null==t?0:gn(pa(t),0),Hr((function(n){var r=n[t],i=vi(n,0,t);return r&&Nt(i,r),kt(e,this,i)}))},Mn.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},Mn.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:pa(t))<0?0:t):[]},Mn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:pa(t)))<0?0:t,r):[]},Mn.takeRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!1,!0):[]},Mn.takeWhile=function(e,t){return e&&e.length?li(e,oo(t,3)):[]},Mn.tap=function(e,t){return t(e),e},Mn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Oe(o);return Js(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Cs(e,t,{leading:r,maxWait:t,trailing:i})},Mn.thru=hs,Mn.toArray=fa,Mn.toPairs=Ba,Mn.toPairsIn=Ma,Mn.toPath=function(e){return Vs(e)?At(e,jo):aa(e)?[e]:Ti(Ro(ma(e)))},Mn.toPlainObject=ga,Mn.transform=function(e,t,n){var r=Vs(e),i=r||Hs(e)||ca(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Js(e)&&Ks(o)?Dn(ze(e)):{}}return(i?Et:vr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Mn.unary=function(e){return Ts(e,1)},Mn.union=es,Mn.unionBy=ts,Mn.unionWith=ns,Mn.uniq=function(e){return e&&e.length?ai(e):[]},Mn.uniqBy=function(e,t){return e&&e.length?ai(e,oo(t,2)):[]},Mn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ai(e,i,t):[]},Mn.unset=function(e,t){return null==e||ci(e,t)},Mn.unzip=rs,Mn.unzipWith=is,Mn.update=function(e,t,n){return null==e?e:ui(e,t,_i(n))},Mn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ui(e,t,_i(n),r)},Mn.values=Da,Mn.valuesIn=function(e){return null==e?[]:Kt(e,Aa(e))},Mn.without=os,Mn.words=Ka,Mn.wrap=function(e,t){return js(_i(t),e)},Mn.xor=ss,Mn.xorBy=as,Mn.xorWith=cs,Mn.zip=us,Mn.zipObject=function(e,t){return pi(e||[],t||[],Jn)},Mn.zipObjectDeep=function(e,t){return pi(e||[],t||[],Kr)},Mn.zipWith=ls,Mn.entries=Ba,Mn.entriesIn=Ma,Mn.extend=ya,Mn.extendWith=ba,sc(Mn,Mn),Mn.add=mc,Mn.attempt=Za,Mn.camelCase=Wa,Mn.capitalize=qa,Mn.ceil=vc,Mn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=_a(n))==n?n:0),t!==i&&(t=(t=_a(t))==t?t:0),or(_a(e),t,n)},Mn.clone=function(e){return sr(e,4)},Mn.cloneDeep=function(e){return sr(e,5)},Mn.cloneDeepWith=function(e,t){return sr(e,5,t="function"==typeof t?t:i)},Mn.cloneWith=function(e,t){return sr(e,4,t="function"==typeof t?t:i)},Mn.conformsTo=function(e,t){return null==t||ar(e,t,Ca(t))},Mn.deburr=Fa,Mn.defaultTo=function(e,t){return null==e||e!=e?t:e},Mn.divide=yc,Mn.endsWith=function(e,t,n){e=ma(e),t=si(t);var r=e.length,o=n=n===i?r:or(pa(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Mn.eq=Ds,Mn.escape=function(e){return(e=ma(e))&&Q.test(e)?e.replace(G,tn):e},Mn.escapeRegExp=function(e){return(e=ma(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Mn.every=function(e,t,n){var r=Vs(e)?Ot:hr;return n&&mo(e,t,n)&&(t=i),r(e,oo(t,3))},Mn.find=_s,Mn.findIndex=Fo,Mn.findKey=function(e,t){return Bt(e,oo(t,3),vr)},Mn.findLast=gs,Mn.findLastIndex=Vo,Mn.findLastKey=function(e,t){return Bt(e,oo(t,3),yr)},Mn.floor=bc,Mn.forEach=ms,Mn.forEachRight=vs,Mn.forIn=function(e,t){return null==e?e:gr(e,oo(t,3),Aa)},Mn.forInRight=function(e,t){return null==e?e:mr(e,oo(t,3),Aa)},Mn.forOwn=function(e,t){return e&&vr(e,oo(t,3))},Mn.forOwnRight=function(e,t){return e&&yr(e,oo(t,3))},Mn.get=Ea,Mn.gt=Ws,Mn.gte=qs,Mn.has=function(e,t){return null!=e&&ho(e,t,Er)},Mn.hasIn=Ta,Mn.head=$o,Mn.identity=nc,Mn.includes=function(e,t,n,r){e=$s(e)?e:Da(e),n=n&&!r?pa(n):0;var i=e.length;return n<0&&(n=gn(i+n,0)),sa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Dt(e,t,n)>-1},Mn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=gn(r+i,0)),Dt(e,t,i)},Mn.inRange=function(e,t,n){return t=ha(t),n===i?(n=t,t=0):n=ha(n),function(e,t,n){return e>=mn(t,n)&&e<gn(t,n)}(e=_a(e),t,n)},Mn.invoke=Pa,Mn.isArguments=Fs,Mn.isArray=Vs,Mn.isArrayBuffer=zs,Mn.isArrayLike=$s,Mn.isArrayLikeObject=Gs,Mn.isBoolean=function(e){return!0===e||!1===e||ea(e)&&kr(e)==m},Mn.isBuffer=Hs,Mn.isDate=Qs,Mn.isElement=function(e){return ea(e)&&1===e.nodeType&&!ra(e)},Mn.isEmpty=function(e){if(null==e)return!0;if($s(e)&&(Vs(e)||"string"==typeof e||"function"==typeof e.splice||Hs(e)||ca(e)||Fs(e)))return!e.length;var t=fo(e);if(t==S||t==O)return!e.size;if(wo(e))return!Ur(e).length;for(var n in e)if(Le.call(e,n))return!1;return!0},Mn.isEqual=function(e,t){return Cr(e,t)},Mn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Cr(e,t,i,n):!!r},Mn.isError=Ys,Mn.isFinite=function(e){return"number"==typeof e&&jt(e)},Mn.isFunction=Ks,Mn.isInteger=Zs,Mn.isLength=Xs,Mn.isMap=ta,Mn.isMatch=function(e,t){return e===t||Ar(e,t,ao(t))},Mn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Ar(e,t,ao(t),n)},Mn.isNaN=function(e){return na(e)&&e!=+e},Mn.isNative=function(e){if(bo(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Nr(e)},Mn.isNil=function(e){return null==e},Mn.isNull=function(e){return null===e},Mn.isNumber=na,Mn.isObject=Js,Mn.isObjectLike=ea,Mn.isPlainObject=ra,Mn.isRegExp=ia,Mn.isSafeInteger=function(e){return Zs(e)&&e>=-9007199254740991&&e<=f},Mn.isSet=oa,Mn.isString=sa,Mn.isSymbol=aa,Mn.isTypedArray=ca,Mn.isUndefined=function(e){return e===i},Mn.isWeakMap=function(e){return ea(e)&&fo(e)==C},Mn.isWeakSet=function(e){return ea(e)&&"[object WeakSet]"==kr(e)},Mn.join=function(e,t){return null==e?"":zt.call(e,t)},Mn.kebabCase=Va,Mn.last=Yo,Mn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=pa(n))<0?gn(r+o,0):mn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Mt(e,qt,o,!0)},Mn.lowerCase=za,Mn.lowerFirst=$a,Mn.lt=ua,Mn.lte=la,Mn.max=function(e){return e&&e.length?pr(e,nc,xr):i},Mn.maxBy=function(e,t){return e&&e.length?pr(e,oo(t,2),xr):i},Mn.mean=function(e){return Ft(e,nc)},Mn.meanBy=function(e,t){return Ft(e,oo(t,2))},Mn.min=function(e){return e&&e.length?pr(e,nc,Rr):i},Mn.minBy=function(e,t){return e&&e.length?pr(e,oo(t,2),Rr):i},Mn.stubArray=dc,Mn.stubFalse=_c,Mn.stubObject=function(){return{}},Mn.stubString=function(){return""},Mn.stubTrue=function(){return!0},Mn.multiply=wc,Mn.nth=function(e,t){return e&&e.length?Wr(e,pa(t)):i},Mn.noConflict=function(){return ft._===this&&(ft._=Me),this},Mn.noop=ac,Mn.now=Es,Mn.pad=function(e,t,n){e=ma(e);var r=(t=pa(t))?ln(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return qi(pt(i),n)+e+qi(ht(i),n)},Mn.padEnd=function(e,t,n){e=ma(e);var r=(t=pa(t))?ln(e):0;return t&&r<t?e+qi(t-r,n):e},Mn.padStart=function(e,t,n){e=ma(e);var r=(t=pa(t))?ln(e):0;return t&&r<t?qi(t-r,n)+e:e},Mn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(ma(e).replace(re,""),t||0)},Mn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&mo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ha(e),t===i?(t=e,e=0):t=ha(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=bn();return mn(e+o*(t-e+at("1e-"+((o+"").length-1))),t)}return $r(e,t)},Mn.reduce=function(e,t,n){var r=Vs(e)?Lt:$t,i=arguments.length<3;return r(e,oo(t,4),n,i,lr)},Mn.reduceRight=function(e,t,n){var r=Vs(e)?Ut:$t,i=arguments.length<3;return r(e,oo(t,4),n,i,fr)},Mn.repeat=function(e,t,n){return t=(n?mo(e,t,n):t===i)?1:pa(t),Gr(ma(e),t)},Mn.replace=function(){var e=arguments,t=ma(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Mn.result=function(e,t,n){var r=-1,o=(t=gi(t,e)).length;for(o||(o=1,e=i);++r<o;){var s=null==e?i:e[jo(t[r])];s===i&&(r=o,s=n),e=Ks(s)?s.call(e):s}return e},Mn.round=Sc,Mn.runInContext=e,Mn.sample=function(e){return(Vs(e)?Yn:Qr)(e)},Mn.size=function(e){if(null==e)return 0;if($s(e))return sa(e)?ln(e):e.length;var t=fo(e);return t==S||t==O?e.size:Ur(e).length},Mn.snakeCase=Ga,Mn.some=function(e,t,n){var r=Vs(e)?Rt:ti;return n&&mo(e,t,n)&&(t=i),r(e,oo(t,3))},Mn.sortedIndex=function(e,t){return ni(e,t)},Mn.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},Mn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&Ds(e[r],t))return r}return-1},Mn.sortedLastIndex=function(e,t){return ni(e,t,!0)},Mn.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},Mn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(Ds(e[n],t))return n}return-1},Mn.startCase=Ha,Mn.startsWith=function(e,t,n){return e=ma(e),n=null==n?0:or(pa(n),0,e.length),t=si(t),e.slice(n,n+t.length)==t},Mn.subtract=kc,Mn.sum=function(e){return e&&e.length?Gt(e,nc):0},Mn.sumBy=function(e,t){return e&&e.length?Gt(e,oo(t,2)):0},Mn.template=function(e,t,n){var r=Mn.templateSettings;n&&mo(e,t,n)&&(t=i),e=ma(e),t=ba({},t,r,Yi);var o,s,a=ba({},t.imports,r.imports,Yi),c=Ca(a),u=Kt(a,c),l=0,f=t.interpolate||ye,h="__p += '",p=Ee((t.escape||ye).source+"|"+f.source+"|"+(f===Z?fe:ye).source+"|"+(t.evaluate||ye).source+"|$","g"),d="//# sourceURL="+(Le.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(p,(function(t,n,r,i,a,c){return r||(r=i),h+=e.slice(l,c).replace(be,nn),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),h+="';\n";var _=Le.call(t,"variable")&&t.variable;if(_){if(ue.test(_))throw new we("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(F,""):h).replace(V,"$1").replace(z,"$1;"),h="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Za((function(){return Se(c,d+"return "+h).apply(i,u)}));if(g.source=h,Ys(g))throw g;return g},Mn.times=function(e,t){if((e=pa(e))<1||e>f)return[];var n=p,r=mn(e,p);t=oo(t),e-=p;for(var i=Ht(r,t);++n<e;)t(n);return i},Mn.toFinite=ha,Mn.toInteger=pa,Mn.toLength=da,Mn.toLower=function(e){return ma(e).toLowerCase()},Mn.toNumber=_a,Mn.toSafeInteger=function(e){return e?or(pa(e),-9007199254740991,f):0===e?e:0},Mn.toString=ma,Mn.toUpper=function(e){return ma(e).toUpperCase()},Mn.trim=function(e,t,n){if((e=ma(e))&&(n||t===i))return Qt(e);if(!e||!(t=si(t)))return e;var r=fn(e),o=fn(t);return vi(r,Xt(r,o),Jt(r,o)+1).join("")},Mn.trimEnd=function(e,t,n){if((e=ma(e))&&(n||t===i))return e.slice(0,hn(e)+1);if(!e||!(t=si(t)))return e;var r=fn(e);return vi(r,0,Jt(r,fn(t))+1).join("")},Mn.trimStart=function(e,t,n){if((e=ma(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=si(t)))return e;var r=fn(e);return vi(r,Xt(r,fn(t))).join("")},Mn.truncate=function(e,t){var n=30,r="...";if(Js(t)){var o="separator"in t?t.separator:o;n="length"in t?pa(t.length):n,r="omission"in t?si(t.omission):r}var s=(e=ma(e)).length;if(rn(e)){var a=fn(e);s=a.length}if(n>=s)return e;var c=n-ln(r);if(c<1)return r;var u=a?vi(a,0,c).join(""):e.slice(0,c);if(o===i)return u+r;if(a&&(c+=u.length-c),ia(o)){if(e.slice(c).search(o)){var l,f=u;for(o.global||(o=Ee(o.source,ma(he.exec(o))+"g")),o.lastIndex=0;l=o.exec(f);)var h=l.index;u=u.slice(0,h===i?c:h)}}else if(e.indexOf(si(o),c)!=c){var p=u.lastIndexOf(o);p>-1&&(u=u.slice(0,p))}return u+r},Mn.unescape=function(e){return(e=ma(e))&&H.test(e)?e.replace($,pn):e},Mn.uniqueId=function(e){var t=++Ue;return ma(e)+t},Mn.upperCase=Qa,Mn.upperFirst=Ya,Mn.each=ms,Mn.eachRight=vs,Mn.first=$o,sc(Mn,(gc={},vr(Mn,(function(e,t){Le.call(Mn.prototype,t)||(gc[t]=e)})),gc),{chain:!1}),Mn.VERSION="4.17.21",Et(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Mn[e].placeholder=Mn})),Et(["drop","take"],(function(e,t){Fn.prototype[e]=function(n){n=n===i?1:gn(pa(n),0);var r=this.__filtered__&&!t?new Fn(this):this.clone();return r.__filtered__?r.__takeCount__=mn(n,r.__takeCount__):r.__views__.push({size:mn(n,p),type:e+(r.__dir__<0?"Right":"")}),r},Fn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Et(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Fn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Et(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Fn.prototype[e]=function(){return this[n](1).value()[0]}})),Et(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Fn.prototype[e]=function(){return this.__filtered__?new Fn(this):this[n](1)}})),Fn.prototype.compact=function(){return this.filter(nc)},Fn.prototype.find=function(e){return this.filter(e).head()},Fn.prototype.findLast=function(e){return this.reverse().find(e)},Fn.prototype.invokeMap=Hr((function(e,t){return"function"==typeof e?new Fn(this):this.map((function(n){return Ir(n,e,t)}))})),Fn.prototype.reject=function(e){return this.filter(Us(oo(e)))},Fn.prototype.slice=function(e,t){e=pa(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Fn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=pa(t))<0?n.dropRight(-t):n.take(t-e)),n)},Fn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Fn.prototype.toArray=function(){return this.take(p)},vr(Fn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Mn[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(Mn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof Fn,u=a[0],l=c||Vs(t),f=function(e){var t=o.apply(Mn,Nt([e],a));return r&&h?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var h=this.__chain__,p=!!this.__actions__.length,d=s&&!h,_=c&&!p;if(!s&&l){t=_?t:new Fn(this);var g=e.apply(t,a);return g.__actions__.push({func:hs,args:[f],thisArg:i}),new qn(g,h)}return d&&_?e.apply(this,a):(g=this.thru(f),d?r?g.value()[0]:g.value():g)})})),Et(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ie[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Mn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Vs(i)?i:[],e)}return this[n]((function(n){return t.apply(Vs(n)?n:[],e)}))}})),vr(Fn.prototype,(function(e,t){var n=Mn[t];if(n){var r=n.name+"";Le.call(Pn,r)||(Pn[r]=[]),Pn[r].push({name:t,func:n})}})),Pn[Bi(i,2).name]=[{name:"wrapper",func:i}],Fn.prototype.clone=function(){var e=new Fn(this.__wrapped__);return e.__actions__=Ti(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ti(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ti(this.__views__),e},Fn.prototype.reverse=function(){if(this.__filtered__){var e=new Fn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Fn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Vs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=mn(t,e+s);break;case"takeRight":e=gn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=r?a:s-1,l=this.__iteratees__,f=l.length,h=0,p=mn(c,this.__takeCount__);if(!n||!r&&i==c&&p==c)return fi(e,this.__actions__);var d=[];e:for(;c--&&h<p;){for(var _=-1,g=e[u+=t];++_<f;){var m=l[_],v=m.iteratee,y=m.type,b=v(g);if(2==y)g=b;else if(!b){if(1==y)continue e;break e}}d[h++]=g}return d},Mn.prototype.at=ps,Mn.prototype.chain=function(){return fs(this)},Mn.prototype.commit=function(){return new qn(this.value(),this.__chain__)},Mn.prototype.next=function(){this.__values__===i&&(this.__values__=fa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Mn.prototype.plant=function(e){for(var t,n=this;n instanceof Wn;){var r=Mo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Mn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Fn){var t=e;return this.__actions__.length&&(t=new Fn(this)),(t=t.reverse()).__actions__.push({func:hs,args:[Jo],thisArg:i}),new qn(t,this.__chain__)}return this.thru(Jo)},Mn.prototype.toJSON=Mn.prototype.valueOf=Mn.prototype.value=function(){return fi(this.__wrapped__,this.__actions__)},Mn.prototype.first=Mn.prototype.head,Ye&&(Mn.prototype[Ye]=function(){return this}),Mn}();ft._=dn,(r=function(){return dn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},1455:(e,t,n)=>{"use strict";const r=n(2361).EventEmitter,i=n(7431),o=n(6565),s=n(3744),a=n(918),c=n(6156),u=n(3248).Writable,l=n(3766),f=n(5393),h=n(9950),p=n(4028),d=n(5170),_=n(6974)("mqttjs:client"),g=process?process.nextTick:function(e){setTimeout(e,0)},m=global.setImmediate||function(e){g(e)},v={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},y=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],b={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function w(e,t){let n;t.properties&&(n=t.properties.topicAlias);let r=t.topic.toString();if(0===r.length){if(void 0===n)return new Error("Unregistered Topic Alias");if(r=e.topicAliasSend.getTopicByAlias(n),void 0===r)return new Error("Unregistered Topic Alias");t.topic=r}n&&delete t.properties.topicAlias}function S(e,t,n){_("sendPacket :: packet: %O",t),_("sendPacket :: emitting `packetsend`"),e.emit("packetsend",t),_("sendPacket :: writing to stream");const r=a.writeToStream(t,e.stream,e.options);_("sendPacket :: writeToStream result %s",r),!r&&n&&n!==x?(_("sendPacket :: handle events on `drain` once through callback."),e.stream.once("drain",n)):n&&(_("sendPacket :: invoking cb"),n())}function k(e,t,n,r){_("storeAndSend :: store packet with cmd %s to outgoingStore",t.cmd);let i,o=t;if("publish"===o.cmd&&(o=h(t),i=w(e,o),i))return n&&n(i);e.outgoingStore.put(o,(function(i){if(i)return n&&n(i);r(),S(e,t,n)}))}function x(e){_("nop ::",e)}function E(e,t){let n;const s=this;if(!(this instanceof E))return new E(e,t);for(n in this.options=t||{},v)void 0===this.options[n]?this.options[n]=v[n]:this.options[n]=t[n];_("MqttClient :: options.protocol",t.protocol),_("MqttClient :: options.protocolVersion",t.protocolVersion),_("MqttClient :: options.username",t.username),_("MqttClient :: options.keepalive",t.keepalive),_("MqttClient :: options.reconnectPeriod",t.reconnectPeriod),_("MqttClient :: options.rejectUnauthorized",t.rejectUnauthorized),_("MqttClient :: options.topicAliasMaximum",t.topicAliasMaximum),this.options.clientId="string"==typeof t.clientId?t.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),_("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===t.protocolVersion&&t.customHandleAcks?t.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=e,this.messageIdProvider=void 0===this.options.messageIdProvider?new c:this.options.messageIdProvider,this.outgoingStore=t.outgoingStore||new i,this.incomingStore=t.incomingStore||new i,this.queueQoSZero=void 0===t.queueQoSZero||t.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,t.topicAliasMaximum>0&&(t.topicAliasMaximum>65535?_("MqttClient :: options.topicAliasMaximum is out of range"):this.topicAliasRecv=new o(t.topicAliasMaximum)),this.on("connect",(function(){const e=this.queue;_("connect :: sending queued packets"),function t(){const n=e.shift();_("deliver :: entry %o",n);let r=null;if(!n)return void s._resubscribe();r=n.packet,_("deliver :: call _sendPacket for %o",r);let i=!0;r.messageId&&0!==r.messageId&&(s.messageIdProvider.register(r.messageId)||(i=!1)),i?s._sendPacket(r,(function(e){n.cb&&n.cb(e),t()})):(_("messageId: %d has already used. The message is skipped and removed.",r.messageId),t())}()})),this.on("close",(function(){_("close :: connected set to `false`"),this.connected=!1,_("close :: clearing connackTimer"),clearTimeout(this.connackTimer),_("close :: clearing ping timer"),null!==s.pingTimer&&(s.pingTimer.clear(),s.pingTimer=null),this.topicAliasRecv&&this.topicAliasRecv.clear(),_("close :: calling _setupReconnect"),this._setupReconnect()})),r.call(this),_("MqttClient :: setting up stream"),this._setupStream()}l(E,r),E.prototype._setupStream=function(){const e=this,t=new u,n=a.parser(this.options);let r=null;const i=[];function o(){if(i.length)g(s);else{const e=r;r=null,e()}}function s(){_("work :: getting next packet in queue");const t=i.shift();if(t)_("work :: packet pulled from queue"),e._handlePacket(t,o);else{_("work :: no packets in queue");const e=r;r=null,_("work :: done flag is %s",!!e),e&&e()}}_("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),_("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),n.on("packet",(function(e){_("parser :: on packet push to packets array."),i.push(e)})),t._write=function(e,t,i){r=i,_("writable stream :: parsing buffer"),n.parse(e),s()},_("_setupStream :: pipe stream to writable stream"),this.stream.pipe(t),this.stream.on("error",(function(t){_("streamErrorHandler :: error",t.message),y.includes(t.code)?(_("streamErrorHandler :: emitting error"),e.emit("error",t)):x(t)})),this.stream.on("close",(function(){var t;_("(%s)stream :: on close",e.options.clientId),(t=e.outgoing)&&(_("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(t).forEach((function(e){t[e].volatile&&"function"==typeof t[e].cb&&(t[e].cb(new Error("Connection closed")),delete t[e])}))),_("stream: emit close to MqttClient"),e.emit("close")})),_("_setupStream: sending packet `connect`");const c=Object.create(this.options);if(c.cmd="connect",this.topicAliasRecv&&(c.properties||(c.properties={}),this.topicAliasRecv&&(c.properties.topicAliasMaximum=this.topicAliasRecv.max)),S(this,c),n.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return e.end((()=>this.emit("error",new Error("Packet has no Authentication Method")))),this;this.options.properties.authenticationMethod&&this.options.authPacket&&"object"==typeof this.options.authPacket&&S(this,d({cmd:"auth",reasonCode:0},this.options.authPacket))}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout((function(){_("!!connectTimeout hit!! Calling _cleanUp with force `true`"),e._cleanUp(!0)}),this.options.connectTimeout)},E.prototype._handlePacket=function(e,t){const n=this.options;if(5===n.protocolVersion&&n.properties&&n.properties.maximumPacketSize&&n.properties.maximumPacketSize<e.length)return this.emit("error",new Error("exceeding packets size "+e.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(_("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",e),e.cmd){case"publish":this._handlePublish(e,t);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(e),t();break;case"pubrel":this._handlePubrel(e,t);break;case"connack":this._handleConnack(e),t();break;case"auth":this._handleAuth(e),t();break;case"pingresp":this._handlePingresp(e),t();break;case"disconnect":this._handleDisconnect(e),t()}},E.prototype._checkDisconnecting=function(e){return this.disconnecting&&(e&&e!==x?e(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},E.prototype.publish=function(e,t,n,r){_("publish :: message `%s` to topic `%s`",t,e);const i=this.options;if("function"==typeof n&&(r=n,n=null),n=d({qos:0,retain:!1,dup:!1},n),this._checkDisconnecting(r))return this;const o=this,s=function(){let s=0;if((1===n.qos||2===n.qos)&&(s=o._nextId(),null===s))return _("No messageId left"),!1;const a={cmd:"publish",topic:e,payload:t,qos:n.qos,retain:n.retain,messageId:s,dup:n.dup};switch(5===i.protocolVersion&&(a.properties=n.properties),_("publish :: qos",n.qos),n.qos){case 1:case 2:o.outgoing[a.messageId]={volatile:!1,cb:r||x},_("MqttClient:publish: packet cmd: %s",a.cmd),o._sendPacket(a,void 0,n.cbStorePut);break;default:_("MqttClient:publish: packet cmd: %s",a.cmd),o._sendPacket(a,r,n.cbStorePut)}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!s())&&this._storeProcessingQueue.push({invoke:s,cbStorePut:n.cbStorePut,callback:r}),this},E.prototype.subscribe=function(){const e=this,t=new Array(arguments.length);for(let e=0;e<arguments.length;e++)t[e]=arguments[e];const n=[];let r=t.shift();const i=r.resubscribe;let o=t.pop()||x,s=t.pop();const a=this.options.protocolVersion;delete r.resubscribe,"string"==typeof r&&(r=[r]),"function"!=typeof o&&(s=o,o=x);const c=p.validateTopics(r);if(null!==c)return m(o,new Error("Invalid topic "+c)),this;if(this._checkDisconnecting(o))return _("subscribe: discconecting true"),this;const u={qos:0};if(5===a&&(u.nl=!1,u.rap=!1,u.rh=0),s=d(u,s),Array.isArray(r)?r.forEach((function(t){if(_("subscribe: array topic %s",t),!Object.prototype.hasOwnProperty.call(e._resubscribeTopics,t)||e._resubscribeTopics[t].qos<s.qos||i){const e={topic:t,qos:s.qos};5===a&&(e.nl=s.nl,e.rap=s.rap,e.rh=s.rh,e.properties=s.properties),_("subscribe: pushing topic `%s` and qos `%s` to subs list",e.topic,e.qos),n.push(e)}})):Object.keys(r).forEach((function(t){if(_("subscribe: object topic %s",t),!Object.prototype.hasOwnProperty.call(e._resubscribeTopics,t)||e._resubscribeTopics[t].qos<r[t].qos||i){const e={topic:t,qos:r[t].qos};5===a&&(e.nl=r[t].nl,e.rap=r[t].rap,e.rh=r[t].rh,e.properties=s.properties),_("subscribe: pushing `%s` to subs list",e),n.push(e)}})),!n.length)return o(null,[]),this;const l=function(){const t=e._nextId();if(null===t)return _("No messageId left"),!1;const r={cmd:"subscribe",subscriptions:n,qos:1,retain:!1,dup:!1,messageId:t};if(s.properties&&(r.properties=s.properties),e.options.resubscribe){_("subscribe :: resubscribe true");const t=[];n.forEach((function(n){if(e.options.reconnectPeriod>0){const r={qos:n.qos};5===a&&(r.nl=n.nl||!1,r.rap=n.rap||!1,r.rh=n.rh||0,r.properties=n.properties),e._resubscribeTopics[n.topic]=r,t.push(n.topic)}})),e.messageIdToTopic[r.messageId]=t}return e.outgoing[r.messageId]={volatile:!0,cb:function(e,t){if(!e){const e=t.granted;for(let t=0;t<e.length;t+=1)n[t].qos=e[t]}o(e,n)}},_("subscribe :: call _sendPacket"),e._sendPacket(r),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!l())&&this._storeProcessingQueue.push({invoke:l,callback:o}),this},E.prototype.unsubscribe=function(){const e=this,t=new Array(arguments.length);for(let e=0;e<arguments.length;e++)t[e]=arguments[e];let n=t.shift(),r=t.pop()||x,i=t.pop();"string"==typeof n&&(n=[n]),"function"!=typeof r&&(i=r,r=x);const o=p.validateTopics(n);if(null!==o)return m(r,new Error("Invalid topic "+o)),this;if(e._checkDisconnecting(r))return this;const s=function(){const t=e._nextId();if(null===t)return _("No messageId left"),!1;const o={cmd:"unsubscribe",qos:1,messageId:t};return"string"==typeof n?o.unsubscriptions=[n]:Array.isArray(n)&&(o.unsubscriptions=n),e.options.resubscribe&&o.unsubscriptions.forEach((function(t){delete e._resubscribeTopics[t]})),"object"==typeof i&&i.properties&&(o.properties=i.properties),e.outgoing[o.messageId]={volatile:!0,cb:r},_("unsubscribe: call _sendPacket"),e._sendPacket(o),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!s())&&this._storeProcessingQueue.push({invoke:s,callback:r}),this},E.prototype.end=function(e,t,n){const r=this;function i(){_("end :: closeStores: closing incoming and outgoing stores"),r.disconnected=!0,r.incomingStore.close((function(e){r.outgoingStore.close((function(t){if(_("end :: closeStores: emitting end"),r.emit("end"),n){const r=e||t;_("end :: closeStores: invoking callback with args"),n(r)}}))})),r._deferredReconnect&&r._deferredReconnect()}function o(){_("end :: (%s) :: finish :: calling _cleanUp with force %s",r.options.clientId,e),r._cleanUp(e,(()=>{_("end :: finish :: calling process.nextTick on closeStores"),g(i.bind(r))}),t)}return _("end :: (%s)",this.options.clientId),null!=e&&"boolean"==typeof e||(n=t||x,t=e,e=!1,"object"!=typeof t&&(n=t,t=null,"function"!=typeof n&&(n=x))),"object"!=typeof t&&(n=t,t=null),_("end :: cb? %s",!!n),n=n||x,this.disconnecting?(n(),this):(this._clearReconnect(),this.disconnecting=!0,!e&&Object.keys(this.outgoing).length>0?(_("end :: (%s) :: calling finish in 10ms once outgoing is empty",r.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,o,10))):(_("end :: (%s) :: immediately calling finish",r.options.clientId),o()),this)},E.prototype.removeOutgoingMessage=function(e){const t=this.outgoing[e]?this.outgoing[e].cb:null;return delete this.outgoing[e],this.outgoingStore.del({messageId:e},(function(){t(new Error("Message removed"))})),this},E.prototype.reconnect=function(e){_("client reconnect");const t=this,n=function(){e?(t.options.incomingStore=e.incomingStore,t.options.outgoingStore=e.outgoingStore):(t.options.incomingStore=null,t.options.outgoingStore=null),t.incomingStore=t.options.incomingStore||new i,t.outgoingStore=t.options.outgoingStore||new i,t.disconnecting=!1,t.disconnected=!1,t._deferredReconnect=null,t._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=n:n(),this},E.prototype._reconnect=function(){_("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end((()=>{this._setupStream()})),_("client already connected. disconnecting first.")):(_("_reconnect: calling _setupStream"),this._setupStream())},E.prototype._setupReconnect=function(){const e=this;!e.disconnecting&&!e.reconnectTimer&&e.options.reconnectPeriod>0?(this.reconnecting||(_("_setupReconnect :: emit `offline` state"),this.emit("offline"),_("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),_("_setupReconnect :: setting reconnectTimer for %d ms",e.options.reconnectPeriod),e.reconnectTimer=setInterval((function(){_("reconnectTimer :: reconnect triggered!"),e._reconnect()}),e.options.reconnectPeriod)):_("_setupReconnect :: doing nothing...")},E.prototype._clearReconnect=function(){_("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},E.prototype._cleanUp=function(e,t){const n=arguments[2];if(t&&(_("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",t)),_("_cleanUp :: forced? %s",e),e)0===this.options.reconnectPeriod&&this.options.clean&&(r=this.outgoing)&&(_("flush: queue exists? %b",!!r),Object.keys(r).forEach((function(e){"function"==typeof r[e].cb&&(r[e].cb(new Error("Connection closed")),delete r[e])}))),_("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{const e=d({cmd:"disconnect"},n);_("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(e,m.bind(null,this.stream.end.bind(this.stream)))}var r;this.disconnecting||(_("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(_("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),t&&!this.connected&&(_("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",t),t())},E.prototype._sendPacket=function(e,t,n){_("_sendPacket :: (%s) ::  start",this.options.clientId),n=n||x,t=t||x;const r=function(e,t){if(5===e.options.protocolVersion&&"publish"===t.cmd){let n;t.properties&&(n=t.properties.topicAlias);const r=t.topic.toString();if(e.topicAliasSend)if(n){if(0!==r.length&&(_("applyTopicAlias :: register topic: %s - alias: %d",r,n),!e.topicAliasSend.put(r,n)))return _("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,n),new Error("Sending Topic Alias out of range")}else 0!==r.length&&(e.options.autoAssignTopicAlias?(n=e.topicAliasSend.getAliasByTopic(r),n?(t.topic="",t.properties={...t.properties,topicAlias:n},_("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",r,n)):(n=e.topicAliasSend.getLruAlias(),e.topicAliasSend.put(r,n),t.properties={...t.properties,topicAlias:n},_("applyTopicAlias :: auto assign topic: %s - alias: %d",r,n))):e.options.autoUseTopicAlias&&(n=e.topicAliasSend.getAliasByTopic(r),n&&(t.topic="",t.properties={...t.properties,topicAlias:n},_("applyTopicAlias :: auto use topic: %s - alias: %d",r,n))));else if(n)return _("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,n),new Error("Sending Topic Alias out of range")}}(this,e);if(r)t(r);else{if(!this.connected)return"auth"===e.cmd?(this._shiftPingInterval(),void S(this,e,t)):(_("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(e,t,n));switch(this._shiftPingInterval(),e.cmd){case"publish":break;case"pubrel":return void k(this,e,t,n);default:return void S(this,e,t)}switch(e.qos){case 2:case 1:k(this,e,t,n);break;default:S(this,e,t)}_("_sendPacket :: (%s) ::  end",this.options.clientId)}},E.prototype._storePacket=function(e,t,n){_("_storePacket :: packet: %o",e),_("_storePacket :: cb? %s",!!t),n=n||x;let r=e;if("publish"===r.cmd){r=h(e);const n=w(this,r);if(n)return t&&t(n)}0===(r.qos||0)&&this.queueQoSZero||"publish"!==r.cmd?this.queue.push({packet:r,cb:t}):r.qos>0?(t=this.outgoing[r.messageId]?this.outgoing[r.messageId].cb:null,this.outgoingStore.put(r,(function(e){if(e)return t&&t(e);n()}))):t&&t(new Error("No connection to broker"))},E.prototype._setupPingTimer=function(){_("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);const e=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=f((function(){e._checkPing()}),1e3*this.options.keepalive))},E.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},E.prototype._checkPing=function(){_("_checkPing :: checking ping..."),this.pingResp?(_("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(_("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},E.prototype._handlePingresp=function(){this.pingResp=!0},E.prototype._handleConnack=function(e){_("_handleConnack");const t=this.options,n=5===t.protocolVersion?e.reasonCode:e.returnCode;if(clearTimeout(this.connackTimer),delete this.topicAliasSend,e.properties){if(e.properties.topicAliasMaximum){if(e.properties.topicAliasMaximum>65535)return void this.emit("error",new Error("topicAliasMaximum from broker is out of range"));e.properties.topicAliasMaximum>0&&(this.topicAliasSend=new s(e.properties.topicAliasMaximum))}e.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=e.properties.serverKeepAlive,this._shiftPingInterval()),e.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=e.properties.maximumPacketSize)}if(0===n)this.reconnecting=!1,this._onConnect(e);else if(n>0){const e=new Error("Connection refused: "+b[n]);e.code=n,this.emit("error",e)}},E.prototype._handleAuth=function(e){const t=this.options.protocolVersion,n=5===t?e.reasonCode:e.returnCode;if(5!==t){const e=new Error("Protocol error: Auth packets are only supported in MQTT 5. Your version:"+t);return e.code=n,void this.emit("error",e)}const r=this;this.handleAuth(e,(function(e,t){if(e)r.emit("error",e);else if(24===n)r.reconnecting=!1,r._sendPacket(t);else{const t=new Error("Connection refused: "+b[n]);e.code=n,r.emit("error",t)}}))},E.prototype.handleAuth=function(e,t){t()},E.prototype._handlePublish=function(e,t){_("_handlePublish: packet %o",e),t=void 0!==t?t:x;let n=e.topic.toString();const r=e.payload,i=e.qos,o=e.messageId,s=this,a=this.options,c=[0,16,128,131,135,144,145,151,153];if(5===this.options.protocolVersion){let t;if(e.properties&&(t=e.properties.topicAlias),void 0!==t)if(0===n.length){if(!(t>0&&t<=65535))return _("_handlePublish :: topic alias out of range. alias: %d",t),void this.emit("error",new Error("Received Topic Alias is out of range"));{const e=this.topicAliasRecv.getTopicByAlias(t);if(!e)return _("_handlePublish :: unregistered topic alias. alias: %d",t),void this.emit("error",new Error("Received unregistered Topic Alias"));n=e,_("_handlePublish :: topic complemented by alias. topic: %s - alias: %d",n,t)}}else{if(!this.topicAliasRecv.put(n,t))return _("_handlePublish :: topic alias out of range. alias: %d",t),void this.emit("error",new Error("Received Topic Alias is out of range"));_("_handlePublish :: registered topic: %s - alias: %d",n,t)}}switch(_("_handlePublish: qos %d",i),i){case 2:a.customHandleAcks(n,r,e,(function(n,r){return n instanceof Error||(r=n,n=null),n?s.emit("error",n):-1===c.indexOf(r)?s.emit("error",new Error("Wrong reason code for pubrec")):void(r?s._sendPacket({cmd:"pubrec",messageId:o,reasonCode:r},t):s.incomingStore.put(e,(function(){s._sendPacket({cmd:"pubrec",messageId:o},t)})))}));break;case 1:a.customHandleAcks(n,r,e,(function(i,a){return i instanceof Error||(a=i,i=null),i?s.emit("error",i):-1===c.indexOf(a)?s.emit("error",new Error("Wrong reason code for puback")):(a||s.emit("message",n,r,e),void s.handleMessage(e,(function(e){if(e)return t&&t(e);s._sendPacket({cmd:"puback",messageId:o,reasonCode:a},t)})))}));break;case 0:this.emit("message",n,r,e),this.handleMessage(e,t);break;default:_("_handlePublish: unknown QoS. Doing nothing.")}},E.prototype.handleMessage=function(e,t){t()},E.prototype._handleAck=function(e){const t=e.messageId,n=e.cmd;let r=null;const i=this.outgoing[t]?this.outgoing[t].cb:null,o=this;let s;if(i){switch(_("_handleAck :: packet type",n),n){case"pubcomp":case"puback":{const n=e.reasonCode;n&&n>0&&16!==n&&(s=new Error("Publish error: "+b[n]),s.code=n,i(s,e)),delete this.outgoing[t],this.outgoingStore.del(e,i),this.messageIdProvider.deallocate(t),this._invokeStoreProcessingQueue();break}case"pubrec":{r={cmd:"pubrel",qos:2,messageId:t};const n=e.reasonCode;n&&n>0&&16!==n?(s=new Error("Publish error: "+b[n]),s.code=n,i(s,e)):this._sendPacket(r);break}case"suback":delete this.outgoing[t],this.messageIdProvider.deallocate(t);for(let n=0;n<e.granted.length;n++)if(0!=(128&e.granted[n])){const e=this.messageIdToTopic[t];e&&e.forEach((function(e){delete o._resubscribeTopics[e]}))}this._invokeStoreProcessingQueue(),i(null,e);break;case"unsuback":delete this.outgoing[t],this.messageIdProvider.deallocate(t),this._invokeStoreProcessingQueue(),i(null);break;default:o.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else _("_handleAck :: Server sent an ack in error. Ignoring.")},E.prototype._handlePubrel=function(e,t){_("handling pubrel packet"),t=void 0!==t?t:x;const n=e.messageId,r=this,i={cmd:"pubcomp",messageId:n};r.incomingStore.get(e,(function(e,n){e?r._sendPacket(i,t):(r.emit("message",n.topic,n.payload,n),r.handleMessage(n,(function(e){if(e)return t(e);r.incomingStore.del(n,x),r._sendPacket(i,t)})))}))},E.prototype._handleDisconnect=function(e){this.emit("disconnect",e)},E.prototype._nextId=function(){return this.messageIdProvider.allocate()},E.prototype.getLastMessageId=function(){return this.messageIdProvider.getLastAllocated()},E.prototype._resubscribe=function(){_("_resubscribe");const e=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!this.connackPacket.sessionPresent)&&e.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){_("_resubscribe: protocolVersion 5");for(let t=0;t<e.length;t++){const n={};n[e[t]]=this._resubscribeTopics[e[t]],n.resubscribe=!0,this.subscribe(n,{properties:n[e[t]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},E.prototype._onConnect=function(e){if(this.disconnected)return void this.emit("connect",e);const t=this;this.connackPacket=e,this.messageIdProvider.clear(),this._setupPingTimer(),this.connected=!0,function n(){let r=t.outgoingStore.createStream();function i(){t._storeProcessing=!1,t._packetIdsDuringStoreProcessing={}}function o(){r.destroy(),r=null,t._flushStoreProcessingQueue(),i()}t.once("close",o),r.on("error",(function(e){i(),t._flushStoreProcessingQueue(),t.removeListener("close",o),t.emit("error",e)})),r.on("end",(function(){let r=!0;for(const e in t._packetIdsDuringStoreProcessing)if(!t._packetIdsDuringStoreProcessing[e]){r=!1;break}r?(i(),t.removeListener("close",o),t._invokeAllStoreProcessingQueue(),t.emit("connect",e)):n()})),function e(){if(!r)return;t._storeProcessing=!0;const n=r.read(1);let i;n?t._packetIdsDuringStoreProcessing[n.messageId]?e():t.disconnecting||t.reconnectTimer?r.destroy&&r.destroy():(i=t.outgoing[n.messageId]?t.outgoing[n.messageId].cb:null,t.outgoing[n.messageId]={volatile:!1,cb:function(t,n){i&&i(t,n),e()}},t._packetIdsDuringStoreProcessing[n.messageId]=!0,t.messageIdProvider.register(n.messageId)?t._sendPacket(n):_("messageId: %d has already used.",n.messageId)):r.once("readable",e)}()}()},E.prototype._invokeStoreProcessingQueue=function(){if(this._storeProcessingQueue.length>0){const e=this._storeProcessingQueue[0];if(e&&e.invoke())return this._storeProcessingQueue.shift(),!0}return!1},E.prototype._invokeAllStoreProcessingQueue=function(){for(;this._invokeStoreProcessingQueue(););},E.prototype._flushStoreProcessingQueue=function(){for(const e of this._storeProcessingQueue)e.cbStorePut&&e.cbStorePut(new Error("Connection closed")),e.callback&&e.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)},e.exports=E},6191:(e,t,n)=>{"use strict";const{Buffer:r}=n(4300),i=n(3248).Transform,o=n(9159);let s,a,c,u=!1;e.exports=function(e,t){if(t.hostname=t.hostname||t.host,!t.hostname)throw new Error("Could not determine host. Specify host manually.");const n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(t);const l=function(e,t){const n="alis"===e.protocol?"wss":"ws";let r=n+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(r=n+"://"+e.hostname+":"+e.port+e.path),"function"==typeof e.transformWsUrl&&(r=e.transformWsUrl(r,e,t)),r}(t,e);return s=t.my,s.connectSocket({url:l,protocols:n}),a=function(){const e=new i;return e._write=function(e,t,n){s.sendSocketMessage({data:e.buffer,success:function(){n()},fail:function(){n(new Error)}})},e._flush=function(e){s.closeSocket({success:function(){e()}})},e}(),c=o.obj(),u||(u=!0,s.onSocketOpen((function(){c.setReadable(a),c.setWritable(a),c.emit("connect")})),s.onSocketMessage((function(e){if("string"==typeof e.data){const t=r.from(e.data,"base64");a.push(t)}else{const t=new FileReader;t.addEventListener("load",(function(){let e=t.result;e=e instanceof ArrayBuffer?r.from(e):r.from(e,"utf8"),a.push(e)})),t.readAsArrayBuffer(e.data)}})),s.onSocketClose((function(){c.end(),c.destroy()})),s.onSocketError((function(e){c.destroy(e)}))),c}},1616:(e,t,n)=>{"use strict";const r=n(1455),i=n(7431),o=n(7310),s=n(5170),a=n(6974)("mqttjs"),c={};function u(e,t){if(a("connecting to an MQTT broker..."),"object"!=typeof e||t||(t=e,e=null),t=t||{},e){const n=o.parse(e,!0);if(null!=n.port&&(n.port=Number(n.port)),null===(t=s(n,t)).protocol)throw new Error("Missing protocol");t.protocol=t.protocol.replace(/:$/,"")}if(function(e){let t;e.auth&&(t=e.auth.match(/^(.+):(.+)$/),t?(e.username=t[1],e.password=t[2]):e.username=e.auth)}(t),t.query&&"string"==typeof t.query.clientId&&(t.clientId=t.query.clientId),t.cert&&t.key){if(!t.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(t.protocol))switch(t.protocol){case"mqtt":t.protocol="mqtts";break;case"ws":t.protocol="wss";break;case"wx":t.protocol="wxs";break;case"ali":t.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+t.protocol+'"!')}}if(!c[t.protocol]){const e=-1!==["mqtts","wss"].indexOf(t.protocol);t.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((function(t,n){return(!e||n%2!=0)&&"function"==typeof c[t]}))[0]}if(!1===t.clean&&!t.clientId)throw new Error("Missing clientId for unclean clients");t.protocol&&(t.defaultProtocol=t.protocol);const n=new r((function(e){return t.servers&&(e._reconnectCount&&e._reconnectCount!==t.servers.length||(e._reconnectCount=0),t.host=t.servers[e._reconnectCount].host,t.port=t.servers[e._reconnectCount].port,t.protocol=t.servers[e._reconnectCount].protocol?t.servers[e._reconnectCount].protocol:t.defaultProtocol,t.hostname=t.host,e._reconnectCount++),a("calling streambuilder for",t.protocol),c[t.protocol](e,t)}),t);return n.on("error",(function(){})),n}"undefined"!=typeof process&&"browser"!==process.title||"function"!=typeof n?(c.mqtt=n(1849),c.tcp=n(1849),c.ssl=n(5473),c.tls=n(5473),c.mqtts=n(5473)):(c.wx=n(8098),c.wxs=n(8098),c.ali=n(6191),c.alis=n(6191)),c.ws=n(6908),c.wss=n(6908),e.exports=u,e.exports.connect=u,e.exports.MqttClient=r,e.exports.Store=i},1849:(e,t,n)=>{"use strict";const r=n(1808),i=n(6974)("mqttjs:tcp");e.exports=function(e,t){t.port=t.port||1883,t.hostname=t.hostname||t.host||"localhost";const n=t.port,o=t.hostname;return i("port %d and host %s",n,o),r.createConnection(n,o)}},5473:(e,t,n)=>{"use strict";const r=n(4404),i=n(1808),o=n(6974)("mqttjs:tls");e.exports=function(e,t){t.port=t.port||8883,t.host=t.hostname||t.host||"localhost",0===i.isIP(t.host)&&(t.servername=t.host),t.rejectUnauthorized=!1!==t.rejectUnauthorized,delete t.path,o("port %d host %s rejectUnauthorized %b",t.port,t.host,t.rejectUnauthorized);const n=r.connect(t);function s(r){t.rejectUnauthorized&&e.emit("error",r),n.end()}return n.on("secureConnect",(function(){t.rejectUnauthorized&&!n.authorized?n.emit("error",new Error("TLS not authorized")):n.removeListener("error",s)})),n.on("error",s),n}},6908:(e,t,n)=>{"use strict";const{Buffer:r}=n(4300),i=n(5251),o=n(6974)("mqttjs:ws"),s=n(9159),a=n(3248).Transform,c=["rejectUnauthorized","ca","cert","key","pfx","passphrase"],u="undefined"!=typeof process&&"browser"===process.title||"function"==typeof n;function l(e,t){let n=e.protocol+"://"+e.hostname+":"+e.port+e.path;return"function"==typeof e.transformWsUrl&&(n=e.transformWsUrl(n,e,t)),n}function f(e){const t=e;return e.hostname||(t.hostname="localhost"),e.port||("wss"===e.protocol?t.port=443:t.port=80),e.path||(t.path="/"),e.wsOptions||(t.wsOptions={}),u||"wss"!==e.protocol||c.forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&!Object.prototype.hasOwnProperty.call(e.wsOptions,n)&&(t.wsOptions[n]=e[n])})),t}e.exports=u?function(e,t){let n;o("browserStreamBuilder");const i=function(e){const t=f(e);if(t.hostname||(t.hostname=t.host),!t.hostname){if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");const e=new URL(document.URL);t.hostname=e.hostname,t.port||(t.port=e.port)}return void 0===t.objectMode&&(t.objectMode=!(!0===t.binary||void 0===t.binary)),t}(t).browserBufferSize||524288,c=t.browserBufferTimeout||1e3,u=!t.objectMode,h=function(e,t){const n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt",r=l(t,e),i=new WebSocket(r,[n]);return i.binaryType="arraybuffer",i}(e,t),p=function(e,t,n){const o=new a({objectModeMode:e.objectMode});return o._write=function e(t,n,o){h.bufferedAmount>i&&setTimeout(e,c,t,n,o),u&&"string"==typeof t&&(t=r.from(t,"utf8"));try{h.send(t)}catch(e){return o(e)}o()},o._flush=function(e){h.close(),e()},o}(t);t.objectMode||(p._writev=y),p.on("close",(()=>{h.close()}));const d=void 0!==h.addEventListener;function _(){n.setReadable(p),n.setWritable(p),n.emit("connect")}function g(){n.end(),n.destroy()}function m(e){n.destroy(e)}function v(e){let t=e.data;t=t instanceof ArrayBuffer?r.from(t):r.from(t,"utf8"),p.push(t)}function y(e,t){const n=new Array(e.length);for(let t=0;t<e.length;t++)"string"==typeof e[t].chunk?n[t]=r.from(e[t],"utf8"):n[t]=e[t].chunk;this._write(r.concat(n),"binary",t)}return h.readyState===h.OPEN?n=p:(n=n=s(void 0,void 0,t),t.objectMode||(n._writev=y),d?h.addEventListener("open",_):h.onopen=_),n.socket=h,d?(h.addEventListener("close",g),h.addEventListener("error",m),h.addEventListener("message",v)):(h.onclose=g,h.onerror=m,h.onmessage=v),n}:function(e,t){o("streamBuilder");const n=f(t),r=l(n,e),s=function(e,t,n){o("createWebSocket"),o("protocol: "+n.protocolId+" "+n.protocolVersion);const r="MQIsdp"===n.protocolId&&3===n.protocolVersion?"mqttv3.1":"mqtt";return o("creating new Websocket for url: "+t+" and protocol: "+r),new i(t,[r],n.wsOptions)}(0,r,n),a=i.createWebSocketStream(s,n.wsOptions);return a.url=r,s.on("close",(()=>{a.destroy()})),a}},8098:(e,t,n)=>{"use strict";const{Buffer:r}=n(4300),i=n(3248).Transform,o=n(9159);let s,a,c;e.exports=function(e,t){if(t.hostname=t.hostname||t.host,!t.hostname)throw new Error("Could not determine host. Specify host manually.");const n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(t);const u=function(e,t){const n="wxs"===e.protocol?"wss":"ws";let r=n+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(r=n+"://"+e.hostname+":"+e.port+e.path),"function"==typeof e.transformWsUrl&&(r=e.transformWsUrl(r,e,t)),r}(t,e);s=wx.connectSocket({url:u,protocols:[n]}),a=function(){const e=new i;return e._write=function(e,t,n){s.send({data:e.buffer,success:function(){n()},fail:function(e){n(new Error(e))}})},e._flush=function(e){s.close({success:function(){e()}})},e}(),c=o.obj(),c._destroy=function(e,t){s.close({success:function(){t&&t(e)}})};const l=c.destroy;return c.destroy=function(){c.destroy=l;const e=this;setTimeout((function(){s.close({fail:function(){e._destroy(new Error)}})}),0)}.bind(c),s.onOpen((function(){c.setReadable(a),c.setWritable(a),c.emit("connect")})),s.onMessage((function(e){let t=e.data;t=t instanceof ArrayBuffer?r.from(t):r.from(t,"utf8"),a.push(t)})),s.onClose((function(){c.end(),c.destroy()})),s.onError((function(e){c.destroy(new Error(e.errMsg))})),c}},6156:e=>{"use strict";function t(){if(!(this instanceof t))return new t;this.nextId=Math.max(1,Math.floor(65535*Math.random()))}t.prototype.allocate=function(){const e=this.nextId++;return 65536===this.nextId&&(this.nextId=1),e},t.prototype.getLastAllocated=function(){return 1===this.nextId?65535:this.nextId-1},t.prototype.register=function(e){return!0},t.prototype.deallocate=function(e){},t.prototype.clear=function(){},e.exports=t},7431:(e,t,n)=>{"use strict";const r=n(5170),i=n(3248).Readable,o={objectMode:!0},s={clean:!0};function a(e){if(!(this instanceof a))return new a(e);this.options=e||{},this.options=r(s,e),this._inflights=new Map}a.prototype.put=function(e,t){return this._inflights.set(e.messageId,e),t&&t(),this},a.prototype.createStream=function(){const e=new i(o),t=[];let n=!1,r=0;return this._inflights.forEach((function(e,n){t.push(e)})),e._read=function(){!n&&r<t.length?this.push(t[r++]):this.push(null)},e.destroy=function(){if(n)return;const e=this;n=!0,setTimeout((function(){e.emit("close")}),0)},e},a.prototype.del=function(e,t){return(e=this._inflights.get(e.messageId))?(this._inflights.delete(e.messageId),t(null,e)):t&&t(new Error("missing packet")),this},a.prototype.get=function(e,t){return(e=this._inflights.get(e.messageId))?t(null,e):t&&t(new Error("missing packet")),this},a.prototype.close=function(e){this.options.clean&&(this._inflights=null),e&&e()},e.exports=a},6565:e=>{"use strict";function t(e){if(!(this instanceof t))return new t(e);this.aliasToTopic={},this.max=e}t.prototype.put=function(e,t){return!(0===t||t>this.max||(this.aliasToTopic[t]=e,this.length=Object.keys(this.aliasToTopic).length,0))},t.prototype.getTopicByAlias=function(e){return this.aliasToTopic[e]},t.prototype.clear=function(){this.aliasToTopic={}},e.exports=t},3744:(e,t,n)=>{"use strict";const r=n(5680),i=n(6323).NumberAllocator;function o(e){if(!(this instanceof o))return new o(e);e>0&&(this.aliasToTopic=new r({max:e}),this.topicToAlias={},this.numberAllocator=new i(1,e),this.max=e,this.length=0)}o.prototype.put=function(e,t){if(0===t||t>this.max)return!1;const n=this.aliasToTopic.get(t);return n&&delete this.topicToAlias[n],this.aliasToTopic.set(t,e),this.topicToAlias[e]=t,this.numberAllocator.use(t),this.length=this.aliasToTopic.length,!0},o.prototype.getTopicByAlias=function(e){return this.aliasToTopic.get(e)},o.prototype.getAliasByTopic=function(e){const t=this.topicToAlias[e];return void 0!==t&&this.aliasToTopic.get(t),t},o.prototype.clear=function(){this.aliasToTopic.reset(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0},o.prototype.getLruAlias=function(){return this.numberAllocator.firstVacant()||this.aliasToTopic.keys()[this.aliasToTopic.length-1]},e.exports=o},9394:(e,t,n)=>{"use strict";const r=n(6323).NumberAllocator;function i(){if(!(this instanceof i))return new i;this.numberAllocator=new r(1,65535)}i.prototype.allocate=function(){return this.lastId=this.numberAllocator.alloc(),this.lastId},i.prototype.getLastAllocated=function(){return this.lastId},i.prototype.register=function(e){return this.numberAllocator.use(e)},i.prototype.deallocate=function(e){this.numberAllocator.free(e)},i.prototype.clear=function(){this.numberAllocator.clear()},e.exports=i},4028:e=>{"use strict";function t(e){const t=e.split("/");for(let e=0;e<t.length;e++)if("+"!==t[e]){if("#"===t[e])return e===t.length-1;if(-1!==t[e].indexOf("+")||-1!==t[e].indexOf("#"))return!1}return!0}e.exports={validateTopics:function(e){if(0===e.length)return"empty_topic_list";for(let n=0;n<e.length;n++)if(!t(e[n]))return e[n];return null}}},6077:(e,t,n)=>{const r=n(1455),i=n(1616),o=n(7431),s=n(6156),a=n(9394);e.exports.connect=i,e.exports.MqttClient=r,e.exports.Client=r,e.exports.Store=o,e.exports.DefaultMessageIdProvider=s,e.exports.UniqueMessageIdProvider=a},5251:(e,t,n)=>{"use strict";const r=n(5144);r.createWebSocketStream=n(3543),r.Server=n(3056),r.Receiver=n(5674),r.Sender=n(6063),e.exports=r},2814:(e,t,n)=>{"use strict";const{EMPTY_BUFFER:r}=n(5010);function i(e,t){if(0===e.length)return r;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let i=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,i),i+=r.length}return i<t?n.slice(0,i):n}function o(e,t,n,r,i){for(let o=0;o<i;o++)n[r+o]=e[o]^t[3&o]}function s(e,t){const n=e.length;for(let r=0;r<n;r++)e[r]^=t[3&r]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){if(c.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),c.readOnly=!1),t}try{const t=n(4987),r=t.BufferUtil||t;e.exports={concat:i,mask(e,t,n,i,s){s<48?o(e,t,n,i,s):r.mask(e,t,n,i,s)},toArrayBuffer:a,toBuffer:c,unmask(e,t){e.length<32?s(e,t):r.unmask(e,t)}}}catch(t){e.exports={concat:i,mask:o,toArrayBuffer:a,toBuffer:c,unmask:s}}},5010:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},9303:e=>{"use strict";class t{constructor(e,t){this.target=t,this.type=e}}class n extends t{constructor(e,t){super("message",t),this.data=e}}class r extends t{constructor(e,t,n){super("close",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class i extends t{constructor(e){super("open",e)}}class o extends t{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const s={addEventListener(e,t,s){if("function"!=typeof t)return;function a(e){t.call(this,new n(e,this))}function c(e,n){t.call(this,new r(e,n,this))}function u(e){t.call(this,new o(e,this))}function l(){t.call(this,new i(this))}const f=s&&s.once?"once":"on";"message"===e?(a._listener=t,this[f](e,a)):"close"===e?(c._listener=t,this[f](e,c)):"error"===e?(u._listener=t,this[f](e,u)):"open"===e?(l._listener=t,this[f](e,l)):this[f](e,t)},removeEventListener(e,t){const n=this.listeners(e);for(let r=0;r<n.length;r++)n[r]!==t&&n[r]._listener!==t||this.removeListener(e,n[r])}};e.exports=s},597:e=>{"use strict";const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function n(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}e.exports={format:function(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const r=Object.create(null);if(void 0===e||""===e)return r;let i,o,s=Object.create(null),a=!1,c=!1,u=!1,l=-1,f=-1,h=0;for(;h<e.length;h++){const p=e.charCodeAt(h);if(void 0===i)if(-1===f&&1===t[p])-1===l&&(l=h);else if(32===p||9===p)-1===f&&-1!==l&&(f=h);else{if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h);const t=e.slice(l,f);44===p?(n(r,t,s),s=Object.create(null)):i=t,l=f=-1}}else if(void 0===o)if(-1===f&&1===t[p])-1===l&&(l=h);else if(32===p||9===p)-1===f&&-1!==l&&(f=h);else if(59===p||44===p){if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h),n(s,e.slice(l,f),!0),44===p&&(n(r,i,s),s=Object.create(null),i=void 0),l=f=-1}else{if(61!==p||-1===l||-1!==f)throw new SyntaxError(`Unexpected character at index ${h}`);o=e.slice(l,h),l=f=-1}else if(c){if(1!==t[p])throw new SyntaxError(`Unexpected character at index ${h}`);-1===l?l=h:a||(a=!0),c=!1}else if(u)if(1===t[p])-1===l&&(l=h);else if(34===p&&-1!==l)u=!1,f=h;else{if(92!==p)throw new SyntaxError(`Unexpected character at index ${h}`);c=!0}else if(34===p&&61===e.charCodeAt(h-1))u=!0;else if(-1===f&&1===t[p])-1===l&&(l=h);else if(-1===l||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h);let t=e.slice(l,f);a&&(t=t.replace(/\\/g,""),a=!1),n(s,o,t),44===p&&(n(r,i,s),s=Object.create(null),i=void 0),o=void 0,l=f=-1}}else-1===f&&(f=h)}if(-1===l||u)throw new SyntaxError("Unexpected end of input");-1===f&&(f=h);const p=e.slice(l,f);return void 0===i?n(r,p,s):(void 0===o?n(s,p,!0):n(s,o,a?p.replace(/\\/g,""):p),n(r,i,s)),r}}},9533:e=>{"use strict";const t=Symbol("kDone"),n=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},4363:(e,t,n)=>{"use strict";const r=n(9796),i=n(2814),o=n(9533),{kStatusCode:s,NOOP:a}=n(5010),c=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),l=Symbol("total-length"),f=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let d;function _(e){this[h].push(e),this[l]+=e.length}function g(e){this[l]+=e.length,this[u]._maxPayload<1||this[l]<=this[u]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][s]=1009,this.removeListener("data",g),this.reset())}function m(e){this[u]._inflate=null,e[s]=1007,this[f](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!d){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;d=new o(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[f];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){d.add((r=>{this._decompress(e,t,((e,t)=>{r(),n(e,t)}))}))}compress(e,t,n){d.add((r=>{this._compress(e,t,((e,t)=>{r(),n(e,t)}))}))}_decompress(e,t,n){const o=this._isServer?"client":"server";if(!this._inflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=r.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[l]=0,this._inflate[h]=[],this._inflate.on("error",m),this._inflate.on("data",g)}this._inflate[f]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void n(e);const r=i.concat(this._inflate[h],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[h]=[],t&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),n(null,r)}))}_compress(e,t,n){const o=this._isServer?"server":"client";if(!this._deflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=r.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[h]=[],this._deflate.on("error",a),this._deflate.on("data",_)}this._deflate[f]=n,this._deflate.write(e),this._deflate.flush(r.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=i.concat(this._deflate[h],this._deflate[l]);t&&(e=e.slice(0,e.length-4)),this._deflate[f]=null,this._deflate[l]=0,this._deflate[h]=[],t&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}}},5674:(e,t,n)=>{"use strict";const{Writable:r}=n(2781),i=n(4363),{BINARY_TYPES:o,EMPTY_BUFFER:s,kStatusCode:a,kWebSocket:c}=n(5010),{concat:u,toArrayBuffer:l,unmask:f}=n(2814),{isValidStatusCode:h,isValidUTF8:p}=n(8155);function d(e,t,n,r,i){const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,d),o.code=i,o[a]=r,o}e.exports=class extends r{constructor(e,t,n,r){super(),this._binaryType=e||o[0],this[c]=void 0,this._extensions=t||{},this._isServer=!!n,this._maxPayload=0|r,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],r=t.length-e;e>=n.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),r),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,d(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[i.extensionName])return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,d(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,d(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,d(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,d(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,d(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,d(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,d(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,d(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,d(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&f(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(d(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(n)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(t,e):"arraybuffer"===this._binaryType?l(u(t,e)):t,this.emit("message",n)}else{const n=u(t,e);if(!p(n))return this._loop=!1,d(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n.toString())}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return d(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const t=e.readUInt16BE(0);if(!h(t))return d(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const n=e.slice(2);if(!p(n))return d(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,n.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},6063:(e,t,n)=>{"use strict";n(1808),n(4404);const{randomFillSync:r}=n(6113),i=n(4363),{EMPTY_BUFFER:o}=n(5010),{isValidStatusCode:s}=n(8155),{mask:a,toBuffer:c}=n(2814),u=Buffer.alloc(4);class l{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=t.mask&&t.readOnly;let i=t.mask?6:2,o=e.length;e.length>=65536?(i+=8,o=127):e.length>125&&(i+=2,o=126);const s=Buffer.allocUnsafe(n?e.length+i:i);return s[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(s[0]|=64),s[1]=o,126===o?s.writeUInt16BE(e.length,2):127===o&&(s.writeUInt32BE(0,2),s.writeUInt32BE(e.length,6)),t.mask?(r(u,0,4),s[1]|=128,s[i-4]=u[0],s[i-3]=u[1],s[i-2]=u[2],s[i-1]=u[3],n?(a(e,u,s,i,e.length),[s]):(a(e,u,e,0,e.length),[s,e])):[s,e]}close(e,t,n,r){let i;if(void 0===e)i=o;else{if("number"!=typeof e||!s(e))throw new TypeError("First argument must be a valid error code number");if(void 0===t||""===t)i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0);else{const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+n),i.writeUInt16BE(e,0),i.write(t,2)}}this._deflating?this.enqueue([this.doClose,i,n,r]):this.doClose(i,n,r)}doClose(e,t,n){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t,n){const r=c(e);if(r.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,r,t,c.readOnly,n]):this.doPing(r,t,c.readOnly,n)}doPing(e,t,n,r){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}),r)}pong(e,t,n){const r=c(e);if(r.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,r,t,c.readOnly,n]):this.doPong(r,t,c.readOnly,n)}doPong(e,t,n,r){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}),r)}send(e,t,n){const r=c(e),o=this._extensions[i.extensionName];let s=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&o&&(a=r.length>=o._threshold),this._compress=a):(a=!1,s=0),t.fin&&(this._firstFragment=!0),o){const e={fin:t.fin,rsv1:a,opcode:s,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,r,this._compress,e,n]):this.dispatch(r,this._compress,e,n)}else this.sendFrame(l.frame(r,{fin:t.fin,rsv1:!1,opcode:s,mask:t.mask,readOnly:c.readOnly}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(l.frame(e,n),r);const o=this._extensions[i.extensionName];this._bufferedBytes+=e.length,this._deflating=!0,o.compress(e,n.fin,((t,i)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof r&&r(e);for(let t=0;t<this._queue.length;t++){const n=this._queue[t][4];"function"==typeof n&&n(e)}}else this._bufferedBytes-=e.length,this._deflating=!1,n.readOnly=!1,this.sendFrame(l.frame(i,n),r),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=l},3543:(e,t,n)=>{"use strict";const{Duplex:r}=n(2781);function i(e){e.emit("close")}function o(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let n=!0,a=!0;function c(){n&&e._socket.resume()}e.readyState===e.CONNECTING?e.once("open",(function(){e._receiver.removeAllListeners("drain"),e._receiver.on("drain",c)})):(e._receiver.removeAllListeners("drain"),e._receiver.on("drain",c));const u=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t){u.push(t)||(n=!1,e._socket.pause())})),e.once("error",(function(e){u.destroyed||(a=!1,u.destroy(e))})),e.once("close",(function(){u.destroyed||u.push(null)})),u._destroy=function(t,n){if(e.readyState===e.CLOSED)return n(t),void process.nextTick(i,u);let r=!1;e.once("error",(function(e){r=!0,n(e)})),e.once("close",(function(){r||n(t),process.nextTick(i,u)})),a&&e.terminate()},u._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),u._readableState.endEmitted&&u.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){u._final(t)}))},u._read=function(){e.readyState!==e.OPEN&&e.readyState!==e.CLOSING||n||(n=!0,e._receiver._writableState.needDrain||e._socket.resume())},u._write=function(t,n,r){e.readyState!==e.CONNECTING?e.send(t,r):e.once("open",(function(){u._write(t,n,r)}))},u.on("end",o),u.on("error",s),u}},8155:(e,t,n)=>{"use strict";function r(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999}function i(e){const t=e.length;let n=0;for(;n<t;)if(0==(128&e[n]))n++;else if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}return!0}try{let t=n(6465);"object"==typeof t&&(t=t.Validation.isValidUTF8),e.exports={isValidStatusCode:r,isValidUTF8:e=>e.length<150?i(e):t(e)}}catch(t){e.exports={isValidStatusCode:r,isValidUTF8:i}}},3056:(e,t,n)=>{"use strict";const r=n(2361),i=n(3685),{createHash:o}=(n(5687),n(1808),n(4404),n(6113)),s=n(4363),a=n(5144),{format:c,parse:u}=n(597),{GUID:l,kWebSocket:f}=n(5010),h=/^[+/0-9A-Za-z]{22}==$/;function p(e){e._state=2,e.emit("close")}function d(){this.destroy()}function _(e,t,n,r){e.writable&&(n=n||i.STATUS_CODES[t],r={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...r},e.write(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r\n`+Object.keys(r).map((e=>`${e}: ${r[e]}`)).join("\r\n")+"\r\n\r\n"+n)),e.removeListener("error",d),e.destroy()}function g(e){return e.trim()}e.exports=class extends r{constructor(e,t){if(super(),null==(e={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer(((e,t)=>{const n=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,r)=>{this.handleUpgrade(t,n,r,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),2===this._state)return void process.nextTick(p,this);if(1===this._state)return;if(this._state=1,this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close(p.bind(void 0,this)):process.nextTick(p,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,r){t.on("error",d);const i=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),o=+e.headers["sec-websocket-version"],a={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!i||!h.test(i)||8!==o&&13!==o||!this.shouldHandle(e))return _(t,400);if(this.options.perMessageDeflate){const n=new s(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=u(e.headers["sec-websocket-extensions"]);t[s.extensionName]&&(n.accept(t[s.extensionName]),a[s.extensionName]=n)}catch(e){return _(t,400)}}if(this.options.verifyClient){const s={origin:e.headers[8===o?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,((o,s,c,u)=>{if(!o)return _(t,s||401,c,u);this.completeUpgrade(i,a,e,t,n,r)}));if(!this.options.verifyClient(s))return _(t,401)}this.completeUpgrade(i,a,e,t,n,r)}completeUpgrade(e,t,n,r,i,u){if(!r.readable||!r.writable)return r.destroy();if(r[f])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return _(r,503);const h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o("sha1").update(e+l).digest("base64")}`],p=new a(null);let m=n.headers["sec-websocket-protocol"];if(m&&(m=m.split(",").map(g),m=this.options.handleProtocols?this.options.handleProtocols(m,n):m[0],m&&(h.push(`Sec-WebSocket-Protocol: ${m}`),p._protocol=m)),t[s.extensionName]){const e=t[s.extensionName].params,n=c({[s.extensionName]:[e]});h.push(`Sec-WebSocket-Extensions: ${n}`),p._extensions=t}this.emit("headers",h,n),r.write(h.concat("\r\n").join("\r\n")),r.removeListener("error",d),p.setSocket(r,i,this.options.maxPayload),this.clients&&(this.clients.add(p),p.on("close",(()=>this.clients.delete(p)))),u(p,n)}}},5144:(e,t,n)=>{"use strict";const r=n(2361),i=n(5687),o=n(3685),s=n(1808),a=n(4404),{randomBytes:c,createHash:u}=n(6113),{Readable:l}=n(2781),{URL:f}=n(7310),h=n(4363),p=n(5674),d=n(6063),{BINARY_TYPES:_,EMPTY_BUFFER:g,GUID:m,kStatusCode:v,kWebSocket:y,NOOP:b}=n(5010),{addEventListener:w,removeEventListener:S}=n(9303),{format:k,parse:x}=n(597),{toBuffer:E}=n(2814),T=["CONNECTING","OPEN","CLOSING","CLOSED"],O=[8,13];class I extends r{constructor(e,t,n){super(),this._binaryType=_[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._extensions={},this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(n=t,t=void 0),P(this,e,t,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){_.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get onclose(){}set onclose(e){}get onerror(){}set onerror(e){}get onopen(){}set onopen(e){}get onmessage(){}set onmessage(e){}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const r=new p(this.binaryType,this._extensions,this._isServer,n);this._sender=new d(e,this._extensions),this._receiver=r,this._socket=e,r[y]=this,e[y]=this,r.on("conclude",R),r.on("drain",j),r.on("error",B),r.on("message",D),r.on("ping",W),r.on("pong",q),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",V),e.on("data",z),e.on("end",$),e.on("error",G),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=I.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){const e="WebSocket was closed before the connection was established";return L(this,this._req,e)}this.readyState!==I.CLOSING?(this._readyState=I.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}}ping(e,t,n){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===I.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||g,t,n)):U(this,e,n)}pong(e,t,n){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===I.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||g,t,n)):U(this,e,n)}send(e,t,n){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==I.OPEN)return void U(this,e,n);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(r.compress=!1),this._sender.send(e||g,r,n)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){const e="WebSocket was closed before the connection was established";return L(this,this._req,e)}this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function P(e,t,n,r){const s={protocolVersion:O[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!O.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${O.join(", ")})`);let a;t instanceof f?(a=t,e._url=t.href):(a=new f(t),e._url=t);const l="ws+unix:"===a.protocol;if(!(a.host||l&&a.pathname)){const t=new Error(`Invalid URL: ${e.url}`);if(0===e._redirects)throw t;return void C(e,t)}const p="wss:"===a.protocol||"https:"===a.protocol,d=p?443:80,_=c(16).toString("base64"),g=p?i.get:o.get;let v;if(s.createConnection=p?N:A,s.defaultPort=s.defaultPort||d,s.port=a.port||d,s.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,s.headers={"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket",...s.headers},s.path=a.pathname+a.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(v=new h(!0!==s.perMessageDeflate?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=k({[h.extensionName]:v.offer()})),n&&(s.headers["Sec-WebSocket-Protocol"]=n),s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(a.username||a.password)&&(s.auth=`${a.username}:${a.password}`),l){const e=s.path.split(":");s.socketPath=e[0],s.path=e[1]}if(s.followRedirects){if(0===e._redirects){e._originalUnixSocket=l,e._originalSecure=p,e._originalHostOrSocketPath=l?s.socketPath:a.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,n]of Object.entries(t))r.headers[e.toLowerCase()]=n}else{const t=l?!!e._originalUnixSocket&&s.socketPath===e._originalHostOrSocketPath:!e._originalUnixSocket&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!p)&&(delete s.headers.authorization,delete s.headers.cookie,t||delete s.headers.host,s.auth=void 0)}s.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64"))}let y=e._req=g(s);s.timeout&&y.on("timeout",(()=>{L(e,y,"Opening handshake has timed out")})),y.on("error",(t=>{null===y||y.aborted||(y=e._req=null,C(e,t))})),y.on("response",(i=>{const o=i.headers.location,a=i.statusCode;if(o&&s.followRedirects&&a>=300&&a<400){if(++e._redirects>s.maxRedirects)return void L(e,y,"Maximum redirects exceeded");let i;y.abort();try{i=new f(o,t)}catch(t){return void C(e,t)}P(e,i,n,r)}else e.emit("unexpected-response",y,i)||L(e,y,`Unexpected server response: ${i.statusCode}`)})),y.on("upgrade",((t,r,i)=>{if(e.emit("upgrade",t),e.readyState!==I.CONNECTING)return;if(y=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void L(e,r,"Invalid Upgrade header");const o=u("sha1").update(_+m).digest("base64");if(t.headers["sec-websocket-accept"]!==o)return void L(e,r,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"],c=(n||"").split(/, */);let l;if(!n&&a?l="Server sent a subprotocol but none was requested":n&&!a?l="Server sent no subprotocol":a&&!c.includes(a)&&(l="Server sent an invalid subprotocol"),l)return void L(e,r,l);a&&(e._protocol=a);const f=t.headers["sec-websocket-extensions"];if(void 0!==f){if(!v)return void L(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=x(f)}catch(t){return void L(e,r,"Invalid Sec-WebSocket-Extensions header")}const n=Object.keys(t);if(n.length){if(1!==n.length||n[0]!==h.extensionName)return void L(e,r,"Server indicated an extension that was not requested");try{v.accept(t[h.extensionName])}catch(t){return void L(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[h.extensionName]=v}}e.setSocket(r,i,s.maxPayload)}))}function C(e,t){e._readyState=I.CLOSING,e.emit("error",t),e.emitClose()}function A(e){return e.path=e.socketPath,s.connect(e)}function N(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=s.isIP(e.host)?"":e.host),a.connect(e)}function L(e,t,n){e._readyState=I.CLOSING;const r=new Error(n);Error.captureStackTrace(r,L),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",e.emitClose.bind(e)),e.emit("error",r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function U(e,t,n){if(t){const n=E(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}n&&n(new Error(`WebSocket is not open: readyState ${e.readyState} (${T[e.readyState]})`))}function R(e,t){const n=this[y];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[y]&&(n._socket.removeListener("data",z),process.nextTick(F,n._socket),1005===e?n.close():n.close(e,t))}function j(){this[y]._socket.resume()}function B(e){const t=this[y];void 0!==t._socket[y]&&(t._socket.removeListener("data",z),process.nextTick(F,t._socket),t.close(e[v])),t.emit("error",e)}function M(){this[y].emitClose()}function D(e){this[y].emit("message",e)}function W(e){const t=this[y];t.pong(e,!t._isServer,b),t.emit("ping",e)}function q(e){this[y].emit("pong",e)}function F(e){e.resume()}function V(){const e=this[y];let t;this.removeListener("close",V),this.removeListener("data",z),this.removeListener("end",$),e._readyState=I.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[y]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",M),e._receiver.on("finish",M))}function z(e){this[y]._receiver.write(e)||this.pause()}function $(){const e=this[y];e._readyState=I.CLOSING,e._receiver.end(),this.end()}function G(){const e=this[y];this.removeListener("error",G),this.on("error",b),e&&(e._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:T.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:T.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:T.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:T.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:T.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:T.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:T.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:T.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","protocol","readyState","url"].forEach((e=>{Object.defineProperty(I.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(I.prototype,`on${e}`,{enumerable:!0,get(){const t=this.listeners(e);for(let e=0;e<t.length;e++)if(t[e]._listener)return t[e]._listener},set(t){const n=this.listeners(e);for(let t=0;t<n.length;t++)n[t]._listener&&this.removeListener(e,n[t]);this.addEventListener(e,t)}})})),I.prototype.addEventListener=w,I.prototype.removeEventListener=S,e.exports=I},977:(e,t,n)=>{"use strict";const{EMPTY_BUFFER:r}=n(1872),i=Buffer[Symbol.species];function o(e,t,n,r,i){for(let o=0;o<i;o++)n[r+o]=e[o]^t[3&o]}function s(e,t){for(let n=0;n<e.length;n++)e[n]^=t[3&n]}if(e.exports={concat:function(e,t){if(0===e.length)return r;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let o=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,o),o+=r.length}return o<t?new i(n.buffer,n.byteOffset,o):n},mask:o,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let n;return t instanceof ArrayBuffer?n=new i(t):ArrayBuffer.isView(t)?n=new i(t.buffer,t.byteOffset,t.byteLength):(n=Buffer.from(t),e.readOnly=!1),n},unmask:s},!process.env.WS_NO_BUFFER_UTIL)try{const t=n(4987);e.exports.mask=function(e,n,r,i,s){s<48?o(e,n,r,i,s):t.mask(e,n,r,i,s)},e.exports.unmask=function(e,n){e.length<32?s(e,n):t.unmask(e,n)}}catch(e){}},1872:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},62:(e,t,n)=>{"use strict";const{kForOnEventAttribute:r,kListener:i}=n(1872),o=Symbol("kCode"),s=Symbol("kData"),a=Symbol("kError"),c=Symbol("kMessage"),u=Symbol("kReason"),l=Symbol("kTarget"),f=Symbol("kType"),h=Symbol("kWasClean");class p{constructor(e){this[l]=null,this[f]=e}get target(){return this[l]}get type(){return this[f]}}Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});class d extends p{constructor(e,t={}){super(e),this[o]=void 0===t.code?0:t.code,this[u]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[o]}get reason(){return this[u]}get wasClean(){return this[h]}}Object.defineProperty(d.prototype,"code",{enumerable:!0}),Object.defineProperty(d.prototype,"reason",{enumerable:!0}),Object.defineProperty(d.prototype,"wasClean",{enumerable:!0});class _ extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[c]}}Object.defineProperty(_.prototype,"error",{enumerable:!0}),Object.defineProperty(_.prototype,"message",{enumerable:!0});class g extends p{constructor(e,t={}){super(e),this[s]=void 0===t.data?null:t.data}get data(){return this[s]}}Object.defineProperty(g.prototype,"data",{enumerable:!0});const m={addEventListener(e,t,n={}){for(const o of this.listeners(e))if(!n[r]&&o[i]===t&&!o[r])return;let o;if("message"===e)o=function(e,n){const r=new g("message",{data:n?e:e.toString()});r[l]=this,v(t,this,r)};else if("close"===e)o=function(e,n){const r=new d("close",{code:e,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[l]=this,v(t,this,r)};else if("error"===e)o=function(e){const n=new _("error",{error:e,message:e.message});n[l]=this,v(t,this,n)};else{if("open"!==e)return;o=function(){const e=new p("open");e[l]=this,v(t,this,e)}}o[r]=!!n[r],o[i]=t,n.once?this.once(e,o):this.on(e,o)},removeEventListener(e,t){for(const n of this.listeners(e))if(n[i]===t&&!n[r]){this.removeListener(e,n);break}}};function v(e,t,n){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,n):e.call(t,n)}e.exports={CloseEvent:d,ErrorEvent:_,Event:p,EventTarget:m,MessageEvent:g}},1503:(e,t,n)=>{"use strict";const{tokenChars:r}=n(6746);function i(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}e.exports={format:function(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let n,o,s=Object.create(null),a=!1,c=!1,u=!1,l=-1,f=-1,h=-1,p=0;for(;p<e.length;p++)if(f=e.charCodeAt(p),void 0===n)if(-1===h&&1===r[f])-1===l&&(l=p);else if(0===p||32!==f&&9!==f){if(59!==f&&44!==f)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);const r=e.slice(l,h);44===f?(i(t,r,s),s=Object.create(null)):n=r,l=h=-1}}else-1===h&&-1!==l&&(h=p);else if(void 0===o)if(-1===h&&1===r[f])-1===l&&(l=p);else if(32===f||9===f)-1===h&&-1!==l&&(h=p);else if(59===f||44===f){if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p),i(s,e.slice(l,h),!0),44===f&&(i(t,n,s),s=Object.create(null),n=void 0),l=h=-1}else{if(61!==f||-1===l||-1!==h)throw new SyntaxError(`Unexpected character at index ${p}`);o=e.slice(l,p),l=h=-1}else if(c){if(1!==r[f])throw new SyntaxError(`Unexpected character at index ${p}`);-1===l?l=p:a||(a=!0),c=!1}else if(u)if(1===r[f])-1===l&&(l=p);else if(34===f&&-1!==l)u=!1,h=p;else{if(92!==f)throw new SyntaxError(`Unexpected character at index ${p}`);c=!0}else if(34===f&&61===e.charCodeAt(p-1))u=!0;else if(-1===h&&1===r[f])-1===l&&(l=p);else if(-1===l||32!==f&&9!==f){if(59!==f&&44!==f)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let r=e.slice(l,h);a&&(r=r.replace(/\\/g,""),a=!1),i(s,o,r),44===f&&(i(t,n,s),s=Object.create(null),n=void 0),o=void 0,l=h=-1}}else-1===h&&(h=p);if(-1===l||u||32===f||9===f)throw new SyntaxError("Unexpected end of input");-1===h&&(h=p);const d=e.slice(l,h);return void 0===n?i(t,d,s):(void 0===o?i(s,d,!0):i(s,o,a?d.replace(/\\/g,""):d),i(t,n,s)),t}}},305:e=>{"use strict";const t=Symbol("kDone"),n=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},5196:(e,t,n)=>{"use strict";const r=n(9796),i=n(977),o=n(305),{kStatusCode:s}=n(1872),a=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),l=Symbol("total-length"),f=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let d;function _(e){this[h].push(e),this[l]+=e.length}function g(e){this[l]+=e.length,this[u]._maxPayload<1||this[l]<=this[u]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][s]=1009,this.removeListener("data",g),this.reset())}function m(e){this[u]._inflate=null,e[s]=1007,this[f](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!d){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;d=new o(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[f];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){d.add((r=>{this._decompress(e,t,((e,t)=>{r(),n(e,t)}))}))}compress(e,t,n){d.add((r=>{this._compress(e,t,((e,t)=>{r(),n(e,t)}))}))}_decompress(e,t,n){const o=this._isServer?"client":"server";if(!this._inflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=r.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[l]=0,this._inflate[h]=[],this._inflate.on("error",m),this._inflate.on("data",g)}this._inflate[f]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void n(e);const r=i.concat(this._inflate[h],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[h]=[],t&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),n(null,r)}))}_compress(e,t,n){const o=this._isServer?"server":"client";if(!this._deflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=r.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[h]=[],this._deflate.on("data",_)}this._deflate[f]=n,this._deflate.write(e),this._deflate.flush(r.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=i.concat(this._deflate[h],this._deflate[l]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[f]=null,this._deflate[l]=0,this._deflate[h]=[],t&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}}},2957:(e,t,n)=>{"use strict";const{Writable:r}=n(2781),i=n(5196),{BINARY_TYPES:o,EMPTY_BUFFER:s,kStatusCode:a,kWebSocket:c}=n(1872),{concat:u,toArrayBuffer:l,unmask:f}=n(977),{isValidStatusCode:h,isValidUTF8:p}=n(6746),d=Buffer[Symbol.species];function _(e,t,n,r,i){const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,_),o.code=i,o[a]=r,o}e.exports=class extends r{constructor(e={}){super(),this._binaryType=e.binaryType||o[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new d(t.buffer,t.byteOffset+e,t.length-e),new d(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],r=t.length-e;e>=n.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),r),this._buffers[0]=new d(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,_(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[i.extensionName])return this._loop=!1,_(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,_(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,_(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,_(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,_(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,_(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,_(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return this._loop=!1,_(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,_(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,_(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,_(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,_(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&f(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(_(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(n)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(t,e):"arraybuffer"===this._binaryType?l(u(t,e)):t,this.emit("message",n,!0)}else{const n=u(t,e);if(!this._skipUTF8Validation&&!p(n))return this._loop=!1,_(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,s),this.end();else{const t=e.readUInt16BE(0);if(!h(t))return _(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const n=new d(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(n))return _(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,n),this.end()}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},7330:(e,t,n)=>{"use strict";n(1808),n(4404);const{randomFillSync:r}=n(6113),i=n(5196),{EMPTY_BUFFER:o}=n(1872),{isValidStatusCode:s}=n(6746),{mask:a,toBuffer:c}=n(977),u=Symbol("kByteLength"),l=Buffer.alloc(4);class f{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,i,o=!1,s=2,c=!1;t.mask&&(n=t.maskBuffer||l,t.generateMask?t.generateMask(n):r(n,0,4),c=0==(n[0]|n[1]|n[2]|n[3]),s=6),"string"==typeof e?i=t.mask&&!c||void 0===t[u]?(e=Buffer.from(e)).length:t[u]:(i=e.length,o=t.mask&&t.readOnly&&!c);let f=i;i>=65536?(s+=8,f=127):i>125&&(s+=2,f=126);const h=Buffer.allocUnsafe(o?i+s:s);return h[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(h[0]|=64),h[1]=f,126===f?h.writeUInt16BE(i,2):127===f&&(h[2]=h[3]=0,h.writeUIntBE(i,4,6)),t.mask?(h[1]|=128,h[s-4]=n[0],h[s-3]=n[1],h[s-2]=n[2],h[s-1]=n[3],c?[h,e]:o?(a(e,n,h,s,i),[h]):(a(e,n,e,0,i),[h,e])):[h,e]}close(e,t,n,r){let i;if(void 0===e)i=o;else{if("number"!=typeof e||!s(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+n),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const a={[u]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,a,r]):this.sendFrame(f.frame(i,a),r)}ping(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=c(e)).length,i=c.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[u]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(f.frame(e,o),n)}pong(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=c(e)).length,i=c.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[u]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(f.frame(e,o),n)}send(e,t,n){const r=this._extensions[i.extensionName];let o,s,a=t.binary?2:1,l=t.compress;if("string"==typeof e?(o=Buffer.byteLength(e),s=!1):(o=(e=c(e)).length,s=c.readOnly),this._firstFragment?(this._firstFragment=!1,l&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=o>=r._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0),r){const r={[u]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:s,rsv1:l};this._deflating?this.enqueue([this.dispatch,e,this._compress,r,n]):this.dispatch(e,this._compress,r,n)}else this.sendFrame(f.frame(e,{[u]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:s,rsv1:!1}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(f.frame(e,n),r);const o=this._extensions[i.extensionName];this._bufferedBytes+=n[u],this._deflating=!0,o.compress(e,n.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof r&&r(e);for(let t=0;t<this._queue.length;t++){const n=this._queue[t],r=n[n.length-1];"function"==typeof r&&r(e)}}else this._bufferedBytes-=n[u],this._deflating=!1,n.readOnly=!1,this.sendFrame(f.frame(t,n),r),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][u],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][u],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=f},404:(e,t,n)=>{"use strict";const{Duplex:r}=n(2781);function i(e){e.emit("close")}function o(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let n=!0;const a=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,n){const r=!n&&a._readableState.objectMode?t.toString():t;a.push(r)||e.pause()})),e.once("error",(function(e){a.destroyed||(n=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,r){if(e.readyState===e.CLOSED)return r(t),void process.nextTick(i,a);let o=!1;e.once("error",(function(e){o=!0,r(e)})),e.once("close",(function(){o||r(t),process.nextTick(i,a)})),n&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,n,r){e.readyState!==e.CONNECTING?e.send(t,r):e.once("open",(function(){a._write(t,n,r)}))},a.on("end",o),a.on("error",s),a}},640:(e,t,n)=>{"use strict";const{tokenChars:r}=n(6746);e.exports={parse:function(e){const t=new Set;let n=-1,i=-1,o=0;for(;o<e.length;o++){const s=e.charCodeAt(o);if(-1===i&&1===r[s])-1===n&&(n=o);else if(0===o||32!==s&&9!==s){if(44!==s)throw new SyntaxError(`Unexpected character at index ${o}`);{if(-1===n)throw new SyntaxError(`Unexpected character at index ${o}`);-1===i&&(i=o);const r=e.slice(n,i);if(t.has(r))throw new SyntaxError(`The "${r}" subprotocol is duplicated`);t.add(r),n=i=-1}}else-1===i&&-1!==n&&(i=o)}if(-1===n||-1!==i)throw new SyntaxError("Unexpected end of input");const s=e.slice(n,o);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return t.add(s),t}}},6746:(e,t,n)=>{"use strict";const{isUtf8:r}=n(4300);function i(e){const t=e.length;let n=0;for(;n<t;)if(0==(128&e[n]))n++;else if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}return!0}if(e.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},r)e.exports.isValidUTF8=function(e){return e.length<24?i(e):r(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const t=n(6465);e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(e){}},9284:(e,t,n)=>{"use strict";const r=n(2361),i=n(3685),{createHash:o}=(n(5687),n(1808),n(4404),n(6113)),s=n(1503),a=n(5196),c=n(640),u=n(8762),{GUID:l,kWebSocket:f}=n(1872),h=/^[+/0-9A-Za-z]{22}==$/;function p(e){e._state=2,e.emit("close")}function d(){this.destroy()}function _(e,t,n,r){n=n||i.STATUS_CODES[t],r={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...r},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r\n`+Object.keys(r).map((e=>`${e}: ${r[e]}`)).join("\r\n")+"\r\n\r\n"+n)}function g(e,t,n,r,i){if(e.listenerCount("wsClientError")){const r=new Error(i);Error.captureStackTrace(r,g),e.emit("wsClientError",r,n,t)}else _(n,r,i)}e.exports=class extends r{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:u,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer(((e,t)=>{const n=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,r)=>{this.handleUpgrade(t,n,r,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(p,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{p(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,r){t.on("error",d);const i=e.headers["sec-websocket-key"],o=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void g(this,e,t,405,"Invalid HTTP method");if("websocket"!==e.headers.upgrade.toLowerCase())return void g(this,e,t,400,"Invalid Upgrade header");if(!i||!h.test(i))return void g(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(8!==o&&13!==o)return void g(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");if(!this.shouldHandle(e))return void _(t,400);const u=e.headers["sec-websocket-protocol"];let l=new Set;if(void 0!==u)try{l=c.parse(u)}catch(n){return void g(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const f=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==f){const n=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=s.parse(f);e[a.extensionName]&&(n.accept(e[a.extensionName]),p[a.extensionName]=n)}catch(n){return void g(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const s={origin:e.headers[8===o?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,((o,s,a,c)=>{if(!o)return _(t,s||401,a,c);this.completeUpgrade(p,i,l,e,t,n,r)}));if(!this.options.verifyClient(s))return _(t,401)}this.completeUpgrade(p,i,l,e,t,n,r)}completeUpgrade(e,t,n,r,i,c,u){if(!i.readable||!i.writable)return i.destroy();if(i[f])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return _(i,503);const h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o("sha1").update(t+l).digest("base64")}`],g=new this.options.WebSocket(null);if(n.size){const e=this.options.handleProtocols?this.options.handleProtocols(n,r):n.values().next().value;e&&(h.push(`Sec-WebSocket-Protocol: ${e}`),g._protocol=e)}if(e[a.extensionName]){const t=e[a.extensionName].params,n=s.format({[a.extensionName]:[t]});h.push(`Sec-WebSocket-Extensions: ${n}`),g._extensions=e}this.emit("headers",h,r),i.write(h.concat("\r\n").join("\r\n")),i.removeListener("error",d),g.setSocket(i,c,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(g),g.on("close",(()=>{this.clients.delete(g),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)}))),u(g,r)}}},8762:(e,t,n)=>{"use strict";const r=n(2361),i=n(5687),o=n(3685),s=n(1808),a=n(4404),{randomBytes:c,createHash:u}=n(6113),{Readable:l}=n(2781),{URL:f}=n(7310),h=n(5196),p=n(2957),d=n(7330),{BINARY_TYPES:_,EMPTY_BUFFER:g,GUID:m,kForOnEventAttribute:v,kListener:y,kStatusCode:b,kWebSocket:w,NOOP:S}=n(1872),{EventTarget:{addEventListener:k,removeEventListener:x}}=n(62),{format:E,parse:T}=n(1503),{toBuffer:O}=n(977),I=Symbol("kAborted"),P=[8,13],C=["CONNECTING","OPEN","CLOSING","CLOSED"],A=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class N extends r{constructor(e,t,n){super(),this._binaryType=_[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=g,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=N.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(n=t,t=[]):t=[t]),L(this,e,t,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){_.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const r=new p({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new d(e,this._extensions,n.generateMask),this._receiver=r,this._socket=e,r[w]=this,e[w]=this,r.on("conclude",D),r.on("drain",W),r.on("error",q),r.on("message",V),r.on("ping",z),r.on("pong",$),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",H),e.on("data",Q),e.on("end",Y),e.on("error",K),this._readyState=N.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=N.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=N.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==N.CLOSED)if(this.readyState!==N.CONNECTING)this.readyState!==N.CLOSING?(this._readyState=N.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";B(this,this._req,e)}}pause(){this.readyState!==N.CONNECTING&&this.readyState!==N.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===N.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||g,t,n)):M(this,e,n)}pong(e,t,n){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===N.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||g,t,n)):M(this,e,n)}resume(){this.readyState!==N.CONNECTING&&this.readyState!==N.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==N.OPEN)return void M(this,e,n);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(r.compress=!1),this._sender.send(e||g,r,n)}terminate(){if(this.readyState!==N.CLOSED)if(this.readyState!==N.CONNECTING)this._socket&&(this._readyState=N.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";B(this,this._req,e)}}}function L(e,t,n,r){const s={protocolVersion:P[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!P.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${P.join(", ")})`);let a;if(t instanceof f)a=t,e._url=t.href;else{try{a=new f(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const l="wss:"===a.protocol,p="ws+unix:"===a.protocol;let d;if("ws:"===a.protocol||l||p?p&&!a.pathname?d="The URL's pathname is empty":a.hash&&(d="The URL contains a fragment identifier"):d='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',d){const t=new SyntaxError(d);if(0===e._redirects)throw t;return void U(e,t)}const _=l?443:80,g=c(16).toString("base64"),v=l?i.request:o.request,y=new Set;let b,w;if(s.createConnection=l?j:R,s.defaultPort=s.defaultPort||_,s.port=a.port||_,s.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":g,Connection:"Upgrade",Upgrade:"websocket"},s.path=a.pathname+a.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(b=new h(!0!==s.perMessageDeflate?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=E({[h.extensionName]:b.offer()})),n.length){for(const e of n){if("string"!=typeof e||!A.test(e)||y.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");y.add(e)}s.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(a.username||a.password)&&(s.auth=`${a.username}:${a.password}`),p){const e=s.path.split(":");s.socketPath=e[0],s.path=e[1]}if(s.followRedirects){if(0===e._redirects){e._originalIpc=p,e._originalSecure=l,e._originalHostOrSocketPath=p?s.socketPath:a.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,n]of Object.entries(t))r.headers[e.toLowerCase()]=n}else if(0===e.listenerCount("redirect")){const t=p?!!e._originalIpc&&s.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!l)&&(delete s.headers.authorization,delete s.headers.cookie,t||delete s.headers.host,s.auth=void 0)}s.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),w=e._req=v(s),e._redirects&&e.emit("redirect",e.url,w)}else w=e._req=v(s);s.timeout&&w.on("timeout",(()=>{B(e,w,"Opening handshake has timed out")})),w.on("error",(t=>{null===w||w[I]||(w=e._req=null,U(e,t))})),w.on("response",(i=>{const o=i.headers.location,a=i.statusCode;if(o&&s.followRedirects&&a>=300&&a<400){if(++e._redirects>s.maxRedirects)return void B(e,w,"Maximum redirects exceeded");let i;w.abort();try{i=new f(o,t)}catch(t){const n=new SyntaxError(`Invalid URL: ${o}`);return void U(e,n)}L(e,i,n,r)}else e.emit("unexpected-response",w,i)||B(e,w,`Unexpected server response: ${i.statusCode}`)})),w.on("upgrade",((t,n,r)=>{if(e.emit("upgrade",t),e.readyState!==N.CONNECTING)return;if(w=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void B(e,n,"Invalid Upgrade header");const i=u("sha1").update(g+m).digest("base64");if(t.headers["sec-websocket-accept"]!==i)return void B(e,n,"Invalid Sec-WebSocket-Accept header");const o=t.headers["sec-websocket-protocol"];let a;if(void 0!==o?y.size?y.has(o)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":y.size&&(a="Server sent no subprotocol"),a)return void B(e,n,a);o&&(e._protocol=o);const c=t.headers["sec-websocket-extensions"];if(void 0!==c){if(!b)return void B(e,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=T(c)}catch(t){return void B(e,n,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==h.extensionName)return void B(e,n,"Server indicated an extension that was not requested");try{b.accept(t[h.extensionName])}catch(t){return void B(e,n,"Invalid Sec-WebSocket-Extensions header")}e._extensions[h.extensionName]=b}e.setSocket(n,r,{generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})})),s.finishRequest?s.finishRequest(w,e):w.end()}function U(e,t){e._readyState=N.CLOSING,e.emit("error",t),e.emitClose()}function R(e){return e.path=e.socketPath,s.connect(e)}function j(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=s.isIP(e.host)?"":e.host),a.connect(e)}function B(e,t,n){e._readyState=N.CLOSING;const r=new Error(n);Error.captureStackTrace(r,B),t.setHeader?(t[I]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(U,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function M(e,t,n){if(t){const n=O(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${C[e.readyState]})`);process.nextTick(n,t)}}function D(e,t){const n=this[w];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[w]&&(n._socket.removeListener("data",Q),process.nextTick(G,n._socket),1005===e?n.close():n.close(e,t))}function W(){const e=this[w];e.isPaused||e._socket.resume()}function q(e){const t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",Q),process.nextTick(G,t._socket),t.close(e[b])),t.emit("error",e)}function F(){this[w].emitClose()}function V(e,t){this[w].emit("message",e,t)}function z(e){const t=this[w];t.pong(e,!t._isServer,S),t.emit("ping",e)}function $(e){this[w].emit("pong",e)}function G(e){e.resume()}function H(){const e=this[w];let t;this.removeListener("close",H),this.removeListener("data",Q),this.removeListener("end",Y),e._readyState=N.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[w]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",F),e._receiver.on("finish",F))}function Q(e){this[w]._receiver.write(e)||this.pause()}function Y(){const e=this[w];e._readyState=N.CLOSING,e._receiver.end(),this.end()}function K(){const e=this[w];this.removeListener("error",K),this.on("error",S),e&&(e._readyState=N.CLOSING,this.destroy())}Object.defineProperty(N,"CONNECTING",{enumerable:!0,value:C.indexOf("CONNECTING")}),Object.defineProperty(N.prototype,"CONNECTING",{enumerable:!0,value:C.indexOf("CONNECTING")}),Object.defineProperty(N,"OPEN",{enumerable:!0,value:C.indexOf("OPEN")}),Object.defineProperty(N.prototype,"OPEN",{enumerable:!0,value:C.indexOf("OPEN")}),Object.defineProperty(N,"CLOSING",{enumerable:!0,value:C.indexOf("CLOSING")}),Object.defineProperty(N.prototype,"CLOSING",{enumerable:!0,value:C.indexOf("CLOSING")}),Object.defineProperty(N,"CLOSED",{enumerable:!0,value:C.indexOf("CLOSED")}),Object.defineProperty(N.prototype,"CLOSED",{enumerable:!0,value:C.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(N.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(N.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[v])return t[y];return null},set(t){for(const t of this.listeners(e))if(t[v]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[v]:!0})}})})),N.prototype.addEventListener=k,N.prototype.removeEventListener=x,e.exports=N},3307:e=>{"use strict";e.exports={mask:(e,t,n,r,i)=>{for(var o=0;o<i;o++)n[r+o]=e[o]^t[3&o]},unmask:(e,t)=>{const n=e.length;for(var r=0;r<n;r++)e[r]^=t[3&r]}}},4987:(e,t,n)=>{"use strict";try{e.exports=n(9561)(__dirname)}catch(t){e.exports=n(3307)}},9561:(e,t,n)=>{var r=n(7147),i=n(1017),o=n(2037),s=require,a=process.config&&process.config.variables||{},c=!!process.env.PREBUILDS_ONLY,u=process.versions.modules,l=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":process.versions&&process.versions.nw?"node-webkit":"node",f=o.arch(),h=o.platform(),p=process.env.LIBC||(function(e){return"linux"===e&&r.existsSync("/etc/alpine-release")}(h)?"musl":"glibc"),d=process.env.ARM_VERSION||("arm64"===f?"8":a.arm_version)||"",_=(process.versions.uv||"").split(".")[0];function g(e){return s(g.path(e))}function m(e){try{return r.readdirSync(e)}catch(e){return[]}}function v(e,t){var n=m(e).filter(t);return n[0]&&i.join(e,n[0])}function y(e){return/\.node$/.test(e)}function b(e){var t=e.split("-");if(2===t.length){var n=t[0],r=t[1].split("+");if(n&&r.length&&r.every(Boolean))return{name:e,platform:n,architectures:r}}}function w(e,t){return function(n){return null!=n&&n.platform===e&&n.architectures.includes(t)}}function S(e,t){return e.architectures.length-t.architectures.length}function k(e){var t=e.split("."),n={file:e,specificity:0};if("node"===t.pop()){for(var r=0;r<t.length;r++){var i=t[r];if("node"===i||"electron"===i||"node-webkit"===i)n.runtime=i;else if("napi"===i)n.napi=!0;else if("abi"===i.slice(0,3))n.abi=i.slice(3);else if("uv"===i.slice(0,2))n.uv=i.slice(2);else if("armv"===i.slice(0,4))n.armv=i.slice(4);else{if("glibc"!==i&&"musl"!==i)continue;n.libc=i}n.specificity++}return n}}function x(e,t){return function(n){return!(null==n||n.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(n)||n.abi!==t&&!n.napi||n.uv&&n.uv!==_||n.armv&&n.armv!==d||n.libc&&n.libc!==p)}}function E(e){return function(t,n){return t.runtime!==n.runtime?t.runtime===e?-1:1:t.abi!==n.abi?t.abi?-1:1:t.specificity!==n.specificity?t.specificity>n.specificity?-1:1:0}}e.exports=g,g.path=function(e){e=i.resolve(e||".");try{var t=s(i.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!c){var n=v(i.join(e,"build/Release"),y);if(n)return n;var r=v(i.join(e,"build/Debug"),y);if(r)return r}var o=T(e);if(o)return o;var a=T(i.dirname(process.execPath));if(a)return a;var g=["platform="+h,"arch="+f,"runtime="+l,"abi="+u,"uv="+_,d?"armv="+d:"","libc="+p,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+g+"\n    loaded from: "+e+"\n");function T(e){var t=m(i.join(e,"prebuilds")).map(b).filter(w(h,f)).sort(S)[0];if(t){var n=i.join(e,"prebuilds",t.name),r=m(n).map(k).filter(x(l,u)).sort(E(l))[0];return r?i.join(n,r.file):void 0}}},g.parseTags=k,g.matchTags=x,g.compareTags=E,g.parseTuple=b,g.matchTuple=w,g.compareTuples=S},8121:e=>{"use strict";e.exports=function(e){const t=e.length;let n=0;for(;n<t;)if(0==(128&e[n]))n++;else if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}return!0}},6465:(e,t,n)=>{"use strict";try{e.exports=n(9561)(__dirname)}catch(t){e.exports=n(8121)}},6974:e=>{"use strict";e.exports=require("debug")},9159:e=>{"use strict";e.exports=require("duplexify")},3766:e=>{"use strict";e.exports=require("inherits")},5680:e=>{"use strict";e.exports=require("lru-cache")},918:e=>{"use strict";e.exports=require("mqtt-packet")},6323:e=>{"use strict";e.exports=require("number-allocator")},3248:e=>{"use strict";e.exports=require("readable-stream")},5393:e=>{"use strict";e.exports=require("reinterval")},9950:e=>{"use strict";e.exports=require("rfdc/default")},5170:e=>{"use strict";e.exports=require("xtend")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var r={};return(()=>{"use strict";n.r(r),n.d(r,{Wardenclyffe:()=>It}),n(404),n(2957),n(7330);var e=n(8762);n(9284);const t=e;var i=n(6486),o=n.n(i),s=n(2361),a=n.n(s),c=n(6077),u=n(1017),l=n.n(u),f=n(6113),h=n.n(f);const p={randomUUID:h().randomUUID},d=new Uint8Array(256);let g=d.length;function m(){return g>d.length-16&&(h().randomFillSync(d),g=0),d.slice(g,g+=16)}const v=[];for(let e=0;e<256;++e)v.push((e+256).toString(16).slice(1));const y=function(e,t,n){if(p.randomUUID&&!t&&!e)return p.randomUUID();const r=(e=e||{}).random||(e.rng||m)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase()}(r)};var b,w,S,k=n(4300);try{b=new TextDecoder}catch(e){}var x=0;const E=[];var T,O,I,P,C,A=E,N=0,L={},U=0,R=0,j=[],B={useRecords:!1,mapsAsObjects:!0};class M{}const D=new M;D.name="MessagePack 0xC1";var W,q,F,V=!1,z=2;try{new Function("")}catch(e){z=1/0}class ${constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.sequential&&!1!==e.trusted&&(e.trusted=!0,e.structures||0==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(w)return we((()=>(Se(),this?this.unpack(e,t):$.prototype.unpack.call(B,e,t))));e.buffer||e.constructor!==ArrayBuffer||(e="undefined"!=typeof Buffer?Buffer.from(e):new Uint8Array(e)),"object"==typeof t?(S=t.end||e.length,x=t.start||0):(x=0,S=t>-1?t:e.length),N=0,R=0,O=null,A=E,I=null,w=e;try{C=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(w=null,e instanceof Uint8Array)throw t;throw new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof $){if(L=this,this.structures)return T=this.structures,G(t);(!T||T.length>0)&&(T=[])}else L=B,(!T||T.length>0)&&(T=[]);return G(t)}unpackMultiple(e,t){let n,r=0;try{V=!0;let i=e.length,o=this?this.unpack(e,i):xe.unpack(e,i);if(!t){for(n=[o];x<i;)r=x,n.push(G());return n}if(!1===t(o,r,x))return;for(;x<i;)if(r=x,!1===t(G(),r,x))return}catch(e){throw e.lastPosition=r,e.values=n,e}finally{V=!1,Se()}}_mergeStructures(e,t){q&&(e=q.call(this,e)),e=e||[],Object.isFrozen(e)&&(e=e.map((e=>e.slice(0))));for(let t=0,n=e.length;t<n;t++){let n=e[t];n&&(n.isShared=!0,t>=32&&(n.highByte=t-32>>5))}e.sharedLength=e.length;for(let n in t||[])if(n>=0){let r=e[n],i=t[n];i&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[n]=r),e[n]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function G(e){try{if(!L.trusted&&!V){let e=T.sharedLength||0;e<T.length&&(T.length=e)}let t;if(L.randomAccessStructure&&w[x]<64&&w[x]>=32&&W?(t=W(w,x,S,L),w=null,e&&e.lazy||!t||(t=t.toJSON()),x=S):t=Q(),I&&(x=I.postBundlePosition,I=null),V&&(T.restoreStructures=null),x==S)T&&T.restoreStructures&&H(),T=null,w=null,P&&(P=null);else{if(x>S)throw new Error("Unexpected end of MessagePack data");if(!V){let e;try{e=JSON.stringify(t,((e,t)=>"bigint"==typeof t?`${t}n`:t)).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(e){throw T&&T.restoreStructures&&H(),Se(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||x>S)&&(e.incomplete=!0),e}}function H(){for(let e in T.restoreStructures)T[e]=T.restoreStructures[e];T.restoreStructures=null}function Q(){let e=w[x++];if(e<160){if(e<128){if(e<64)return e;{let t=T[63&e]||L.getStructures&&X()[63&e];return t?(t.read||(t.read=K(t,63&e)),t.read()):e}}if(e<144){if(e-=128,L.mapsAsObjects){let t={};for(let n=0;n<e;n++){let e=_e();"__proto__"===e&&(e="__proto_"),t[e]=Q()}return t}{let t=new Map;for(let n=0;n<e;n++)t.set(Q(),Q());return t}}{e-=144;let t=new Array(e);for(let n=0;n<e;n++)t[n]=Q();return L.freezeData?Object.freeze(t):t}}if(e<192){let t=e-160;if(R>=x)return O.slice(x-U,(x+=t)-U);if(0==R&&S<140){let e=t<16?le(t):ue(t);if(null!=e)return e}return J(t)}{let t;switch(e){case 192:return null;case 193:return I?(t=Q(),t>0?I[1].slice(I.position1,I.position1+=t):I[0].slice(I.position0,I.position0-=t)):D;case 194:return!1;case 195:return!0;case 196:if(t=w[x++],void 0===t)throw new Error("Unexpected end of buffer");return he(t);case 197:return t=C.getUint16(x),x+=2,he(t);case 198:return t=C.getUint32(x),x+=4,he(t);case 199:return pe(w[x++]);case 200:return t=C.getUint16(x),x+=2,pe(t);case 201:return t=C.getUint32(x),x+=4,pe(t);case 202:if(t=C.getFloat32(x),L.useFloat32>2){let e=ke[(127&w[x])<<1|w[x+1]>>7];return x+=4,(e*t+(t>0?.5:-.5)>>0)/e}return x+=4,t;case 203:return t=C.getFloat64(x),x+=8,t;case 204:return w[x++];case 205:return t=C.getUint16(x),x+=2,t;case 206:return t=C.getUint32(x),x+=4,t;case 207:return"number"===L.int64AsType?(t=4294967296*C.getUint32(x),t+=C.getUint32(x+4)):"string"===L.int64AsType?t=C.getBigUint64(x).toString():"auto"===L.int64AsType?(t=C.getBigUint64(x),t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=C.getBigUint64(x),x+=8,t;case 208:return C.getInt8(x++);case 209:return t=C.getInt16(x),x+=2,t;case 210:return t=C.getInt32(x),x+=4,t;case 211:return"number"===L.int64AsType?(t=4294967296*C.getInt32(x),t+=C.getUint32(x+4)):"string"===L.int64AsType?t=C.getBigInt64(x).toString():"auto"===L.int64AsType?(t=C.getBigInt64(x),t>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=C.getBigInt64(x),x+=8,t;case 212:if(t=w[x++],114==t)return ge(63&w[x++]);{let e=j[t];if(e)return e.read?(x++,e.read(Q())):e.noBuffer?(x++,e()):e(w.subarray(x,++x));throw new Error("Unknown extension "+t)}case 213:return t=w[x],114==t?(x++,ge(63&w[x++],w[x++])):pe(2);case 214:return pe(4);case 215:return pe(8);case 216:return pe(16);case 217:return t=w[x++],R>=x?O.slice(x-U,(x+=t)-U):ee(t);case 218:return t=C.getUint16(x),R>=(x+=2)?O.slice(x-U,(x+=t)-U):te(t);case 219:return t=C.getUint32(x),R>=(x+=4)?O.slice(x-U,(x+=t)-U):ne(t);case 220:return t=C.getUint16(x),x+=2,se(t);case 221:return t=C.getUint32(x),x+=4,se(t);case 222:return t=C.getUint16(x),x+=2,ae(t);case 223:return t=C.getUint32(x),x+=4,ae(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}const Y=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function K(e,t){function n(){if(n.count++>z){let n=e.read=new Function("r","return function(){return "+(L.freezeData?"Object.freeze":"")+"({"+e.map((e=>"__proto__"===e?"__proto_:r()":Y.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"})}")(Q);return 0===e.highByte&&(e.read=Z(t,e.read)),n()}let r={};for(let t=0,n=e.length;t<n;t++){let n=e[t];"__proto__"===n&&(n="__proto_"),r[n]=Q()}return L.freezeData?Object.freeze(r):r}return n.count=0,0===e.highByte?Z(t,n):n}const Z=(e,t)=>function(){let n=w[x++];if(0===n)return t();let r=e<32?-(e+(n<<5)):e+(n<<5),i=T[r]||X()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=K(i,e)),i.read()};function X(){let e=we((()=>(w=null,L.getStructures())));return T=L._mergeStructures(e,T)}var J=ie,ee=ie,te=ie,ne=ie;let re=!1;function ie(e){let t;if(e<16&&(t=le(e)))return t;if(e>64&&b)return b.decode(w.subarray(x,x+=e));const n=x+e,r=[];for(t="";x<n;){const e=w[x++];if(0==(128&e))r.push(e);else if(192==(224&e)){const t=63&w[x++];r.push((31&e)<<6|t)}else if(224==(240&e)){const t=63&w[x++],n=63&w[x++];r.push((31&e)<<12|t<<6|n)}else if(240==(248&e)){let t=(7&e)<<18|(63&w[x++])<<12|(63&w[x++])<<6|63&w[x++];t>65535&&(t-=65536,r.push(t>>>10&1023|55296),t=56320|1023&t),r.push(t)}else r.push(e);r.length>=4096&&(t+=ce.apply(String,r),r.length=0)}return r.length>0&&(t+=ce.apply(String,r)),t}function oe(e,t,n){let r=w;w=e,x=t;try{return ie(n)}finally{w=r}}function se(e){let t=new Array(e);for(let n=0;n<e;n++)t[n]=Q();return L.freezeData?Object.freeze(t):t}function ae(e){if(L.mapsAsObjects){let t={};for(let n=0;n<e;n++){let e=_e();"__proto__"===e&&(e="__proto_"),t[e]=Q()}return t}{let t=new Map;for(let n=0;n<e;n++)t.set(Q(),Q());return t}}var ce=String.fromCharCode;function ue(e){let t=x,n=new Array(e);for(let r=0;r<e;r++){const e=w[x++];if((128&e)>0)return void(x=t);n[r]=e}return ce.apply(String,n)}function le(e){if(e<4){if(e<2){if(0===e)return"";{let e=w[x++];return(128&e)>1?void(x-=1):ce(e)}}{let t=w[x++],n=w[x++];if((128&t)>0||(128&n)>0)return void(x-=2);if(e<3)return ce(t,n);let r=w[x++];return(128&r)>0?void(x-=3):ce(t,n,r)}}{let t=w[x++],n=w[x++],r=w[x++],i=w[x++];if((128&t)>0||(128&n)>0||(128&r)>0||(128&i)>0)return void(x-=4);if(e<6){if(4===e)return ce(t,n,r,i);{let e=w[x++];return(128&e)>0?void(x-=5):ce(t,n,r,i,e)}}if(e<8){let o=w[x++],s=w[x++];if((128&o)>0||(128&s)>0)return void(x-=6);if(e<7)return ce(t,n,r,i,o,s);let a=w[x++];return(128&a)>0?void(x-=7):ce(t,n,r,i,o,s,a)}{let o=w[x++],s=w[x++],a=w[x++],c=w[x++];if((128&o)>0||(128&s)>0||(128&a)>0||(128&c)>0)return void(x-=8);if(e<10){if(8===e)return ce(t,n,r,i,o,s,a,c);{let e=w[x++];return(128&e)>0?void(x-=9):ce(t,n,r,i,o,s,a,c,e)}}if(e<12){let u=w[x++],l=w[x++];if((128&u)>0||(128&l)>0)return void(x-=10);if(e<11)return ce(t,n,r,i,o,s,a,c,u,l);let f=w[x++];return(128&f)>0?void(x-=11):ce(t,n,r,i,o,s,a,c,u,l,f)}{let u=w[x++],l=w[x++],f=w[x++],h=w[x++];if((128&u)>0||(128&l)>0||(128&f)>0||(128&h)>0)return void(x-=12);if(e<14){if(12===e)return ce(t,n,r,i,o,s,a,c,u,l,f,h);{let e=w[x++];return(128&e)>0?void(x-=13):ce(t,n,r,i,o,s,a,c,u,l,f,h,e)}}{let p=w[x++],d=w[x++];if((128&p)>0||(128&d)>0)return void(x-=14);if(e<15)return ce(t,n,r,i,o,s,a,c,u,l,f,h,p,d);let _=w[x++];return(128&_)>0?void(x-=15):ce(t,n,r,i,o,s,a,c,u,l,f,h,p,d,_)}}}}}function fe(){let e,t=w[x++];if(t<192)e=t-160;else switch(t){case 217:e=w[x++];break;case 218:e=C.getUint16(x),x+=2;break;case 219:e=C.getUint32(x),x+=4;break;default:throw new Error("Expected string")}return ie(e)}function he(e){return L.copyBuffers?Uint8Array.prototype.slice.call(w,x,x+=e):w.subarray(x,x+=e)}function pe(e){let t=w[x++];if(j[t]){let n;return j[t](w.subarray(x,n=x+=e),(e=>{x=e;try{return Q()}finally{x=n}}))}throw new Error("Unknown extension type "+t)}var de=new Array(4096);function _e(){let e=w[x++];if(!(e>=160&&e<192))return x--,Q().toString();if(e-=160,R>=x)return O.slice(x-U,(x+=e)-U);if(!(0==R&&S<180))return J(e);let t,n=4095&(e<<5^(e>1?C.getUint16(x):e>0?w[x]:0)),r=de[n],i=x,o=x+e-3,s=0;if(r&&r.bytes==e){for(;i<o;){if(t=C.getUint32(i),t!=r[s++]){i=1879048192;break}i+=4}for(o+=3;i<o;)if(t=w[i++],t!=r[s++]){i=1879048192;break}if(i===o)return x=i,r.string;o-=3,i=x}for(r=[],de[n]=r,r.bytes=e;i<o;)t=C.getUint32(i),r.push(t),i+=4;for(o+=3;i<o;)t=w[i++],r.push(t);let a=e<16?le(e):ue(e);return r.string=null!=a?a:J(e)}const ge=(e,t)=>{let n=Q().map((e=>e.toString())),r=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);let i=T[e];return i&&(i.isShared||V)&&((T.restoreStructures||(T.restoreStructures=[]))[e]=i),T[e]=n,n.read=K(n,r),n.read()};j[0]=()=>{},j[0].noBuffer=!0;let me={Error,TypeError,ReferenceError};j[101]=()=>{let e=Q();return(me[e[0]]||Error)(e[1])},j[105]=e=>{let t=C.getUint32(x-4);P||(P=new Map);let n,r=w[x];n=r>=144&&r<160||220==r||221==r?[]:{};let i={target:n};P.set(t,i);let o=Q();return i.used?Object.assign(n,o):(i.target=o,o)},j[112]=e=>{let t=C.getUint32(x-4),n=P.get(t);return n.used=!0,n.target},j[115]=()=>new Set(Q());const ve=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));let ye="object"==typeof globalThis?globalThis:window;j[116]=e=>{let t=e[0],n=ve[t];if(!n)throw new Error("Could not find typed array for code "+t);return new ye[n](Uint8Array.prototype.slice.call(e,1).buffer)},j[120]=()=>{let e=Q();return new RegExp(e[0],e[1])};const be=[];function we(e){F&&F();let t=S,n=x,r=N,i=U,o=R,s=O,a=A,c=P,u=I,l=new Uint8Array(w.slice(0,S)),f=T,h=T.slice(0,T.length),p=L,d=V,_=e();return S=t,x=n,N=r,U=i,R=o,O=s,A=a,P=c,I=u,w=l,V=d,(T=f).splice(0,T.length,...h),L=p,C=new DataView(w.buffer,w.byteOffset,w.byteLength),_}function Se(){w=null,P=null,T=null}j[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=x;return x+=t-e.length,I=be,(I=[fe(),fe()]).position0=0,I.position1=0,I.postBundlePosition=x,x=n,Q()},j[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");const ke=new Array(147);for(let e=0;e<256;e++)ke[e]=+("1e"+Math.floor(45.15-.30103*e));var xe=new $({useRecords:!1});const Ee=xe.unpack;xe.unpackMultiple,xe.unpack;let Te,Oe,Ie,Pe=new Float32Array(1);new Uint8Array(Pe.buffer,0,4);try{Te=new TextEncoder}catch(e){}const Ce="undefined"!=typeof Buffer,Ae=Ce?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,Ne=Ce?Buffer:Uint8Array,Le=Ce?4294967296:2144337920;let Ue,Re,je,Be,Me,De=0,We=null;const qe=/[\u0080-\uFFFF]/,Fe=Symbol("record-id");function Ve(e,t,n,r){let i=e.byteLength;if(i+1<256){var{target:o,position:s}=n(4+i);o[s++]=199,o[s++]=i+1}else if(i+1<65536){var{target:o,position:s}=n(5+i);o[s++]=200,o[s++]=i+1>>8,o[s++]=i+1&255}else{var{target:o,position:s,targetView:a}=n(7+i);o[s++]=201,a.setUint32(s,i+1),s+=4}o[s++]=116,o[s++]=t,o.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s)}function ze(e,t){let n=e.byteLength;var r,i;if(n<256){var{target:r,position:i}=t(n+2);r[i++]=196,r[i++]=n}else if(n<65536){var{target:r,position:i}=t(n+3);r[i++]=197,r[i++]=n>>8,r[i++]=255&n}else{var{target:r,position:i,targetView:o}=t(n+5);r[i++]=198,o.setUint32(i,n),i+=4}r.set(e,i)}function $e(e,t,n,r){let i=e.length;switch(i){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:i<256?(t[n++]=199,t[n++]=i):i<65536?(t[n++]=200,t[n++]=i>>8,t[n++]=255&i):(t[n++]=201,t[n++]=i>>24,t[n++]=i>>16&255,t[n++]=i>>8&255,t[n++]=255&i)}return t[n++]=r,t.set(e,n),n+i}function Ge(e,t,n){if(We.length>0){je.setUint32(We.position+e,De+n-We.position-e),We.stringsPosition=De-e;let r=We;We=null,t(r[0]),t(r[1])}}function He(e,t){return e.isCompatible=e=>{let n=!e||(t.lastNamedStructuresLength||0)===e.length;return n||t._mergeStructures(e),n},e}Ie=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,M],Oe=[{pack(e,t,n){let r=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&r>=0&&r<4294967296){let{target:e,targetView:n,position:i}=t(6);e[i++]=214,e[i++]=255,n.setUint32(i,r)}else if(r>0&&r<4294967296){let{target:n,targetView:i,position:o}=t(10);n[o++]=215,n[o++]=255,i.setUint32(o,4e6*e.getMilliseconds()+(r/1e3/4294967296>>0)),i.setUint32(o+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());let{target:e,targetView:r,position:i}=t(3);e[i++]=212,e[i++]=255,e[i++]=255}else{let{target:n,targetView:i,position:o}=t(15);n[o++]=199,n[o++]=12,n[o++]=255,i.setUint32(o,1e6*e.getMilliseconds()),i.setBigInt64(o+4,BigInt(Math.floor(r)))}}},{pack(e,t,n){if(this.setAsEmptyObject)return t(0),n({});let r=Array.from(e),{target:i,position:o}=t(this.moreTypes?3:0);this.moreTypes&&(i[o++]=212,i[o++]=115,i[o++]=0),n(r)}},{pack(e,t,n){let{target:r,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),n([e.name,e.message])}},{pack(e,t,n){let{target:r,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),n([e.source,e.flags])}},{pack(e,t){this.moreTypes?Ve(e,16,t):ze(Ce?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let n=e.constructor;n!==Ne&&this.moreTypes?Ve(e,ve.indexOf(n.name),t):ze(e,t)}},{pack(e,t){let{target:n,position:r}=t(1);n[r]=193}}];let Qe=new class extends ${constructor(e){let t,n,r,i;super(e),this.offset=0;let o=Ne.prototype.utf8Write?function(e,t){return Ue.utf8Write(e,t,4294967295)}:!(!Te||!Te.encodeInto)&&function(e,t){return Te.encodeInto(e,Ue.subarray(t)).written},s=this;e||(e={});let a=e&&e.sequential,c=e.structures||e.saveStructures,u=e.maxSharedStructures;if(null==u&&(u=c?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&null==e.moreTypes&&(this.moreTypes=!0);let l=e.maxOwnStructures;null==l&&(l=c?32:64),this.structures||0==e.useRecords||(this.structures=[]);let f=u>32||l+u>64,h=u+64,p=u+l+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let d=[],_=0,g=0;this.pack=this.encode=function(e,o){if(Ue||(Ue=new Ae(8192),je=Ue.dataView||(Ue.dataView=new DataView(Ue.buffer,0,8192)),De=0),Be=Ue.length-10,Be-De<2048?(Ue=new Ae(Ue.length),je=Ue.dataView||(Ue.dataView=new DataView(Ue.buffer,0,Ue.length)),Be=Ue.length-10,De=0):De=De+7&2147483640,t=De,i=s.structuredClone?new Map:null,s.bundleStrings&&"string"!=typeof e?(We=[],We.size=1/0):We=null,r=s.structures,r){r.uninitialized&&(r=s._mergeStructures(s.getStructures()));let e=r.sharedLength||0;if(e>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let t=0;t<e;t++){let e=r[t];if(!e)continue;let n,i=r.transitions;for(let t=0,r=e.length;t<r;t++){let r=e[t];n=i[r],n||(n=i[r]=Object.create(null)),i=n}i[Fe]=t+64}this.lastNamedStructuresLength=e}a||(r.nextId=e+64)}n&&(n=!1);try{s.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?T(e):v(e);let n=We;if(We&&Ge(t,v,0),i&&i.idsToInsert){let e=i.idsToInsert.sort(((e,t)=>e.offset>t.offset?1:-1)),r=e.length,o=-1;for(;n&&r>0;){let i=e[--r].offset+t;i<n.stringsPosition+t&&-1===o&&(o=0),i>n.position+t?o>=0&&(o+=6):(o>=0&&(je.setUint32(n.position+t,je.getUint32(n.position+t)+o),o=-1),n=n.previous,r++)}o>=0&&n&&je.setUint32(n.position+t,je.getUint32(n.position+t)+o),De+=6*e.length,De>Be&&k(De),s.offset=De;let a=function(e,t){let n,r=6*t.length,i=e.length-r;for(;n=t.pop();){let t=n.offset,o=n.id;e.copyWithin(t+r,t,i),r-=6;let s=t+r;e[s++]=214,e[s++]=105,e[s++]=o>>24,e[s++]=o>>16&255,e[s++]=o>>8&255,e[s++]=255&o,i=t}return e}(Ue.subarray(t,De),e);return i=null,a}return s.offset=De,o&et?(Ue.start=t,Ue.end=De,Ue):Ue.subarray(t,De)}finally{if(r){g<10&&g++;let i=r.sharedLength||0;if(r.length>i&&!a&&(r.length=i),_>1e4)r.transitions=null,g=0,_=0,d.length>0&&(d=[]);else if(d.length>0&&!a){for(let e=0,t=d.length;e<t;e++)d[e][Fe]=0;d=[]}if(n&&s.saveStructures){let n=Ue.subarray(t,De),o=He(r,s);return!1===s.saveStructures(o,o.isCompatible)?s.pack(e):(s.lastNamedStructuresLength=i,n)}}o&tt&&(De=t)}};const m=e=>{var t=e.length;t<16?Ue[De++]=144|t:t<65536?(Ue[De++]=220,Ue[De++]=t>>8,Ue[De++]=255&t):(Ue[De++]=221,je.setUint32(De,t),De+=4);for(let n=0;n<t;n++)v(e[n])},v=e=>{De>Be&&(Ue=k(De));var n,r=typeof e;if("string"===r){let r,i=e.length;if(We&&i>=4&&i<4096){if((We.size+=i)>21760){let e,n,r=(We[0]?3*We[0].length+We[1].length:0)+10;De+r>Be&&(Ue=k(De+r)),We.position?(n=We,Ue[De]=200,De+=3,Ue[De++]=98,e=De-t,De+=4,Ge(t,v,0),je.setUint16(e+t-3,De-t-e)):(Ue[De++]=214,Ue[De++]=98,e=De-t,De+=4),We=["",""],We.previous=n,We.size=0,We.position=e}let n=qe.test(e);return We[n?0:1]+=e,Ue[De++]=193,void v(n?-i:i)}r=i<32?1:i<256?2:i<65536?3:5;let s=3*i;if(De+s>Be&&(Ue=k(De+s)),i<64||!o){let t,o,s,a=De+r;for(t=0;t<i;t++)o=e.charCodeAt(t),o<128?Ue[a++]=o:o<2048?(Ue[a++]=o>>6|192,Ue[a++]=63&o|128):55296==(64512&o)&&56320==(64512&(s=e.charCodeAt(t+1)))?(o=65536+((1023&o)<<10)+(1023&s),t++,Ue[a++]=o>>18|240,Ue[a++]=o>>12&63|128,Ue[a++]=o>>6&63|128,Ue[a++]=63&o|128):(Ue[a++]=o>>12|224,Ue[a++]=o>>6&63|128,Ue[a++]=63&o|128);n=a-De-r}else n=o(e,De+r);n<32?Ue[De++]=160|n:n<256?(r<2&&Ue.copyWithin(De+2,De+1,De+1+n),Ue[De++]=217,Ue[De++]=n):n<65536?(r<3&&Ue.copyWithin(De+3,De+2,De+2+n),Ue[De++]=218,Ue[De++]=n>>8,Ue[De++]=255&n):(r<5&&Ue.copyWithin(De+5,De+3,De+3+n),Ue[De++]=219,je.setUint32(De,n),De+=4),De+=n}else if("number"===r)if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?Ue[De++]=e:e<256?(Ue[De++]=204,Ue[De++]=e):e<65536?(Ue[De++]=205,Ue[De++]=e>>8,Ue[De++]=255&e):(Ue[De++]=206,je.setUint32(De,e),De+=4);else if(e>>0===e)e>=-32?Ue[De++]=256+e:e>=-128?(Ue[De++]=208,Ue[De++]=e+256):e>=-32768?(Ue[De++]=209,je.setInt16(De,e),De+=2):(Ue[De++]=210,je.setInt32(De,e),De+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let n;if(Ue[De++]=202,je.setFloat32(De,e),t<4||(n=e*ke[(127&Ue[De])<<1|Ue[De+1]>>7])>>0===n)return void(De+=4);De--}Ue[De++]=203,je.setFloat64(De,e),De+=8}else if("object"===r||"function"===r)if(e){if(i){let n=i.get(e);if(n){if(!n.id){let e=i.idsToInsert||(i.idsToInsert=[]);n.id=e.push(n)}return Ue[De++]=214,Ue[De++]=112,je.setUint32(De,n.id),void(De+=4)}i.set(e,{offset:De-t})}let o=e.constructor;if(o===Object)S(e,!0);else if(o===Array)m(e);else if(o===Map)if(this.mapAsEmptyObject)Ue[De++]=128;else{(n=e.size)<16?Ue[De++]=128|n:n<65536?(Ue[De++]=222,Ue[De++]=n>>8,Ue[De++]=255&n):(Ue[De++]=223,je.setUint32(De,n),De+=4);for(let[t,n]of e)v(t),v(n)}else{for(let t=0,n=Oe.length;t<n;t++)if(e instanceof Ie[t]){let n=Oe[t];if(n.write){n.type&&(Ue[De++]=212,Ue[De++]=n.type,Ue[De++]=0);let t=n.write.call(this,e);return void(t===e?Array.isArray(e)?m(e):S(e):v(t))}let r,i=Ue,o=je,s=De;Ue=null;try{r=n.pack.call(this,e,(e=>(Ue=i,i=null,De+=e,De>Be&&k(De),{target:Ue,targetView:je,position:De-e})),v)}finally{i&&(Ue=i,je=o,De=s,Be=Ue.length-10)}return void(r&&(r.length+De>Be&&k(r.length+De),De=$e(r,Ue,De,n.type)))}if(Array.isArray(e))m(e);else{if(e.toJSON){const t=e.toJSON();if(t!==e)return v(t)}if("function"===r)return v(this.writeFunction&&this.writeFunction(e));S(e,!e.hasOwnProperty)}}}else Ue[De++]=192;else if("boolean"===r)Ue[De++]=e?195:194;else if("bigint"===r){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))Ue[De++]=211,je.setBigInt64(De,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)Ue[De++]=207,je.setBigUint64(De,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ue[De++]=203,je.setFloat64(De,Number(e))}De+=8}else{if("undefined"!==r)throw new Error("Unknown type: "+r);this.encodeUndefinedAsNil?Ue[De++]=192:(Ue[De++]=212,Ue[De++]=0,Ue[De++]=0)}},y=this.variableMapSize||this.coercibleKeyAsNumber?e=>{let t,n=Object.keys(e),r=n.length;if(r<16?Ue[De++]=128|r:r<65536?(Ue[De++]=222,Ue[De++]=r>>8,Ue[De++]=255&r):(Ue[De++]=223,je.setUint32(De,r),De+=4),this.coercibleKeyAsNumber)for(let i=0;i<r;i++){t=n[i];let r=Number(t);v(isNaN(r)?t:r),v(e[t])}else for(let i=0;i<r;i++)v(t=n[i]),v(e[t])}:(e,n)=>{Ue[De++]=222;let r=De-t;De+=2;let i=0;for(let t in e)(n||e.hasOwnProperty(t))&&(v(t),v(e[t]),i++);Ue[r+++t]=i>>8,Ue[r+t]=255&i},b=!1===this.useRecords?y:e.progressiveRecords&&!f?(e,n)=>{let i,o,s=r.transitions||(r.transitions=Object.create(null)),a=De++-t;for(let c in e)if(n||e.hasOwnProperty(c)){if(i=s[c],i)s=i;else{let n=Object.keys(e),u=s;s=r.transitions;let l=0;for(let e=0,t=n.length;e<t;e++){let t=n[e];i=s[t],i||(i=s[t]=Object.create(null),l++),s=i}a+t+1==De?(De--,x(s,n,l)):E(s,n,a,l),o=!0,s=u[c]}v(e[c])}if(!o){let n=s[Fe];n?Ue[a+t]=n:E(s,Object.keys(e),a,0)}}:(e,t)=>{let n,i=r.transitions||(r.transitions=Object.create(null)),o=0;for(let r in e)(t||e.hasOwnProperty(r))&&(n=i[r],n||(n=i[r]=Object.create(null),o++),i=n);let s=i[Fe];s?s>=96&&f?(Ue[De++]=96+(31&(s-=96)),Ue[De++]=s>>5):Ue[De++]=s:x(i,i.__keys__||Object.keys(e),o);for(let n in e)(t||e.hasOwnProperty(n))&&v(e[n])},w="function"==typeof this.useRecords&&this.useRecords,S=w?(e,t)=>{w(e)?b(e,t):y(e,t)}:b,k=e=>{let n;if(e>16777216){if(e-t>Le)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(Le,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(e-t<<2,Ue.length-1)>>12)<<12;let r=new Ae(n);return je=r.dataView||(r.dataView=new DataView(r.buffer,0,n)),e=Math.min(e,Ue.length),Ue.copy?Ue.copy(r,0,t,e):r.set(Ue.slice(t,e)),De-=t,t=0,Be=r.length-10,Ue=r},x=(e,t,i)=>{let o=r.nextId;o||(o=64),o<h&&this.shouldShareStructure&&!this.shouldShareStructure(t)?(o=r.nextOwnId,o<p||(o=h),r.nextOwnId=o+1):(o>=p&&(o=h),r.nextId=o+1);let s=t.highByte=o>=96&&f?o-96>>5:-1;e[Fe]=o,e.__keys__=t,r[o-64]=t,o<h?(t.isShared=!0,r.sharedLength=o-63,n=!0,s>=0?(Ue[De++]=96+(31&o),Ue[De++]=s):Ue[De++]=o):(s>=0?(Ue[De++]=213,Ue[De++]=114,Ue[De++]=96+(31&o),Ue[De++]=s):(Ue[De++]=212,Ue[De++]=114,Ue[De++]=o),i&&(_+=g*i),d.length>=l&&(d.shift()[Fe]=0),d.push(e),v(t))},E=(e,n,r,i)=>{let o=Ue,s=De,a=Be,c=t;Ue=Re,De=0,t=0,Ue||(Re=Ue=new Ae(8192)),Be=Ue.length-10,x(e,n,i),Re=Ue;let u=De;if(Ue=o,De=s,Be=a,t=c,u>1){let e=De+u-1;e>Be&&k(e);let n=r+t;Ue.copyWithin(n+u,n+1,De),Ue.set(Re.slice(0,u),n),De=e}else Ue[r+t]=Re[0]},T=(e,t)=>{let i=Me(e,Ue,De,r,k,((e,t,r)=>{if(r)return n=!0;De=t;let i=Ue;return v(e),i!==Ue?{position:De,targetView:je,target:Ue}:De}),this);if(0===i)return S(e,!0);De=i}}useBuffer(e){Ue=e,je=new DataView(Ue.buffer,Ue.byteOffset,Ue.byteLength),De=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}({useRecords:!1});const Ye=Qe.pack,{NEVER:Ke,ALWAYS:Ze,DECIMAL_ROUND:Xe,DECIMAL_FIT:Je}=(Qe.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),et=512,tt=1024,nt=["num","object","string","ascii"];nt[16]="date";const rt=[!1,!0,!0,!1,!1,!0,!0,!1];let it,ot;try{new Function(""),it=!0}catch(e){}const st="undefined"!=typeof Buffer;let at,ct;try{at=new TextEncoder}catch(e){}const ut=st?function(e,t,n){return e.utf8Write(t,n,4294967295)}:!(!at||!at.encodeInto)&&function(e,t,n){return at.encodeInto(t,e.subarray(n)).written};var lt;function ft(e,t,n,r){let i;return(i=e.ascii8||e.num8)?(n.setInt8(t,r,!0),ot=t+1,i):(i=e.string16||e.object16)?(n.setInt16(t,r,!0),ot=t+2,i):(i=e.num32)?(n.setUint32(t,3758096640+r,!0),ot=t+4,i):(i=e.num64)?(n.setFloat64(t,NaN,!0),n.setInt8(t,r),ot=t+8,i):void(ot=t)}function ht(e,t,n){let r=nt[t]+(n<<3),i=e[r]||(e[r]=Object.create(null));return i.__type=t,i.__size=n,i.__parent=e,i}Symbol("type"),Symbol("parent"),lt=function e(t,n,r,i,o,s,a){let c=a.typedStructs||(a.typedStructs=[]),u=n.dataView,l=(c.lastStringStart||100)+r,f=n.length-10,h=r;if(r>f){let e=h;u=(n=o(r)).dataView,r-=e,l-=e,h=0,f=n.length-10}let p,d=l,_=c.transitions||(c.transitions=Object.create(null)),g=c.nextId||c.length,m=g<15?1:g<240?2:g<61440?3:g<15728640?4:0;if(0===m)return 0;r+=m;let v,y=[],b=0;for(let e in t){let i=t[e],a=_[e];if(a||(_[e]=a={key:e,parent:_,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),r>f){let e=h;u=(n=o(r)).dataView,r-=e,l-=e,d-=e,h=0,f=n.length-10}switch(typeof i){case"number":let t=i;if(t>>0===t&&t<536870912&&t>-520093696){t<246&&t>=0&&(a.num8||t<32&&!a.num32)?(_=a.num8||ht(a,0,1),n[r++]=t):(_=a.num32||ht(a,0,4),u.setUint32(r,t,!0),r+=4);break}if(t<4294967296&&t>=-2147483648&&(u.setFloat32(r,t,!0),rt[n[r+3]>>>5])){let e;if((e=t*ke[(127&n[r+3])<<1|n[r+2]>>7])>>0===e){_=a.num32||ht(a,0,4),r+=4;break}}_=a.num64||ht(a,0,8),u.setFloat64(r,t,!0),r+=8;break;case"string":let g,m=i.length;if(p=d-l,(m<<2)+d>f){let e=h;u=(n=o((m<<2)+d)).dataView,r-=e,l-=e,d-=e,h=0,f=n.length-10}if(m>65280+p>>2){y.push(e,i,r-h);break}let w=d;if(m<64){let e,t,r;for(e=0;e<m;e++)t=i.charCodeAt(e),t<128?n[d++]=t:t<2048?(g=!0,n[d++]=t>>6|192,n[d++]=63&t|128):55296==(64512&t)&&56320==(64512&(r=i.charCodeAt(e+1)))?(g=!0,t=65536+((1023&t)<<10)+(1023&r),e++,n[d++]=t>>18|240,n[d++]=t>>12&63|128,n[d++]=t>>6&63|128,n[d++]=63&t|128):(g=!0,n[d++]=t>>12|224,n[d++]=t>>6&63|128,n[d++]=63&t|128)}else d+=ut(n,i,d),g=d-w>m;if(p<160||p<246&&(a.ascii8||a.string8)){if(g)(_=a.string8)||(c.length>10&&(_=a.ascii8)?(_.__type=2,a.ascii8=null,a.string8=_,s(null,0,!0)):_=ht(a,2,1));else{if(0===p&&!v){v=!0,_=a.ascii0||ht(a,3,0);break}(_=a.ascii8)||c.length>10&&(_=a.string8)||(_=ht(a,3,1))}n[r++]=p}else _=a.string16||ht(a,2,2),u.setUint16(r,p,!0),r+=2;break;case"object":if(i){i.constructor===Date?(_=a.date64||ht(a,16,8),u.setFloat64(r,i.getTime(),!0),r+=8):y.push(e,i,b);break}a=ft(a,r,u,-10),a?(_=a,r=ot):y.push(e,i,b);break;case"boolean":_=a.num8||a.ascii8||ht(a,0,1),n[r++]=i?249:248;break;case"undefined":a=ft(a,r,u,-9),a?(_=a,r=ot):y.push(e,i,b)}b++}for(let e=0,t=y.length;e<t;){let t,i=y[e++],o=y[e++],a=y[e++],c=_[i];if(c||(_[i]=c={key:i,parent:_,enumerationOffset:a-b,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null}),o){let e;p=d-l,p<65280?(_=c.object16,_?e=2:(_=c.object32)?e=4:(_=ht(c,1,2),e=2)):(_=c.object32||ht(c,1,4),e=4),t=s(o,d),"object"==typeof t?(d=t.position,u=t.targetView,n=t.target,l-=h,r-=h,h=0):d=t,2===e?(u.setUint16(r,p,!0),r+=2):(u.setUint32(r,p,!0),r+=4)}else _=c.object16||ht(c,1,2),u.setInt16(r,null===o?-10:-9,!0),r+=2;b++}let w=_[Fe];if(null==w){w=a.typedStructs.length;let e,t,n=[],r=_;for(;void 0!==(t=r.__type);){let i=r.__size;r=r.__parent,e=r.key;let o=[t,i,e];r.enumerationOffset&&o.push(r.enumerationOffset),n.push(o),r=r.parent}n.reverse(),_[Fe]=w,a.typedStructs[w]=n,s(null,0,!0)}switch(m){case 1:if(w>=16)return 0;n[h]=w+32;break;case 2:if(w>=256)return 0;n[h]=56,n[h+1]=w;break;case 3:if(w>=65536)return 0;n[h]=57,u.setUint16(h+1,w,!0);break;case 4:if(w>=16777216)return 0;u.setUint32(h,58+(w<<8),!0)}if(r<l){if(l===d)return r;n.copyWithin(r,l,d),d+=r-l,c.lastStringStart=r-h}else if(r>l)return l===d?r:(c.lastStringStart=r-h,e(t,n,h,i,o,s,a));return d},Me=lt,He=function(e,t){if(t.typedStructs){let n=new Map;n.set("named",e),n.set("typed",t.typedStructs),e=n}let n=t.lastTypedStructuresLength||0;return e.isCompatible=e=>{let r=!0;return e instanceof Map?((e.get("named")||[]).length!==(t.lastNamedStructuresLength||0)&&(r=!1),(e.get("typed")||[]).length!==n&&(r=!1)):(e instanceof Array||Array.isArray(e))&&e.length!==(t.lastNamedStructuresLength||0)&&(r=!1),r||t._mergeStructures(e),r},t.lastTypedStructuresLength=t.typedStructs&&t.typedStructs.length,e};var pt=Symbol.for("source");function dt(e){switch(e){case 246:return null;case 247:return;case 248:return!1;case 249:return!0}throw new Error("Unknown constant")}function _t(e){return function(){return e(this[pt])}}W=function(e,t,n,r){let i=e[t++]-32;if(i>=24)switch(i){case 24:i=e[t++];break;case 25:i=e[t++]+(e[t++]<<8);break;case 26:i=e[t++]+(e[t++]<<8)+(e[t++]<<16);break;case 27:i=e[t++]+(e[t++]<<8)+(e[t++]<<16)+(e[t++]<<24)}let o=r.typedStructs&&r.typedStructs[i];if(!o){if(e=Uint8Array.prototype.slice.call(e,t,n),n-=t,t=0,r._mergeStructures(r.getStructures()),!r.typedStructs)throw new Error("Could not find any shared typed structures");if(r.lastTypedStructuresLength=r.typedStructs.length,o=r.typedStructs[i],!o)throw new Error("Could not find typed structure "+i)}var s=o.construct;if(!s){var a=(s=o.construct=function(){}).prototype;let e,t=[],n=0;for(let i=0,s=o.length;i<s;i++){let s=o[i],[a,c,u,l]=s;"__proto__"===u&&(u="__proto_");let f,h,p={key:u,offset:n};switch(l?t.splice(i+l,0,p):t.push(p),c){case 0:f=()=>0;break;case 1:f=(e,t)=>{let n=e.bytes[t+p.offset];return n>=246?dt(n):n};break;case 2:f=(e,t)=>{let n=e.bytes,r=(n.dataView||(n.dataView=new DataView(n.buffer,n.byteOffset,n.byteLength))).getUint16(t+p.offset,!0);return r>=65280?dt(255&r):r};break;case 4:f=(e,t)=>{let n=e.bytes,r=(n.dataView||(n.dataView=new DataView(n.buffer,n.byteOffset,n.byteLength))).getUint32(t+p.offset,!0);return r>=4294967040?dt(255&r):r}}switch(p.getRef=f,n+=c,a){case 3:e&&!e.next&&(e.next=p),e=p,p.multiGetCount=0,h=function(e){let t=e.bytes,r=e.position,i=n+r,o=f(e,r);if("number"!=typeof o)return o;let s,a=p.next;for(;a&&(s=a.getRef(e,r),"number"!=typeof s);)s=null,a=a.next;return null==s&&(s=e.bytesEnd-i),e.srcString?e.srcString.slice(o,s):oe(t,o+i,s-o)};break;case 2:case 1:e&&!e.next&&(e.next=p),e=p,h=function(e){let t=e.position,i=n+t,o=f(e,t);if("number"!=typeof o)return o;let s,c=e.bytes,u=p.next;for(;u&&(s=u.getRef(e,t),"number"!=typeof s);)s=null,u=u.next;if(null==s&&(s=e.bytesEnd-i),2===a)return c.toString("utf8",o+i,s+i);ct=e;try{return r.unpack(c,{start:o+i,end:s+i})}finally{ct=null}};break;case 0:switch(c){case 4:h=function(e){let t=e.bytes,n=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength)),r=e.position+p.offset,i=n.getInt32(r,!0);if(i<536870912){if(i>-520093696)return i;if(i>-536870912)return dt(255&i)}let o=n.getFloat32(r,!0),s=ke[(127&t[r+3])<<1|t[r+2]>>7];return(s*o+(o>0?.5:-.5)>>0)/s};break;case 8:h=function(e){let t=e.bytes,n=(t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))).getFloat64(e.position+p.offset,!0);if(isNaN(n)){let n=t[e.position+p.offset];if(n>=246)return dt(n)}return n};break;case 1:h=function(e){let t=e.bytes[e.position+p.offset];return t<246?t:dt(t)}}break;case 16:h=function(e){let t=e.bytes,n=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength));return new Date(n.getFloat64(e.position+p.offset,!0))}}p.get=h}if(it){let e,n=[],i=[],o=0;for(let s of t){if(r.alwaysLazyProperty&&r.alwaysLazyProperty(s.key)){e=!0;continue}Object.defineProperty(a,s.key,{get:_t(s.get),enumerable:!0});let t="v"+o++;i.push(t),n.push("["+JSON.stringify(s.key)+"]:"+t+"(s)")}e&&n.push("__proto__:this");let s=new Function(...i,"return function(s){return{"+n.join(",")+"}}").apply(null,t.map((e=>e.get)));Object.defineProperty(a,"toJSON",{value(e){return s.call(this,this[pt])}})}else Object.defineProperty(a,"toJSON",{value(e){let n={};for(let e=0,r=t.length;e<r;e++){let r=t[e].key;n[r]=this[r]}return n}})}var c=new s;return c[pt]={bytes:e,position:t,srcString:"",bytesEnd:n},c},q=function(e){if(!(e instanceof Map))return e;let t=e.get("typed")||[];Object.isFrozen(t)&&(t=t.map((e=>e.slice(0))));let n=e.get("named"),r=Object.create(null);for(let e=0,n=t.length;e<n;e++){let n=t[e],i=r;for(let[e,t,r]of n){let n=i[r];n||(i[r]=n={key:r,parent:i,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),i=ht(n,e,t)}i[Fe]=e}return t.transitions=r,this.typedStructs=t,this.lastTypedStructuresLength=t.length,n},F=function(){ct&&(ct.bytes=Uint8Array.prototype.slice.call(ct.bytes,ct.position,ct.bytesEnd),ct.position=0,ct.bytesEnd=ct.bytes.length)},n(2781);const gt=require("module");if(void 0===process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED||"true"!==process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED.toLowerCase()){let e;try{e="function"==typeof require?require("msgpackr-extract"):(0,gt.createRequire)("file:///home/neo/NERV/PROJECTS/124-wardenclyffe-js-MQTT%E9%80%9A%E4%BF%A1%E6%9E%B6%E6%9E%84/node_modules/msgpackr/node-index.js")("msgpackr-extract"),e&&function(e){function t(t){return function(n){let r=A[N++];if(null==r){if(I)return ie(n);let i=w.byteOffset,o=e(x-t+i,S+i,w.buffer);if("string"==typeof o)r=o,A=E;else if(N=1,R=1,r=(A=o)[0],void 0===r)throw new Error("Unexpected end of buffer")}let i=r.length;return i<=n?(x+=n,r):(O=r,U=x,R=x+i,x+=n,r.slice(0,n))}}re=!0,J=t(1),ee=t(2),te=t(3),ne=t(5)}(e.extractStrings)}catch(e){}}class mt extends a().EventEmitter{#e;#t;#n;constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n=!1,this.#r(n)}#r(e){const t=_.get(e,"timeout")||5e3;setTimeout((()=>{this.reject(Error("timeout"))}),t)}resolve(){this.#n||(this.#n=!0,this.#e.apply(this,[...arguments]),this.emit("finished"))}reject(){this.#n||(this.#n=!0,this.#t.apply(this,[...arguments]),this.emit("finished"))}}const vt=mt,yt=n(6974)("wardenclyffe:rpc"),bt="/wardenclyffe/res/",wt="/wardenclyffe/req/";class St extends a().EventEmitter{#i;#o;constructor(e){super();const t=o().get(e,"namespace");this.#i="/wardenclyffe/sub/"+t+"/",this.#o="/wardenclyffe/pub/"+t+"/"}bindEventsToClient(e){e.subscribe(l().posix.join(this.#o,"#"),{qos:1})}__onMessage(e,t,n){if(!o().startsWith(e,this.#o))return!1}}const kt=St;class xt extends a().EventEmitter{#s;#a;constructor(e){super();const t=o().get(e,"timeout",3e4);setInterval((()=>{const e=(new Date).getTime();this.#a&&e-this.#c>=t&&this.emit("bark")}),1e3),o().get(e,"emission")&&setInterval((()=>{try{if(!this.#s.connected)return;this.#s.publish("/wardenclyffe/heartbeat",(new Date).toISOString(),{qos:0})}catch(e){console.error(e)}}),5e3)}bindEventsToClient(e){this.#s=e,this.#s.subscribe("/wardenclyffe/heartbeat"),this.#s.on("connect",(()=>{this.#a=!0,this.#u()})),this.#s.on("message",(()=>{this.#u()}))}#c=0;#u(){this.#c=(new Date).getTime()}}const Et=xt,Tt=n(6974)("wardenclyffe"),Ot=Symbol();global.WebSocket=t;class It extends a().EventEmitter{#l;#s;#f;#h;#p;#d;#_;#g;constructor(e){super();const t=o().get(e,"namespace","default");if(!o().isString(t||!/^[a-z]+$/.test(t)))throw Error("Invalid namespace.");if(this.#f=o().get(e,"url"),this.#h=o().get(e,"username"),this.#p=o().get(e,"password"),o().isNil(this.#f))throw Error("url cannot be empty.");this.#_=new class{#s;#m;#v;#y;#b;constructor(e){const t=o().get(e,"namespace");this.#m=bt+t+"/",this.#v=wt+t+"/",this.#y=new Map,this.#b=new Map}bindEventsToClient(e){e.subscribe(l().posix.join(this.#m,"#"),{qos:1}),e.subscribe(l().posix.join(this.#v,"#"),{qos:2}),this.#s=e}__onMessage(e,t,n){if(o().startsWith(e,this.#v))this.#w(e,t,n);else{if(!o().startsWith(e,this.#m))return!1;this.#S(e,t,n)}return!0}#w(e,t,n){if(!this.#y.has(e))return;yt("Received request on topic:",e);const r=this.#y.get(e),i=o().get(n,"properties.responseTopic");o().startsWith(i,bt)?(async()=>{let e=null,n=!1;try{let n=Ee(t);e=await r(n)}catch(t){e=t.message,n=!0}this.#s.publish(i,Ye(e),{qos:2,properties:{userProperties:{is_error:n}}})})():yt("Requested topic does not have a valid responseTopic.")}#S(e,t,n){if(!this.#b.has(e))return;const r=this.#b.get(e),i="true"==o().get(n,"properties.userProperties.is_error");let s=null;try{s=Ee(t)}catch(e){return r.reject(Error("Deserialization error."))}return i?r.reject(s):r.resolve(s)}#k(e,t){if(!o().isString(e)||!/^[a-z0-9]+(\.[0-9a-z]+){0,}$/g.test(e))throw Error("Invalid function name: "+e);return e=e.replace(/\./g,"/"),l().posix.join(o().isNil(t)?this.#v:t,e)}register(e,t){if(!o().isFunction(t))throw Error("Handler function expected.");const n=this.#k(e);if(this.#y.has(n))throw Error("Function already registered.");return this.#y.set(n,t),this}unregister(e){return this.#y.delete(this.#k(e)),this}call(e,t,n,r){if(!this.#s||!this.#s.connected)throw Error("offline");const i=this.#k(t,l().posix.join(wt,e));let o=l().posix.join(this.#m,y()),s=new Promise(((e,t)=>{let n=new vt(e,t,r);this.#b.set(o,n),n.once("finished",(()=>{this.#b.delete(o)}))}));return new Promise(((e,t)=>{try{this.#s.publish(i,Ye(n),{qos:2,properties:{responseTopic:o}},(n=>{if(n)return t(n);e()}))}catch(e){t(e)}})).catch((e=>{let t=this.#b.get(o);t&&t.reject(e)})),s}}({namespace:t}),this.#d=new kt({namespace:t}),this.#g=new Et({emission:o().get(e,"emitHeartbeat",!1)}),this.#l="Wardenclyffe-"+y(),Tt("clientId=",this.#l),this.#g.on("bark",(()=>{Tt("Watchdog timed out."),o().isFunction(e.onWatchdogTimeout)&&(Tt("Found watchdog callback function, invoke it."),e.onWatchdogTimeout())}))}connect(){return Tt("Connecting: "+this.#f),this.#s=c.connect(this.#f,{username:o().isString(this.#h)?this.#h:void 0,password:this.#p?k.Buffer.from(this.#p,"ascii"):void 0,protocolVersion:5,keepalive:5,clean:!1,clientId:this.#l}),new Promise(((e,t)=>{this.#s.once("error",(e=>{t(e)})),this.#s.once("connect",(()=>{Tt("MQTT connnected."),this.emit("connect"),this.#x(this.#s),e()}))}))}#x(e){!0!==o().get(e,Ot)&&(e.on("reconnect",(()=>{Tt("Reconnecting...")})),e.on("offline",(()=>{Tt("Client offline.")})),e.on("error",(e=>{Tt("MQTT client error",e)})),this.#_.bindEventsToClient(e),this.#d.bindEventsToClient(e),this.#g.bindEventsToClient(e),e.on("message",((e,t,n)=>this.#E(e,t,n))),e[Ot]=!0)}#E(e,t,n){!1===this.#_.__onMessage(e,t,n)&&this.#d.__onMessage(e,t,n)}get rpc(){return this.#_}get eventing(){return this.#d}}})(),r})()));